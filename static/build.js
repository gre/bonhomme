(function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var j=typeof require=="function"&&require;if(!h&&j)return j(g,!0);if(f)return f(g,!0);var k=new Error("Cannot find module '"+g+"'");throw k.code="MODULE_NOT_FOUND",k}var l=c[g]={exports:{}};b[g][0].call(l.exports,function(a){var c=b[g][1][a];return e(c?c:a)},l,l.exports,a,b,c,d)}return c[g].exports}var f=typeof require=="function"&&require;for(var g=0;g<d.length;g++)e(d[g]);return e})({1:[function(a,b,c){function d(){this._keys={},document.body.addEventListener("keydown",this._onDown.bind(this),!1),document.body.addEventListener("keyup",this._onUp.bind(this),!1),window.addEventListener("focus",this._onFocus.bind(this),!1),window.addEventListener("blur",this._onBlur.bind(this),!1)}d.prototype={_onFocus:function(){this._paused=0},_onBlur:function(){this._paused=1},_onDown:function(a){[37,38,39,40].indexOf(a.which)>=0&&a.preventDefault(),this._keys[a.which]=1},_onUp:function(a){this._keys[a.which]=0},paused:function(){return this._paused},x:function(){if(this._paused)return 0;var a=!!(this._keys[37]||this._keys[81]||this._keys[65]),b=!!this._keys[39]||!!this._keys[68];return-a+b},y:function(){if(this._paused)return 0;var a=!!(this._keys[38]||this._keys[90]||this._keys[87]),b=!!this._keys[40]||!!this._keys[83];return+a-b}},b.exports=d},{}],2:[function(a,b,c){var d=a(1),e=a(4),f=a(53);b.exports=f?e:d},{1:1,4:4,53:53}],3:[function(a,b,c){function d(){this._x=0,this._y=0}d.prototype={setState:function(a){this._x=a.x,this._y=a.y},x:function(){return this._x},y:function(){return this._y}},b.exports=d},{}],4:[function(a,b,c){function d(){window.addEventListener("touchstart",this._onStart.bind(this),!1),window.addEventListener("touchend",this._onEnd.bind(this),!1),window.addEventListener("touchmove",this._onMove.bind(this),!1),window.addEventListener("touchcancel",this._onCancel.bind(this),!1),window.addEventListener("focus",this._onFocus.bind(this),!1),window.addEventListener("blur",this._onBlur.bind(this),!1),this._paused=!1,this.touchEventId=null}function e(a,b){if(b===null)return null;var c=a.length;for(var d=0;d<c;++d)if(b===a[d].identifier)return a[d];return null}function f(a){return[a.screenX,a.screenY]}d.prototype={_onFocus:function(){this._paused=0},_onBlur:function(){this._paused=1},_onStart:function(a){a.preventDefault();if(this.startPos)return;var b=a.changedTouches[0];this.touchEventId=b.identifier,this.startPos=f(b),this.movePos=this.startPos},_onMove:function(a){a.preventDefault();var b=e(a.changedTouches,this.touchEventId);b&&(this.movePos=f(b))},_onEnd:function(a){a.preventDefault();var b=e(a.changedTouches,this.touchEventId);b&&(this.startPos=null,this.movePos=null)},_onCancel:function(a){a.preventDefault(),this.startPos=null,this.movePos=null},update:function(a,b){if(!this.startPos)return;var c=this.movePos[0]-this.startPos[0],d=this.movePos[1]-this.startPos[1];this.startPos[0]=this.startPos[0]+c*.001*b,this.startPos[1]=this.startPos[1]+d*.001*b},paused:function(){return this._paused},x:function(){if(this._paused)return 0;if(!this.startPos||!this.movePos)return 0;var a=this.movePos[0]-this.startPos[0];return Math.abs(a)<30?0:a<0?-1:1},y:function(){if(this._paused)return 0;if(!this.startPos||!this.movePos)return 0;var a=this.movePos[1]-this.startPos[1]-10;return Math.abs(a)<8?0:a<0?1:-1}},b.exports=d},{}],5:[function(a,b,c){b.exports=a(2)},{2:2}],6:[function(a,b,c){function i(a){d.DisplayObjectContainer.call(this),this.game=a;var b=new f("",{font:e.style(20)});this.life=b;var c=new d.Sprite(h);this.m2=c,c.scale.set(.5,.5),c.position.set(40,-12),this.addChild(b),this.addChild(c)}var d=a(117),e=a(19),f=a(49),g=a(41),h=d.Texture.fromImage("./img/m2.png");i.prototype=Object.create(d.DisplayObjectContainer.prototype),i.prototype.constructor=i,i.prototype.update=function(){var a=this.game.player.life,b=g.getPlayerScore(this.game.player);b>0&&a>0?(this.m2.tint=this.life.tint=a<50?16711680:a<=100?16750848:a<=200?10066329:6736998,this.life.text=""+(a/100).toFixed(2),this.alpha=1):this.alpha=0},b.exports=i},{117:117,19:19,41:41,49:49}],7:[function(a,b,c){function g(a){e.call(this,"",{font:d.style(20,!0)}),this.game=a,this.tint=13386752}var d=a(19),e=a(49),f=a(41);g.prototype=Object.create(e.prototype),g.prototype.constructor=g,g.prototype.update=function(a){var b=this.game,c=b.player,d=c.life,e=f.getPlayerScore(c);if(e>0){var g=b.getCurrentRank(e);g?(this.alpha=d<=0?1:Math.cos(a/80)<0?1:.2,this.text="#"+g):this.alpha=0}else{var h=b.getPlayerBestScore(c.name);this.text=h?"#"+h.rank:"no rank"}},b.exports=g},{19:19,41:41,49:49}],8:[function(a,b,c){function g(a){e.call(this,"",{font:d.style(20,!0)}),this.game=a,this.tint=8947899}var d=a(19),e=a(49),f=a(41);g.prototype=Object.create(e.prototype),g.prototype.constructor=g,g.prototype.update=function(){var a=this.game,b=a.player,c=f.getPlayerScore(b);if(c>0)this.text=""+c;else{var d=a.getPlayerBestScore(b.name);this.text=d?""+d.score:"no score"}},b.exports=g},{19:19,41:41,49:49}],9:[function(a,b,c){function i(a){e.call(this),this.game=a,this.life=new h(a),this.life.position.set(d.WIDTH-80,10),this.addChild(this.life),this.rank=new g(a),this.rank.position.set(10,40),this.addChild(this.rank),this.score=new f(a),this.score.position.set(10,10),this.addChild(this.score)}var d=a(18),e=a(50),f=a(8),g=a(7),h=a(6);i.prototype=Object.create(e.prototype),i.prototype.constructor=i,b.exports=i},{18:18,50:50,6:6,7:7,8:8}],10:[function(a,b,c){function e(){var a=d.defer();return a.resolve(),a.promise}var d=a(118);b.exports=e},{118:118}],11:[function(a,b,c){function h(a){return d([3,,.2597,.3427,.3548,.04+.03*a,,.1573,,,,,,,,,.3027,-0.0823,1,,,,,.5])}function i(a){var b=.1+a*.2,c=.08;return d([3,.4,1,,.81,b,,,,.04,.45,,,,,,.58,,c,,.05,.05,,.8])}function r(a){var b=new f({src:[a],volume:0,loop:!0,autoplay:!0});return{setVolume:function(a){b.volume(a)},stop:function(){b.stop()}}}function t(a,b,c){g.usingWebAudio&&(a.pos(c.x,c.y,0,b),c.vel&&a.velocity(c.vel[0],c.vel[1],0,b))}function u(a,b,c){if(!(a in k))throw new Error(a+" is unknown");if(!g.usingWebAudio)return;c=c||1;var d=k[a],e=d.length===1?d[0]:d[~~(Math.random()*d.length)],f=e.play();e.volume(c,f);if(b){var h=[e,f,b];t.apply(null,h),s.push(h),e.once("end",function(){var a=s.indexOf(h);a!==-1&&s.splice(a,1)},f)}}function v(){for(var a=0,b=s.length;a<b;++a)t.apply(null,s[a])}var d=a(110),e=a(106),f=e.Howl,g=e.Howler,j={burn:[h(0),h(.2),h(.4),h(.6),h(.8),h(1)],snowballHit:[d([3,.03,.1,.14,.28,.92,,-0.02,,,,.0155,.8768,,,,,,.35,,,,,.5])],carHit:[d([3,,.0661,,.36,.3901,,-0.5478,,,,-0.0799,.29,,,,,-0.2199,.22,-0.26,,,.02,.5])],car:[i(0),i(.5),i(1)],start:[d([2,.44,.24,,.55,.2,,.02,.02,.12,.34,,.43,.66,-0.14,,-0.54,.56,.17,,,.28,,.6])],lose:[d([2,.08,.63,.11,.84,.24,,,-0.06,.23,.77,,.43,.66,-0.14,,-0.6,.56,.32,-0.06,,,,.6])]},k={};for(var l in j){var m=[],n=j[l],o=n.length;for(var p=0;p<o;++p){var q=new f({src:[n[p]],refDistance:10,rolloffFactor:1});m.push(q)}k[l]=m}var s=[];b.exports={micOn:function(a){g.pos(a.x,a.y,0)},play:u,loop:r,update:v}},{106:106,110:110}],12:[function(a,b,c){function d(a,b){return!(b[0]>a[2]||b[2]<a[0]||b[1]>a[3]||b[3]<a[1])}b.exports=function(){var a=this.livingBound;a&&!d(this.box,a)&&(this.destroy?this.destroy():this.parent&&this.parent.removeChild(this))}},{}],13:[function(a,b,c){var d=a(18);b.exports=function(){var a=this.x,b=this.y,c=this.width;if(b>0||a<-c||a>d.WIDTH+c)this.destroy?this.destroy():this.parent&&this.parent.removeChild(this)}},{18:18}],14:[function(a,b,c){b.exports=function(a){var b=this._dieAfterTimeout;b||(b=this._dieAfterTimeout=a+(this.dieTimeout||0)),a>b&&(this.destroy?this.destroy():this.parent&&this.parent.removeChild(this))}},{}],15:[function(a,b,c){b.exports=function(){this.children.length===0&&(this.parent.removeChild(this),this.destroy&&this.destroy())}},{}],16:[function(a,b,c){b.exports=function(b,c){var d=this.children;for(var e=0;e<d.length;++e){var f=d[e];f.update&&f.update(b,c)}}},{}],17:[function(a,b,c){b.exports=function(b,c){var d=this.vel;if(d){var e=this.position;this.position.set(e.x+d[0]*c,e.y+d[1]*c)}}},{}],18:[function(a,b,c){b.exports=a(65)},{65:65}],19:[function(a,b,c){function f(a){var b=e.defer(),c=new d.BitmapFontLoader(a);return c.on("loaded",b.resolve),c.load(),b.promise}var d=a(117),e=a(118);b.exports={ready:e.all([,f("./fonts/Monda.xml")]).delay(100),style:function(a,b){return"bold "+(a||12)+" Monda"}}},{117:117,118:118}],20:[function(a,b,c){function w(){var a=j.offset();return isNaN(a)||(v=a),Date.now()-v}function C(a){var b="grewebisawesome"+i(w()),c=new n(b,B,a);c.on("GameOver",function(){e.delay(6e3).fin(function(){c.destroy(),C(a),c=null}).done()}),y=c,z&&z.setGame(y),A.setGame(y)}function D(a){function d(a){g(d);var e=Math.max(w(),c);c=e,b||(b=a);var f=Math.min(100,a-b);b=a,y.update(e,f),z&&z.update(e,f),x.render(y),A.update(e,f)}C(a);var b,c=0;g(d)}var d=a(124),e=a(118),f=a(120),g=a(125),h=a(137),i=a(64);a(136);var j=window.ntp,k=a(10),l=a(19),m=a(52),n=a(56),o=a(57),p=a(23),q=a(5),r=h("https://bonhomme.herokuapp.com/",{reconnection:!1}),s=e.defer(),t=s.promise;r.on("connect",s.resolve),r.on("connect_error",s.reject),j.init(r);var u=t.delay(2e3),v=0,x,y,z,A,B;t.then(function(){z=new p(r),y&&z.setGame(y)}),d.then(function(){A=new m,B=new q,x=A.createRenderer();var a=k(),b=e.all([A.getPlayerName().fail(function(){return null}),a,u,l.ready]),c=new o,d;return function f(a){d||(d=a);if(!b.isPending())return;g(f),c.setProgress((a-d)/2200),c.update(a-d),x.render(c)}(),b.spread(D)}).done();var E=console.error;window.onerror=console.error=function(a){E.call(console,a);var b=!!function(){try{var a=document.createElement("canvas");return!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}();f("https://bonhomme.herokuapp.com/report/error",{method:"POST",data:{userAgent:window.navigator.userAgent,e:""+a,message:a.message,stack:a.stack,supports:{webgl:b}}})}},{10:10,118:118,120:120,124:124,125:125,136:136,137:137,19:19,23:23,5:5,52:52,56:56,57:57,64:64}],21:[function(a,b,c){b.exports=a(22)},{22:22}],22:[function(a,b,c){function k(a){return function(c,d){return a.logs.push(c+": "+JSON.stringify(d)),d}}function l(a,b,c){var d,e=new Int8Array(b);for(d=0;d<b;++d)e[d]=1;var f=c-b;for(d=0;d<f;++d)e[~~(b*a())]++;return e}function m(a,b){var c=[],e=0,f=0;for(var g=0;g<a;++g){var h=!d.contains(b,g);h&&f&&(c.push(f),f=0),!h&&e&&(c.push(e),e=0),h?e++:f--}return e&&c.push(e),f&&c.push(f),c}function n(a){return d.map(a,function(a){return~~a})}function o(a,b){return d.map(a,function(a){return b*a})}function p(a,b){var c=[];for(var d=0;d<b.length;++d){var e=b[d];if(e<0)c.push(e*a.length);else for(var f=0;f<e;++f)for(var g=0;g<a.length;++g)c.push(a[g])}return c}function q(a,b,c,d,e,f,g,h){return{scale:a,pos:b,vel:g,rot:(d+2*Math.PI)/c,speed:e,count:c,pattern:f,life:6e3,ang:0,randAng:h||0,randVel:h||0}}function r(a,b,c,d,e,f,g){var h=6,i=[];for(var j=0;j<h;++j){var k=(j%2?-1:1)*~~(1+((j%2?f:e)-1)*a());i.push(k)}return{y:b,leftToRight:c,vel:d,speed:80*(1+(g||0))/d,seq:i}}function s(a,b){return d.map(d.range(0,a),function(c){var d=b(c*j,c);return d.first=c===a-1,d.last=c===0,d})}function t(a,b,c,d){var g=~~Math.min(.8+a()+5*c*a(),d);if(g<=0)return[];var h=1-1/g,i=a()<.5;return s(g,function(d){var g=.08+.5*f(a(),1-h,.8)*f(a(),c,.5),j=3+h*a()+6*a()*c,k=9-5*f(e(0,20,c*h),a(),.5),l=.2+.2*(1-c);return r(a,b+d,i=!i,g,j,k,l)})}function u(a){var b=~~(3*a());switch(b){case 0:return n(o([.2+.8*a(),-a(),.2+.8*a(),-1-a()],20+20*a()));case 1:return n(o([.5+.5*a(),-0.5-2*a()],80));case 2:return n(o([1,-1],30+50*a()))}throw new Error("reached unmatched case "+b)}function v(a,b){function i(a){return.3+.8*a.random()}var c={roads:[],snowballs:[],fireballs:[],logs:[]},e=k(c),j,n=~~(1.6+1*b+2*b*a()),o=n*(1+1.2*a()*a()+3*b*a()),r=l(a,n,o);e("distribCols",r);var s=f(30,g.WIDTH/2-30,a()*a())|0,t=f(100,200,a())|0;for(j=0;j<n;++j){var v=r[j],w=[j%2?s:h-s,80+t*(j/2|0)],x=(a()<.5?1:-1)*(.01+.01*b)*a()*a(),y=90-40*a()-30*b,z=d.range(Math.min(v*(.2*(1-b)+.4*a()*a()),v-1)),A=u(a),B=m(v,z),C=p(B,A);e("repeatPattern",A);var D=q(i,w,v,x,y,C,.2);c.fireballs.push(D)}return c}function w(a,b){function i(a){return.2+.2*a.random()}var c={roads:[],snowballs:[],fireballs:[],logs:[]},e=k(c),j,n=f(b,a(),.5);e("more-cols",n);var o=~~(1.8+4*b*b*f(b,a(),.5)),p=o*2+40*n,r=f(50,g.WIDTH/2-50,1-a()*a())|0,s=l(a,o,p);for(j=0;j<o;++j){var t=[j%2?r:h-r,100+~~(j/2)*60],v=(a()<.5?1:-1)*(.05*a()+.2*a()*b),w=300-280*a()*b*n,x=s[j],y=d.range(Math.min(x*(.2*(1-b)+.4*a()*a()),x-1)),z=a()<.2?u(a):m(x,y);c.snowballs.push(q(i,t,x,v,w,z,.25,.1))}return c}function x(a,b){var c=a()<.5?[b/2,b]:[b,b/2],d=t(a,0,c[0],5),e=160-80*a()-60*b*a(),g=d.length*j,h=d.length*j+e,k=~~((i-h)/j),l=t(a,h,c[1],k),m=[];return a()>f(a(),b,.8)&&m.push({scale:function(){return.5},pos:[5,g+e*.5],vel:.1+.1*a(),ang:0,randAngle:.8*a(),speed:500+1e3*a(),life:6e3}),{roads:d.concat(l),snowballs:m,fireballs:[],logs:[]}}function y(a,b,c){function l(a){return function(b){return a*(.8+.4*b.random())}}function m(a){return.3+.3*a.random()*a.random()}var e={roads:[],snowballs:[],fireballs:[],logs:[]},g=k(e),n,o,p,r,s,v,w,x=6;c>0&&(e.roads=t(a,0,b,x));var y=e.roads.length,z=j*y,A=d.max(d.pluck(e.roads,"vel")),B=y?Math.max(0,Math.min(Math.pow(y/x,2)+2*(A-.05),1)):0;g("road-difficulty",B);var C=6,D=5,E=z,F=i-z,G=d.range(1,C).map(function(a){return Math.floor(a*h/C)}),H=d.range(1,D).map(function(a){return Math.floor(E+a*F/D)}),I=[];G.forEach(function(a){H.forEach(function(b){I.push([a,b])})});if(c>1&&a()<.9){o=2*a()*a();for(s=0;s<o;++s)n=I.splice(~~(a()*I.length),1)[0],p=1+~~(a()*a()+5*a()*a()*a()),r=a()*(a()*.3+.1*(c%24)/24),w=a()*a(),v=(1.1-w)*f(600,200,B),e.snowballs.push(q(m,n,p,r,v,a()<w?u(a):null,.22,.05))}if(c>4&&a()<.9){o=3*(1-B)*a()*a();for(s=0;s<o;++s)n=I.splice(~~(a()*I.length),1)[0],p=1+~~(a()*a()+5*a()*a()*a()),r=a()*a()*.3,w=a()*a(),g("a",w),v=(1.1-w)*f(100,600,B),e.fireballs.push(q(l(.4+.3*b+2*a()*(1-w)*(1-w)),n,p,r,v,a()*a()>w?u(a):[~~(10+50*a()),-1],.25-.2*a()*w))}return e}function z(a,b){function n(c){return.2*b+.4+.3*c.random()+.2*b*a()}function o(a){return.3*b+.2+.3*a.random()*a.random()}var c={roads:[],snowballs:[],fireballs:[],logs:[]},e,f=3*a()|0,g=f+2+1*a()+(3+3*a())*b|0,j=[];for(var k=f;k>=0;--k){var l=g*a()|0;d.contains(j,l)||j.push(l)}var m=0;for(var p=1;p<g;++p){if(d.contains(j,p))continue;var q=a()<.5,r=a()<.5*(1-b)+.2*a(),s=40+50*a()+30*(1-b),t=u(a);(r?c.snowballs:c.fireballs).push({scale:r?o:n,pos:[q?m:h-m,Math.floor(p*i/g)],vel:.2+.1*a(),ang:q?0:Math.PI,speed:s,pattern:t,life:6e3})}return a()<b&&(e=~~(2+a()+2*a()*b),c.fireballs.push({scale:n,pos:[a()*h,a()<.5?30:i-30],vel:.2,rot:(.02*a()+2*Math.PI)/e,count:e,speed:100,pattern:u(a),life:6e3})),a()<.2&&(e=~~(1+2*a()+4*a()*a()),c.snowballs.push({scale:o,pos:[a()*h,a()<.5?30:i-30],vel:.2,rot:(.04*a()+2*Math.PI)/e,count:e,speed:10+100*a(),pattern:[100,-200],life:6e3})),c}function B(a,b,c){var d=.2*(a/16%1)+.5*(a/32%1)+.3*(a/64)+.8*c()*c()*c(),f="standard";c()<.08*e(0,8,a)&&(f="blizzard"),c()<.15*e(0,8,a)&&(f="hell"),c()<.3*e(0,4,a)&&(f="passage"),c()<.2*e(0,4,a)&&(f="double");var g=A[f](c,d,a);return g.logs=[f+", "+d.toPrecision(3),""].concat(g.logs),g}var d=a(112),e=a(135),f=a(61),g=a(18),h=g.WIDTH,i=500,j=60,A={hell:v,blizzard:w,standard:y,"double":x,passage:z};b.exports={chunkSize:i,generate:B}},{112:112,135:135,18:18,61:61}],23:[function(a,b,c){function l(a){this.socket=a,this.score=new f(a),this.playersByIds={},this.playersData={},this.players=new j,this.names=new d.DisplayObjectContainer,a.on(k.playermove,this.onPlayerMove.bind(this)),a.on(k.playerdie,this.onPlayerDie.bind(this)),a.on(k.playerenter,this.onPlayerEnter.bind(this)),a.on(k.playerleave,this.onPlayerLeave.bind(this)),a.on(k.players,this.onPlayers.bind(this)),a.on(k.gameinfo,this.onGameInfo.bind(this));var b=this;this.env={computeAlpha:function(a){return 1-b.game.positionObfuscation(a)}},a.emit(k.ready,i)}var d=a(117),e=a(39),f=a(24),g=a(25),h=a(26),i=a(18),j=a(50),k=i.events;l.prototype={setGame:function(a){this.score.setGame(a),this.game=a,a.players.addChild(this.players),a.names.addChild(this.names),this.player&&this.player.destroy(),this.player=new g(a.player,this.socket),this.socket.emit(k.newgame)},onGameInfo:function(a){this.game.setMapName(a.mapname)},onPlayers:function(a){for(var b in a)this.onNewPlayerData(a[b],b)},onPlayerDie:function(a,b,c){if(!(b in this.playersData))return;var d=this.playersByIds[b];d&&(d.onDie(a,c,this.game),d.destroy(),delete this.playersByIds[b])},onPlayerMove:function(a,b){if(!(b in this.playersData))return;var c=this.playersByIds[b];if(!c){var d=this.playersData[b],f=new e(d.name,this.names,.8,this.env);f.position.x=-1e3,c=new h(f),this.playersByIds[b]=c,this.players.addChild(f)}c.onMove(a)},onPlayerEnter:function(a,b){this.onNewPlayerData(a,b)},onPlayerLeave:function(a){var b=this.playersByIds[a];b&&(b.destroy(),delete this.playersByIds[a]),delete this.playersData[a]},onNewPlayerData:function(a,b){this.playersData[b]=a},update:function(a,b){if(!this.game)return;this.player.update(a,b);for(var c in this.playersByIds)this.playersByIds[c].update(a,b)}},b.exports=l},{117:117,18:18,24:24,25:25,26:26,39:39,50:50}],24:[function(a,b,c){function g(a){this.socket=a,this.scores=[],this.refreshScores=d(this._refreshScores.bind(this),800);var b=this;a.on(f.scores,function(a){b.scores=b.scores.concat(a),b.refreshScores(!1)}),a.on(f.newscore,this.addScore.bind(this))}var d=a(121),e=a(18),f=e.events;g.prototype={addScore:function(a){this.scores.push(a),this.refreshScores(!0)},_refreshScores:function(a){this.scores.sort(function(a,b){return a.score<b.score}),this.game&&this.game.setScores(this.scores,a)},setGame:function(a){var b=this;this.game=a,a.setScores(this.scores),a.on("GameOver",function(a){b.socket.emit(f.playerdie,a.data)})}},b.exports=g},{121:121,18:18}],25:[function(a,b,c){function g(a,b,c){this.player=a,this.socket=b,this.rate=c||d.networkSendRate,this._lastSubmit=0,this.socket.emit(e.playerready,{name:a.name})}var d=a(18),e=d.events,f=a(27);g.prototype={destroy:function(){this.player=null,this.socket=null},update:function(a){if(a-this._lastSubmit<this.rate)return;this._lastSubmit=a;if(this.player.dead)return;if(this.player.controls.paused())return;var b=f.encodeFromPlayer(this.player,a);this.socket.emit(e.playermove,b)}},b.exports=g},{18:18,27:27}],26:[function(a,b,c){function g(a,b){var c=new d;a.controls=c,this.player=a,this.controls=c,this.delay=b||e.networkPlaybackDelay,this.timeout=this.delay+100,this.lastEvts=0,this.evts=[],this.maxProgress=a.maxProgress}var d=a(3),e=a(18),f=a(27);g.prototype={destroy:function(){this.player.destroy(),this.player=null,this.evts=null},onMove:function(a){var b=f.decode(a);this.evts.push(b)},onDie:function(a,b,c){c.world.playerDied(this.player,!1)},update:function(a){this.lastEvts+this.timeout<a&&this.player.controls.setState({x:0,y:0});for(var b=0;b<this.evts.length;++b){var c=this.evts[b];c.time<a-this.delay&&(this.lastEvts=c.time,f.applyToPlayer(this.player,c),this.maxProgress=Math.min(this.player.y,this.maxProgress),this.player.maxProgress=this.maxProgress,this.evts.splice(b--,1))}}},b.exports=g},{18:18,27:27,3:3}],27:[function(a,b,c){b.exports=a(63)},{63:63}],28:[function(a,b,c){function j(a,b){var c=new d.DisplayObjectContainer,e=new d.Sprite(f),i=new d.Sprite(g);return e.tint=a,c.addChild(e),b.forEach(function(a){var b=new d.Sprite(h[a]);c.addChild(b)}),c.addChild(i),c.width=84,c.height=48,c}function k(a){var b=a(),c=a(),d=a(),f=a(),g=a(),h=a(),i=b*b,j=.6+ -0.5*c*i+Math.pow(f,3),k=.2*(g+h)+(1.2+.5*d)*(.5-Math.abs(i-.3));return k<.3?(k*=.5,j*=.3):k>.85?j*=.5:j>.5&&k<.7&&(j=1),e(~~(360*i),~~(100*Math.max(0,Math.min(j,1))),~~(100*Math.max(0,Math.min(k,1))))}function l(a){var b=k(a),c=a()<.25?[i[~~(a()*i.length)]]:[];return j(b,c)}var d=a(117),e=a(60),f=d.Texture.fromImage("./img/car_chassis.png"),g=d.Texture.fromImage("./img/car_top.png"),h={racestripe1:d.Texture.fromImage("./img/car_racestripe1.png"),racestripe2:d.Texture.fromImage("./img/car_racestripe2.png"),racestripe3:d.Texture.fromImage("./img/car_racestripe3.png")},i=Object.keys(h);b.exports=l},{117:117,60:60}],29:[function(a,b,c){function j(a,b){d.DisplayObjectContainer.call(this);var c=e(a);this.addChild(c),this.cacheAsBitmap=!0,this.livingBound=b,this.box=[0,0,0,0]}var d=a(117),e=a(28),f=a(17),g=a(12),h=84,i=48;j.prototype=Object.create(d.DisplayObjectContainer.prototype),j.prototype.constructor=j,j.prototype.destroy=function(){this.parent&&this.parent.removeChild(this)},j.prototype.update=function(a,b){this._init||(this._init=!0,this.width=this.vel[0]<0?-h:h,this.height=i,this.w=Math.min(this.width,0)),f.call(this,a,b),this.box[0]=this.x+this.w+h*.1,this.box[1]=this.y,this.box[2]=this.box[0]+h*.8,this.box[3]=this.box[1]+i,g.call(this,a,b)},b.exports=j},{117:117,12:12,17:17,28:28}],30:[function(a,b,c){function m(a,b,c,e){d.DisplayObjectContainer.call(this);var j=f(a.player+":"+a.score),k=new d.Sprite(l[l.length*j()|0]);k.pivot.set(32,64),k.scale.set(.33,.33);var m=new g(a.player,{align:"center",font:h.style(e||10)});k.tint=m.tint=c?16742144:15623680,m.updateText(),m.position.set(-m.width/2,0),this.position.set(a.x,i.scoreToY(a.score)),this.addChild(k),this.addChild(m),this.alpha=a.opacity,this.animated=b}var d=a(117),e=a(135),f=a(126),g=a(49),h=a(19),i=a(41),j=a(62),k=d.Texture.fromImage("./img/carrots.png"),l=[0,1,2].map(function(a){return j.tile64(k,a,0)});m.prototype=Object.create(d.DisplayObjectContainer.prototype),m.prototype.constructor=m,m.prototype.update=function(a){this.start||(this.start=a);if(this.animated){var b=1+e(4e3,0,a-this.start);this.scale.set(b,b)}},b.exports=m},{117:117,126:126,135:135,19:19,41:41,49:49,62:62}],31:[function(a,b,c){function j(a,b){var c=a.scale;delete a.scale,a.front=20,a.seed=""+a.pos,a.spawn=function(a){var d=new f(c(a));d.position.set.apply(d.position,a.position),d.vel=a.velocity,d.rotation=a.angle,b(d)};var d=new e(a);g.call(this,d,60,h,i),this.position.set.apply(this.position,a.pos),this.scale.set(.5,.5),this.spawner=d}var d=a(117),e=a(103),f=a(32),g=a(44),h=d.Texture.fromImage("./img/firespawner.png"),i=d.Texture.fromImage("./img/firespawnerweapon.png");j.prototype=Object.create(g.prototype),j.prototype.constructor=j,j.prototype.update=function(a,b){this.spawner.update(a),g.prototype.update.call(this,a,b)},b.exports=j},{103:103,117:117,32:32,44:44}],32:[function(a,b,c){function i(a,b){d.Sprite.call(this,h),this.pivot.set(16,16),this.growSpeed=.005,this.targetScale=a,this.initialScale=a,this.scale.set(0,0),this.dieTimeout=b||6e3,this.box=[0,0,0,0]}var d=a(117),e=a(13),f=a(17),g=a(14),h=d.Texture.fromImage("./img/fireball.png");i.prototype=Object.create(d.Sprite.prototype),i.prototype.constructor=i,i.prototype.update=function(a,b){f.call(this,a,b),this.startT||(this.startT=a);if(this.scale.x<this.targetScale){var c=Math.min((a-this.startT)*this.growSpeed,this.targetScale);this.scale.set(c,c)}var d=this.width,h=this.height;this.box[0]=this.x-this.pivot.x*this.scale.x+.2*d,this.box[1]=this.y-this.pivot.y*this.scale.y+.2*h,this.box[2]=this.box[0]+d*.6,this.box[3]=this.box[1]+h*.6,e.call(this,a,b),g.call(this,a,b)},i.prototype.playerLifeValue=function(){return-30*this.initialScale},i.prototype.explodeInWorld=function(a){a.fireballExplode(this),this.parent&&this.parent.removeChild(this)},i.prototype.hitPlayer=function(a){a.onFireball(this)},b.exports=i},{117:117,13:13,14:14,17:17}],33:[function(a,b,c){function h(a){d.Sprite.call(this,g[~~(Math.random()*g.length)]),this.rotation=Math.random()*2*Math.PI,this.pivot.set(32,32),this.height=this.width=a}var d=a(117),e=a(62),f=d.Texture.fromImage("./img/foots.png"),g=[0,1,2,3,4,5].map(function(a){return e.tile64(f,0,a)});h.prototype=Object.create(d.Sprite.prototype),h.prototype.constructor=h,b.exports=h},{117:117,62:62}],34:[function(a,b,c){function g(){d.DisplayObjectContainer.call(this),this.containers=new e(this.alloc.bind(this),this.free.bind(this),{chunkSize:200,ahead:1,behind:1,bounds:[-4,+Infinity]})}var d=a(117),e=a(134),f=a(33);g.prototype=Object.create(d.DisplayObjectContainer.prototype),g.prototype.constructor=g,g.prototype.alloc=function(){var a=new d.DisplayObjectContainer;return this.addChild(a),a},g.prototype.free=function(a,b){this.removeChild(b)},g.prototype.watchWindow=function(a){this.containers.move(a)},g.prototype.walk=function(a,b){var c=new f(b);c.position.set(a.x,a.y);var d=this.containers.getChunk(-a.y);d&&d.addChild(c)},b.exports=g},{117:117,134:134,33:33}],35:[function(a,b,c){function j(a,b){d.DisplayObjectContainer.call(this);if(h[b]){var c=new d.Sprite(i);c.width=c.height=24,c.tint=h[b],c.position.set(2,2),this.addChild(c)}var g=new e(a.player,{align:"center",font:f.style(10)});g.tint=13386752,g.updateText(),g.position.set(30,10),this.addChild(g);var j=new e(""+a.score,{align:"center",font:f.style(12,!0)});j.tint=13386752,j.updateText(),j.position.set(100,10),this.addChild(j)}var d=a(117),e=a(49),f=a(19),g=a(62),h=[16763938,10070715,13008168],i=g.tile64(d.Texture.fromImage("./img/carrots.png"),0,0);j.prototype=Object.create(d.DisplayObjectContainer.prototype),j.prototype.constructor=j,b.exports=j},{117:117,19:19,49:49,62:62}],36:[function(a,b,c){function k(){d.Sprite.call(this,i),this.logo=new d.Sprite(j),this.logo.scale.set(.5,.5),this.logo.position.set((h.WIDTH-200)/2,0),this.logo.tint=6588614,this.highscoresTitle=new e("Daily Highscores",{font:g.style(18,!0)}),this.highscoresTitle.position.set(10,200),this.highscoresTitle.tint=13386752,this.highscoresTitle.updateText(),this.highscores=new d.DisplayObjectContainer,this.addChild(this.logo),this.addChild(this.highscoresTitle),this.addChild(this.highscores)}var d=a(117),e=a(49),f=a(35),g=a(19),h=a(18),i=d.Texture.fromImage("./img/map2.png"),j=d.Texture.fromImage("./img/logo.png");k.prototype=Object.create(d.Sprite.prototype),k.prototype.constructor=k,k.prototype.setScores=function(a){this.highscores.removeChildren();for(var b=0;b<a.length&&b<5;++b){var c=a[b],d=new f(c,b);d.position.set(40,240+30*b),this.highscores.addChild(d)}},b.exports=k},{117:117,18:18,19:19,35:35,49:49}],37:[function(a,b,c){function s(a,b,c,h,k,l){f.DisplayObjectContainer.call(this),this.seed=a,this.cars=b,this.snowballs=c,this.fireballs=h,this.spawners=k,this.objects=l;var m=this.homeTile=new i,n=new f.DisplayObjectContainer;this.addChild(n);var o=d.defer();this.tile1=o.promise,this.generateMapTileWindow=new g(function(b){var c=-b*r,d;return b===0?d=m:d=new j(e(a+"tile"+b)),d.position.y=c,d.i=b,n.addChildAt(d,0),b===1&&o.resolve(d),d},function(a,b){n.removeChild(b)},{chunkSize:r,right:2,left:1,bounds:[0,+Infinity]}),this.generateLevels=new g(this.allocChunk.bind(this),this.freeChunk.bind(this),{chunkSize:q.chunkSize,right:1,left:1,bounds:[1,+Infinity]})}var d=a(118),e=a(126),f=a(117),g=a(134),h=a(18),i=a(36),j=a(38),k=a(47),l=a(31),m=a(45),n=a(50),o=a(16),p=a(43),q=a(21),r=400;s.prototype=Object.create(f.DisplayObjectContainer.prototype),s.prototype.constructor=s,s.prototype.setName=function(a){console.log("Welcome to "+a);var b=this.objects;this.tile1.then(function(c){var d=new k(a);d.position.set(h.WIDTH/2,c.y+r),b.addChild(d)}).done()},s.prototype.setScores=function(a){this.homeTile.setScores(a)},s.prototype.watchWindow=function(a){this._win=a},s.prototype.update=function(a,b){var c=this._win;o.call(this,a,b),c&&(this.generateMapTileWindow.move(c,a),this.generateLevels.move(c,a))},s.prototype.freeChunk=function(a,b){b.destroy()},s.prototype.allocChunk=function(a,b){function j(a){return i.push(a),a}function v(a){r.addChild(j(a))}function w(a){t.addChild(a)}function x(a){s.addChild(a)}var c=e(this.seed+"-"+a),d=q.generate(a,b,c),g=-a*q.chunkSize,i=[],k=j(new n),o=j(new f.DisplayObjectContainer);this.addChild(k),this.addChild(o);var r=this.cars,s=this.fireballs,t=this.snowballs,u=this.spawners;(d.roads||[]).forEach(function(a){a.y+=g;var b=new p(a,v,o);k.addChild(b)}),(d.snowballs||[]).forEach(function(a){a.pos[1]+=g;var b=j(new m(a,w));u.addChild(b)}),(d.fireballs||[]).forEach(function(a){a.pos[1]+=g;var b=j(new l(a,x));u.addChild(b)});if(this.debug){var y=j(new f.DisplayObjectContainer),z=q.chunkSize;y.position.set(0,g),this.debug.addChild(y);var A=new f.Graphics;A.beginFill(16711680),A.drawRect(0,z-2,h.WIDTH,2),A.endFill();var B=new f.Text("chunk "+a,{fill:"#F00",font:"bold 32px monospace"});B.scale.set(.5,.5),B.position.set(h.WIDTH-B.width-4,z-4-B.height);var C=z-4;(d.logs||[]).forEach(function(a){var b=new f.Text(a,{fill:"#F00",font:"normal 16px monospace"});b.scale.set(.5,.5),C-=b.height,b.position.set(4,C),b.alpha=.7,y.addChild(b)}),y.addChild(A),y.addChild(B)}return d=null,{destroy:function(){for(var a=0;a<i.length;++a){var b=i[a];b.parent&&b.parent.removeChild(b)}i.length=0,i=null}}},b.exports=s},{117:117,118:118,126:126,134:134,16:16,18:18,21:21,31:31,36:36,38:38,43:43,45:45,47:47,50:50}],38:[function(a,b,c){function f(a){d.Sprite.call(this,e[a()*e.length|0])}var d=a(117),e=[d.Texture.fromImage("./img/map1.png"),d.Texture.fromImage("./img/map2.png"),d.Texture.fromImage("./img/map3.png")];f.prototype=Object.create(d.Sprite.prototype),f.prototype.constructor=f,b.exports=f},{117:117}],39:[function(a,b,c){function g(a,b,c,g){this.nameSprite=new e("",{font:d.style(12)}),this.nameSprite.tint=13386752,b.addChild(this.nameSprite),f.call(this,a),this.maxAlpha=c||1,this.nameSprite.alpha=this.alpha=this.maxAlpha,this.env=g||{}}var d=a(19),e=a(49),f=a(41);g.prototype=Object.create(f.prototype),g.prototype.constructor=g,g.prototype.update=function(a,b){f.prototype.update.call(this,a,b),this.env.computeAlpha&&(this.nameSprite.alpha=this.alpha=this.maxAlpha*this.env.computeAlpha(this.position)),this.nameSprite.position.set(this.position.x-this.nameSprite.width/2,this.y+this.height*.4)},g.prototype.destroy=function(){this.nameSprite.parent.removeChild(this.nameSprite),this.parent.removeChild(this)},Object.defineProperty(g.prototype,"name",{set:function(a){this._name=a,this.nameSprite.text=a||""},get:function(){return this._name}}),b.exports=g},{19:19,41:41,49:49}],40:[function(a,b,c){function e(a,b,c,e,f,g){d.DisplayObjectContainer.call(this);var h=e/2;this.position.x=a.x,this.position.y=a.y,this.speed=f,this.nb=c.length;var i=0;this.sprites=c.map(function(a){var c=new d.Sprite(a);return c.pivot.set(h,h),g&&(c.rotation=i+=g*(Math.random()-.5)),c.width=c.height=b,c})}var d=a(117);e.prototype=Object.create(d.DisplayObjectContainer.prototype),e.prototype.constructor=e,e.prototype.update=function(a){this.current||(this.start=a);var b=~~((a-this.start)/this.speed);if(b<this.nb){var c=this.sprites[b];c!==this.current&&(this.current&&this.removeChild(this.current),this.addChild(c),this.current=c)}else this.parent.removeChild(this)},b.exports=e},{117:117}],41:[function(a,b,c){function m(a,b){this.name=a,d.Sprite.call(this,k),this.life=201,this.maxLife=999,this.meltingSpeed=.0025,this.moveSpeed=i.playerMoveSpeed,this.maxMoveBack=120,this.dead=!1,this.controls=null,this.vel=[0,0],this.position.x=i.WIDTH/2,this.position.y=i.HEIGHT-50,this.maxProgress=i.HEIGHT-this.maxMoveBack-25,this._m=0,this.pivot.set(250,200),b&&b.addChild(this.footprints=new j),this.box=[0,0,0,0]}var d=a(117),e=a(135),f=a(61),g=a(17),h=a(11),i=a(18),j=a(34),k=d.Texture.fromImage("./img/player.png"),l=[d.Texture.fromImage("./img/player1.png"),k,d.Texture.fromImage("./img/player2.png")];m.prototype=Object.create(d.Sprite.prototype),m.prototype.constructor=m,m.prototype.die=function(){this.dead=!0},m.prototype.isDead=function(){return this.dead},m.prototype.constraintX=function(a){var b=this.width/2;return Math.max(b,Math.min(a,i.WIDTH-b))},m.prototype.update=function(a,b){if(this.dead)return;this.controls.update&&this.controls.update(a,b);var c=this.controls.x(),d=this.controls.y(),h=this.position.x,i=this.position.y,j=this._m;if(c||d){j||(this._m=j=a);var m=this.moveSpeed*f(.5,1,e(0,200,a-j));c&&d&&(m/=1.414),this.vel[0]=c*m,this.vel[1]=-d*m}else this._m=0,this.setTexture(k),this.vel[0]=0,this.vel[1]=0;g.call(this,a,b);var n=this.x,o=this.y;this.maxProgress=Math.min(this.maxProgress,o),this.maxProgress<0&&(this.life-=b*this.meltingSpeed),o=Math.min(o,this.maxProgress+this.maxMoveBack);var p=.6+this.life/150,q=this.width=50*p,r=this.height=40*p;d<0?this.rotation=Math.PI:d>0?this.rotation=0:c>0?this.rotation=Math.PI/2:c<0&&(this.rotation=-Math.PI/2),n=this.constraintX(n),(c||d)&&(n!==h||o!==i)&&(this.setTexture(l[~~(a/150)%l.length]),this.footprints&&(!this._lastFoot||a-this._lastFoot>30)&&Math.random()<.7&&this.footprints.walk(this.position,Math.min((.8+.4*Math.random())*this.width/2,100))),this.x=n,this.y=o,this.box[0]=n-this.pivot.x*this.scale.x+q*.25,this.box[1]=o-this.pivot.y*this.scale.y+r*.2,this.box[2]=this.box[0]+q*.5,this.box[3]=this.box[1]+r*.6},m.prototype.knock=function(a,b){this.x=this.constraintX(this.x+a),this.y+=b},m.prototype.
onProjectile=function(a){var b=4+100*a.width/this.width;this.knock(b*a.vel[0],b*a.vel[1])},m.prototype.onSnowball=function(a){this.life=Math.min(this.life+a.playerLifeValue(),this.maxLife),this.onProjectile(a)},m.prototype.onFireball=function(a){this.life+=a.playerLifeValue(),this.onProjectile(a)},m.prototype.onCarHit=function(a){h.play("carHit",null,1),this.life-=100;var b=8e3/this.width;this.knock(b*a.vel[0],0),this.footprints&&this.footprints.walk(this.position,this.width)},m.prototype.getScore=function(){return{player:this.name,x:~~this.x,score:m.getPlayerScore(this)}},m.getPlayerScore=function(a){return~~Math.max(0,-a.y)},m.scoreToY=function(a){return-a},b.exports=m},{11:11,117:117,135:135,17:17,18:18,34:34,61:61}],42:[function(a,b,c){function h(a){if(!(this instanceof h))return new h(a);d.extend(this,a);if(typeof this.spawn!="function")throw new Error("spawn function must be implemented and return a PIXI object.");this._trigger()}var d=a(112),e=a(16),f=a(15),g={pos:[0,0],vel:.2,n:8,spawn:null,front:0,angleOffset:0};d.extend(h.prototype,g),h.prototype._trigger=function(){d.range(0,2*Math.PI,2*Math.PI/this.n).forEach(function(a){var b=a+this.angleOffset;this.spawn({pos:[this.pos[0]+this.front*Math.cos(b),this.pos[1]+this.front*Math.sin(b)],vel:[this.vel*Math.cos(b),this.vel*Math.sin(b)]})},this)},h.prototype.update=function(a,b){e.call(this,a,b),f.call(this)},b.exports=h},{112:112,15:15,16:16}],43:[function(a,b,c){function m(a,b,c){d.DisplayObjectContainer.call(this);var m=[a.leftToRight?-100:f.WIDTH+100,a.y],n=a.leftToRight?0:Math.PI,o=function(c){var d=new g(c.random,[-100,a.y,f.WIDTH+100,a.y+100]);d.position.set.apply(d.position,c.position),d.vel=c.velocity,b(d)},p=new e({seed:a.y,pos:m,spawn:o,ang:n,speed:a.speed,vel:a.vel,pattern:a.seq}),q=a.last?a.first?i:k:a.first?j:h,r=new d.Sprite(q);r.position.set(0,a.y),this.addChild(r);if(!a.last){var s=new d.Sprite(l);s.position.set(-~~(100*Math.random()),a.y-8),c.addChild(s)}this.spawner=p}var d=a(117),e=a(103),f=a(18),g=a(29),h=d.Texture.fromImage("./img/road.png"),i=d.Texture.fromImage("./img/roadinout.png"),j=d.Texture.fromImage("./img/roadin.png"),k=d.Texture.fromImage("./img/roadout.png"),l=d.Texture.fromImage("./img/roadseparator.png");m.prototype=Object.create(d.DisplayObjectContainer.prototype),m.prototype.constructor=m,m.prototype.update=function(a){this._init||(this._init=!0,this.spawner.init(a)),this.spawner.update(a)},b.exports=m},{103:103,117:117,18:18,29:29}],44:[function(a,b,c){function g(a,b,c,d){e.DisplayObjectContainer.call(this),this.weaponTexture=d,this.spawner=a,this.pivot.set(b,b),this.radius=b,this.heads=new e.DisplayObjectContainer,this.addChild(this.heads),this.addChild(new e.Sprite(c))}var d=a(135),e=a(117),f=Math.PI/2;g.prototype=Object.create(e.DisplayObjectContainer.prototype),g.prototype.constructor=g,g.prototype.syncHeadCount=function(a){var b=this.heads.children.length,c;for(c=b;c<a;++c){var d=new e.Sprite(this.weaponTexture);d.pivot.set(this.radius,this.radius),d.position.set(this.radius,this.radius),this.heads.addChild(d)}for(c=b;c>a;--c)this.heads.removeChild(this.children[0])},g.prototype.update=function(a){var b=this.spawner.getHeads(a),c=this.heads.children,e=this.radius;this.syncHeadCount(b.length);for(var g=0;g<b.length;++g){var h=b[g],i=c[g];i.rotation=h.angle+f,i.pivot.y=e*(h.trigger?1-.1*d(.5,0,h.p):.8)}},b.exports=g},{117:117,135:135}],45:[function(a,b,c){function j(a,b){var c=a.scale;delete a.scale,a.front=40,a.seed=""+a.pos,a.spawn=function(a){var d=new f(c(a),a.random);d.position.set.apply(d.position,a.position),d.vel=a.velocity,d.rotation+=a.angle,b(d)};var d=new e(a);g.call(this,d,60,h,i),this.position.set.apply(this.position,a.pos),this.scale.set(.5,.5),this.spawner=d}var d=a(117),e=a(103),f=a(46),g=a(44),h=d.Texture.fromImage("./img/snowspawner.png"),i=d.Texture.fromImage("./img/snowspawnerweapon.png");j.prototype=Object.create(g.prototype),j.prototype.constructor=j,j.prototype.update=function(a,b){this.spawner.update(a),g.prototype.update.call(this,a,b)},b.exports=j},{103:103,117:117,44:44,46:46}],46:[function(a,b,c){function k(a,b){d.Sprite.call(this,j[j.length*b()|0]),this.rotation=2*Math.PI*b(),this.pivot.set(32,32),this.scale.set(a,a),this.dieTimeout=6e3,this.box=[0,0,0,0]}var d=a(117),e=a(13),f=a(17),g=a(14),h=a(62),i=d.Texture.fromImage("./img/snowballs.png"),j=[0,1,2,3].map(function(a){return h.tile64(i,a,0)});k.prototype=Object.create(d.Sprite.prototype),k.prototype.constructor=k,k.prototype.update=function(a,b){f.call(this,a,b);var c=this.width,d=this.height;this.box[0]=this.x-this.pivot.x*this.scale.x+.2*c,this.box[1]=this.y-this.pivot.y*this.scale.y+.2*d,this.box[2]=this.box[0]+c*.6,this.box[3]=this.box[1]+d*.6,e.call(this,a,b),g.call(this,a,b)},k.prototype.playerLifeValue=function(){return 20*this.scale.x},k.prototype.explodeInWorld=function(a){a.snowballExplode(this),this.parent&&this.parent.removeChild(this)},k.prototype.hitPlayer=function(a){a.onSnowball(this)},b.exports=k},{117:117,13:13,14:14,17:17,62:62}],47:[function(a,b,c){function h(a){d.DisplayObjectContainer.call(this);var b=new d.Sprite(g),c=new e(a,{font:f.style(50)});c.tint=65793,c.updateText(),c.position.set(75+(250-c.width)/2,130),this.addChild(b),this.addChild(c),this.pivot.set(200,375),this.scale.set(.5,.5)}var d=a(117),e=a(49),f=a(19),g=d.Texture.fromImage("./img/townsign.png");h.prototype=Object.create(d.DisplayObjectContainer.prototype),h.prototype.constructor=h,b.exports=h},{117:117,19:19,49:49}],48:[function(a,b,c){function v(){i.play("lose")}function w(a,b,c,e){d.DisplayObjectContainer.call(this),this._focusY=0,this.shaking=0,this.snowballs=a,this.fireballs=b,this.explosions=c,this.explosionsPlayer=e}var d=a(117),e=a(152),f=a(46),g=a(40),h=a(42),i=a(11),j=a(18),k=a(16),l=a(58),m=a(62),n=m.tile64,o=m.tile256,p=d.Texture.fromImage("./img/fireexplosion.png"),q=[n(p,0,0),n(p,1,0),n(p,2,0)],r=d.Texture.fromImage("./img/snowexplosion.png"),s=[n(r,0,0),n(r,1,0),n(r,2,0)],t=d.Texture.fromImage("./img/playerdeath.png"),u=[o(t,0,0),o(t,1,0),o(t,2,0),o(t,3,0)];w.prototype=Object.create(d.DisplayObjectContainer.prototype),w.prototype.constructor=w,w.prototype.update=function(a,b){k.call(this,a,b),this.position.set(0,this._focusY);if(this.shaking){var c=this.shaking*(Math.random()-.5),d=this.shaking*(Math.random()-.5);this.position.x+=c,this.position.y+=d,this.shaking=Math.max(0,this.shaking+this.shakingVel*b)}},w.prototype.playerDied=function(a,b){var c=new g(a.position,Math.max(100,a.width),u,256,250,.5*Math.PI);this.explosionsPlayer.addChild(c),b&&(e(400),setTimeout(v,800))},w.prototype.snowballExplode=function(a){i.play("snowballHit",a,.6),this.explosions.addChild(new g(a.position,a.width*2,s,64,150,2*Math.PI))},w.prototype.carHitPlayerExplode=function(a,b){var c=l(a.box,b.box),d=(c[0]+c[2])/2,g=(c[1]+c[3])/2;this.shaking=10+(b.life<=0?10:0),this.shakingVel=-0.03;if(b.life<=0)return;e(200);var i=this.snowballs;if(i){var j=.2+b.life/2e3,k=~~(5/j);h({pos:[d,g],n:k,spawn:function(a){var b=new f(j,Math.random);b.position.set.apply(b.position,a.pos),b.vel=a.vel,i.addChild(b)},vel:.1,front:4+b.width/2,angleOffset:Math.random()})}},w.prototype.fireballExplode=function(a){i.play("burn",a,.3),this.explosions.addChild(new g(a.position,a.width*2,q,64,150,2*Math.PI))},w.prototype.getWindow=function(){return[this._focusY-j.HEIGHT,this._focusY]},w.prototype.focusOn=function(a){var b=j.HEIGHT-Math.max(a.y,a.maxProgress+a.maxMoveBack+a.height/2);b=Math.floor(Math.max(0,b)),this._focusY=this._focusY+(b-this._focusY)*.07},w.prototype.focusOnY=function(a){this._focusY=a},b.exports=w},{11:11,117:117,152:152,16:16,18:18,40:40,42:42,46:46,58:58,62:62}],49:[function(a,b,c){function e(){d.BitmapText.apply(this,arguments),this._text=this.text}var d=a(117);e.prototype=Object.create(d.BitmapText.prototype),e.prototype.constructor=e,Object.defineProperty(e.prototype,"text",{set:function(a){this._text!==a&&this.setText(this._text=""+a)},get:function(){return this._text}}),b.exports=e},{117:117}],50:[function(a,b,c){function f(){d.DisplayObjectContainer.call(this)}var d=a(117),e=a(16);f.prototype=Object.create(d.DisplayObjectContainer.prototype),f.prototype.constructor=f,f.prototype.update=e,b.exports=f},{117:117,16:16}],51:[function(a,b,c){function j(a){window.localStorage.player=a}function k(){return window.localStorage.player}function l(){var a=document.createElement("div");a.style.overflow="hidden",a.style.position="absolute",a.style.zIndex=0,a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height=e.HEIGHT+"px",this.gridwrap=a;var b=document.createElement("div");b.style.position="absolute",b.style.top="0",b.style.left="0",b.style.width="100%",b.style.height="2000px",b.style[g]="translate3D(0,-9999px,0)",b.style.background="url(./img/grid.png) repeat",this.grid=b;var c=document.createElement("div");c.style.position="absolute",c.style.color="#fff",c.style.width=e.WIDTH+"px",c.style.height="40px",c.style.lineHeight="40px",c.style.font="normal 20px sans-serif",this.bar=c,this.syncBar(),a.appendChild(b),document.body.appendChild(a),document.body.appendChild(c),this.name=h.defer();var d=k();d?this.name.resolve(d):this._setName()}var d=a(117),e=a(18),f=a(151),g=f("transform"),h=a(118),i=a(55);l.prototype={syncBar:function(){var a=this.bar;a.innerHTML="";var b=k(),c=document.createElement("span"),d=document.createElement("a");if(b){var e=document.createElement("span");e.textContent="Welcome ",c.appendChild(e),d.textContent=b,d.style.color="#fff",d.href="#",d.addEventListener("click",this._reaskName.bind(this),!1)}else d.textContent="Hi! can I get your name?",d.style.color="#fff",d.href="#",d.addEventListener("click",this._setName.bind(this),!1);c.appendChild(d),a.appendChild(c)},_setName:function(a,b){a&&a.preventDefault();var c=this;i(b?"please give a name between 3 to 10 alphanum characters":"What's your name? (3 to 10 alphanum characters)").then(function(b){if(!/^[a-zA-Z0-9]{3,10}$/.exec(b))return c._setName(a,!0);j(b),c.syncBar(),c.name.resolve(b)})},_reaskName:function(a){a.preventDefault();var b=this;i("Change your name:",k()).then(function(c){if(!/^[a-zA-Z0-9]{3,10}$/.exec(c))return b._reaskName(a);j(c),window.location.reload()})},getPlayerName:function(){return this.name.promise},setViewportPos:function(a,b){this.gridwrap.style[g]="translate3D(0,"+b+"px,0)",this.canvas.style[g]="translate3D("+a+"px,"+b+"px,0)",this.bar.style[g]="translate3D("+a+"px,"+(b-40)+"px,0)"},setGridY:function(a){a=Math.round(a)%1e3-1e3-(a<1e3?1e3:0),this._lastGridY!==a&&(this._lastGridY=a,this.grid.style[g]="translate3D(0,"+a+"px,0)")},setGame:function(a){this.game||(this.canvas.style.boxShadow="0px 0px 10px #fff"),this.game=a},createRenderer:function(){var a=d.autoDetectRenderer(e.WIDTH,e.HEIGHT,{resolution:window.devicePixelRatio}),b=a.view;return b.style.width=e.WIDTH+"px",b.style.height=e.HEIGHT+"px",b.style.zIndex=10,b.style[g]="translate3D(0,0,0)",this.canvas=b,document.body.appendChild(b),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize(),a},onResize:function(){var a=Math.max(0,Math.round((window.innerWidth-e.WIDTH)/2)),b=Math.max(0,Math.min(Math.round((window.innerHeight-e.HEIGHT)/2),120));if(a!==this._lastresizex||b!==this._lastresizey)this._lastresizex=a,this._lastresizey=b,this.setViewportPos(a,b)},update:function(){this.game&&this.setGridY(this.game.world.y)}},b.exports=l},{117:117,118:118,151:151,18:18,55:55}],52:[function(a,b,c){var d=a(53);b.exports=d?a(54):a(51)},{51:51,53:53,54:54}],53:[function(a,b,c){b.exports=window.navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i)},{}],54:[function(a,b,c){function j(a){window.localStorage.player=a}function k(){return window.localStorage.player}function l(){this.lockPromise=e.fcall(function(){return window.screen.orientation.lock("portrait")})}var d=a(117),e=a(118),f=a(18),g=a(151),h=g("transform"),i=a(55);l.prototype={getPlayerName:function(){return e(k()||this.askName())},askName:function(a){var b=this;return i(a?"please give a name between 3 to 10 alphanum characters":"What's your name? (3 to 10 alphanum characters)").then(function(a){return/^[a-zA-Z0-9]{3,10}$/.exec(a)?(j(a),a):b.askName(!0)})},createRenderer:function(){var a=d.autoDetectRenderer(f.WIDTH,f.HEIGHT,{resolution:window.devicePixelRatio}),b=a.view;return b.style.width=f.WIDTH+"px",b.style.height=f.HEIGHT+"px",b.style[h]="translate3D(0,0,0)",this.canvas=b,document.body.appendChild(b),document.body.style.background="#000",a},setGame:function(){},update:function(){}},b.exports=l},{117:117,118:118,151:151,18:18,55:55}],55:[function(a,b,c){function e(a,b){return d.fcall(function(){var c=window.prompt(a,b||"");if(c===null)throw new Error("cancelled");return c})}var d=a(118);b.exports=e},{118:118}],56:[function(a,b,c){function p(a,b,c){d.Stage.call(this,16777215),d.EventTarget.mixin(this);var e=new o,f=new o,g=f,h=f,m=new o,p=new o,q=new o,r=new o,s=new l(a,e,g,h,q,r),t=new o,u=new d.DisplayObjectContainer,v=new n(c,u);v.controls=b;var w=new o,x=new d.DisplayObjectContainer,y=new j(this);this.ui=y;var z=new k(g,h,m,p);z.addChild(s),z.addChild(u),z.addChild(t),z.addChild(w),z.addChild(x),z.addChild(v),z.addChild(e),z.addChild(g),z.addChild(h),z.addChild(q),z.addChild(r),z.addChild(m),z.addChild(p),this.addChild(z),this.addChild(y),this.world=z,this.map=s,this.cars=e,this.particles=f,this.spawners=q,this.deadCarrots=t,this.footprints=u,this.player=v,this.players=w,this.names=x,this.controls=b,this.audio1=i.loop("./audio/1.ogg"),i.play("start")}var d=a(117),e=a(135),f=a(112),g=a(73),h=a(59),i=a(11),j=a(9),k=a(48),l=a(37),m=a(30),n=a(41),o=a(50);p.prototype=Object.create(d.Stage.prototype),p.prototype.constructor=p,p.prototype.update=function(a,b){function C(a,b){a.isDead()||a.life<=0&&(a.die(),d.playerDied(a,b),b&&(d.removeChild(a),this.emit("GameOver",a.getScore())))}var c,d=this.world,f=this.player,j=this.controls,k=this.map,l=this.particles.children,m=this.cars.children,n=this.footprints.children,o=j.x()||j.y(),p=[],q=[],r=[],s=new Array(l.length);for(c=0;c<l.length;++c)s[c]=l[c].box;var t=new Array(m.length);for(c=0;c<m.length;++c)t[c]=m[c].box;g(s,t,function(a){p.push(l[a])});if(!f.isDead()){var u=[f.box];g(t,u,function(a){q.push(m[a])}),g(s,u,function(a){r.push(l[a])})}var v=0;for(c=0;c<p.length;++c)p[c].explodeInWorld(d);for(c=0;c<q.length;++c){var w=q[c];f.onCarHit(w),d.carHitPlayerExplode(w,f)}for(c=0;c<r.length;++c){var x=r[c];x.explodeInWorld(d),x.hitPlayer(f),v++}d.focusOn(f);var y=d.getWindow();for(c=0;c<n.length;++c)n[c].watchWindow(y);k.watchWindow(y),v=Math.max(0,v-b*.001);var z=0;for(c=0;c<m.length;++c){var A=m[c],B=h(A,f);z+=Math.pow(e(300,50,B),2),!A.neverSaw&&B<300&&(A.neverSaw=1,i.play("car",A))}f.dead?this.audio1.setVolume(0):this.audio1.setVolume(o?.2+Math.min(.8,v+z/4):0),i.micOn(f),i.update(a,b);if(this.players.children.length){var D=this.players.children[0].children;for(c=0;c<D.length;++c)C.call(this,D[c],!1)}C.call(this,f,!0),d.update(a,b),this.ui.update(a,b)},p.prototype.destroy=function(){try{this.audio1.stop()}catch(a){console.error(a)}for(var b in this)this[b]=null},p.prototype.setMapName=function(a){this.map.setName(a)},p.prototype.positionObfuscation=function(a){var b=this.player.width;return.9*e(40+b,b/2,h(this.player.position,a))},p.prototype.createDeadCarrot=function(a,b){if(a.opacity>0){var c=new m(a,b,a.player===this.player.name);this.deadCarrots.addChild(c)}},p.prototype.getCurrentRank=function(a){if(!this.scores)return 0;var b=0;for(var c=this.scores.length;b<c&&a<this.scores[b].score;++b);return b+1},p.prototype.getPlayerBestScore=function(a){return this.scores?this.bestScorePerPlayer[a]||null:null},p.prototype.setScores=function(a,b){var c,d=this.scores||[],e=f.filter(a,function(a){return!f.any(d,function(b){return a.player===b.player&&a.x===b.x&&a.score===b.score})});a=[].concat(a),a.sort(function(a,b){return b.score-a.score}),this.map.setScores(a);for(c=0;c<e.length;++c)this.createDeadCarrot(e[c],b);var g={};for(c=0;c<a.length;++c){var h=a[c];h.player in g||(g[h.player]={rank:c+1,score:h.score})}this.scores=a,this.bestScorePerPlayer=g},b.exports=p},{11:11,112:112,117:117,135:135,30:30,37:37,41:41,48:48,50:50,59:59,73:73,9:9}],57:[function(a,b,c){function i(){d.Stage.call(this,6588614),this.layer=new d.DisplayObjectContainer,this.logo=new d.Sprite(g),this.logo.scale.set(.5,.5),this.logo.position.set((f.WIDTH-200)/2,100),this.loadbar=new d.Sprite(h),this.loadbar.scale.set(.5,.5),this.loadbar.position.set((f.WIDTH-200)/2,300),this.layer.addChild(this.logo),this.layer.addChild(this.loadbar),this.addChild(this.layer),this.setProgress(0)}var d=a(117),e=a(135),f=a(18),g=d.Texture.fromImage("./img/logo.png"),h=d.Texture.fromImage("./img/loadbar.png");i.prototype=Object.create(d.Stage.prototype),i.prototype.constructor=i,i.prototype.setProgress=function(a){this.progress=a},i.prototype.update=function(a){this.layer.alpha=e(0,1e3,a-250);var b=new d.Graphics;b.beginFill(),b.drawRect(0,0,this.progress*f.WIDTH,f.HEIGHT),this.loadbar.mask=b},b.exports=i},{117:117,135:135,18:18}],58:[function(a,b,c){b.exports=function(a,b){return[Math.max(a[0],b[0]),Math.max(a[1],b[1]),Math.min(a[2],b[2]),Math.min(a[3],b[3])]}},{}],59:[function(a,b,c){b.exports=function(b,c){var d=b.x-c.x,e=b.y-c.y;return Math.sqrt(d*d+e*e)}},{}],60:[function(a,b,c){function d(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}window.h=b.exports=function(b,c,e){var f,g,h;b/=360,c/=100,e/=100;if(b>1||b<0||c>1||c<0||e>1||e<0)return null;if(c===0)f=g=h=e;else{var i=e<.5?e*(1+c):e+c-e*c,j=2*e-i;f=d(j,i,b+1/3),h=d(j,i,b),g=d(j,i,b-1/3)}return~~(f*255)<<16|~~(h*255)<<8|~~(g*255)}},{}],61:[function(a,b,c){b.exports=function(b,c,d){return d*c+(1-d)*b}},{}],62:[function(a,b,c){function e(a){return function(b,c,e){return new d.Texture(b,{x:c*a,y:e*a,width:a,height:a})}}var d=a(117);e.tile24=e(24),e.tile64=e(64),e.tile256=e(256),b.exports=e},{117:117}],63:[function(a,b,c){var d=a(65),e=b.exports={encodeFromPlayer:function(a,b){return e.encode(e.getFromPlayer(a,b))},decodeToPlayer:function(a,b){return e.applyToPlayer(e.decode(b))},getFromPlayer:function(a,b){return{time:Math.floor(b),input:[a.controls.x(),a.controls.y()],pos:[Math.floor(a.x),Math.floor(a.y)],life:Math.floor(a.life)}},applyToPlayer:function(a,b){return a.controls.setState({x:b.input[0],y:b.input[1]}),a.position.set(b.pos[0],b.pos[1]),a.life=b.life,b.time},encode:function(a){return[a.time].concat(a.input).concat(a.pos).concat([a.life])},decode:function(a){return{time:a[0],input:a.slice(1,3),pos:a.slice(3,5),life:a[5]}},validatePos:function(a,b){return!(a<0||a>d.WIDTH)&&b<=d.HEIGHT},validateEncoded:function(a){return a.length===6&&a.every(function(a){return typeof a=="number"&&!isNaN(a)&&isFinite(a)})&&a[5]<1e3&&this.validatePos.apply(this,a.slice(3,5))&&(a[1]===-1||a[1]===0||a[1]===1)&&(a[2]===-1||a[2]===0||a[2]===1)}}},{65:65}],64:[function(a,b,c){var d=864e5;b.exports=function(a){return d*(a/d|0)}},{}],65:[function(a,b,c){b.exports={WIDTH:320,HEIGHT:480,networkPlaybackDelay:100,networkSendRate:50,playerMoveSpeed:.25,version:"2a",events:{playerenter:1,playerleave:2,playermove:3,playerdie:4,players:5,scores:6,newscore:7,playerready:8,ready:9,newgame:10,gameinfo:11}}},{}],66:[function(a,b,c){function d(a,b,c){function f(a,e){if(f.count<=0)throw new Error("after called too many times");--f.count,a?(d=!0,b(a),b=c):f.count===0&&!d&&b(null,e)}var d=!1;return c=c||e,f.count=a,a===0?b():f}function e(){}b.exports=d},{}],67:[function(a,b,c){b.exports=function(a,b,c){var d=a.byteLength;b=b||0,c=c||d;if(a.slice)return a.slice(b,c);b<0&&(b+=d),c<0&&(c+=d),c>d&&(c=d);if(b>=d||b>=c||d===0)return new ArrayBuffer(0);var e=new Uint8Array(a),f=new Uint8Array(c-b);for(var g=b,h=0;g<c;g++,h++)f[h]=e[g];return f.buffer}},{}],68:[function(a,b,c){function d(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}b.exports=d,d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=(Math.floor(b*10)&1)==0?a-c:a+c}return Math.min(a,this.max)|0},d.prototype.reset=function(){this.attempts=0},d.prototype.setMin=function(a){this.ms=a},d.prototype.setMax=function(a){this.max=a},d.prototype.setJitter=function(a){this.jitter=a}},{}],69:[function(a,b,c){(function(){"use strict";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=new Uint8Array(256);for(var d=0;d<a.length;d++)b[a.charCodeAt(d)]=d;c.encode=function(b){var c=new Uint8Array(b),d,e=c.length,f="";for(d=0;d<e;d+=3)f+=a[c[d]>>2],f+=a[(c[d]&3)<<4|c[d+1]>>4],f+=a[(c[d+1]&15)<<2|c[d+2]>>6],f+=a[c[d+2]&63];return e%3===2?f=f.substring(0,f.length-1)+"=":e%3===1&&(f=f.substring(0,f.length-2)+"=="),f},c.decode=function(a){var c=a.length*.75,d=a.length,e,f=0,g,h,i,j;a[a.length-1]==="="&&(c--,a[a.length-2]==="="&&c--);var k=new ArrayBuffer(c),l=new Uint8Array(k);for(e=0;e<d;e+=4)g=b[a.charCodeAt(e)],h=b[a.charCodeAt(e+1)],i=b[a.charCodeAt(e+2)],j=b[a.charCodeAt(e+3)],l[f++]=g<<2|h>>4,l[f++]=(h&15)<<4|i>>2,l[f++]=(i&3)<<6|j&63;return k}})()},{}],70:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(a){function k(a){var b=a.charCodeAt(0);if(b===c||b===i)return 62;if(b===e||b===j)return 63;if(b<f)return-1;if(b<f+10)return b-f+26+26;if(b<h+26)return b-h;if(b<g+26)return b-g+26}function l(a){function l(a){h[j++]=a}var c,d,e,f,g,h;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=a.length;g="="===a.charAt(i-2)?2:"="===a.charAt(i-1)?1:0,h=new b(a.length*3/4-g),e=g>0?a.length-4:a.length;var j=0;for(c=0,d=0;c<e;c+=4,d+=3)f=k(a.charAt(c))<<18|k(a.charAt(c+1))<<12|k(a.charAt(c+2))<<6|k(a.charAt(c+3)),l((f&16711680)>>16),l((f&65280)>>8),l(f&255);return g===2?(f=k(a.charAt(c))<<2|k(a.charAt(c+1))>>4,l(f&255)):g===1&&(f=k(a.charAt(c))<<10|k(a.charAt(c+1))<<4|k(a.charAt(c+2))>>2,l(f>>8&255),l(f&255)),h}function m(a){function h(a){return d.charAt(a)}function i(a){return h(a>>18&63)+h(a>>12&63)+h(a>>6&63)+h(a&63)}var b,c=a.length%3,e="",f,g;for(b=0,g=a.length-c;b<g;b+=3)f=(a[b]<<16)+(a[b+1]<<8)+a[b+2],e+=i(f);switch(c){case 1:f=a[a.length-1],e+=h(f>>2),e+=h(f<<4&63),e+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],e+=h(f>>10),e+=h(f>>4&63),e+=h(f<<2&63),e+="="}return e}"use strict";var b=typeof Uint8Array!="undefined"?Uint8Array:Array,c="+".charCodeAt(0),e="/".charCodeAt(0),f="0".charCodeAt(0),g="a".charCodeAt(0),h="A".charCodeAt(0),i="-".charCodeAt(0),j="_".charCodeAt(0);a.toByteArray=l,a.fromByteArray=m})(typeof c=="undefined"?this.base64js={}:c)},{}],71:[function(a,b,c){function e(a){var b=32;return a&=-a,a&&b--,a&65535&&(b-=16),a&16711935&&(b-=8),a&252645135&&(b-=4),a&858993459&&(b-=2),a&1431655765&&(b-=1),b}"use strict","use restrict";var d=32;c.INT_BITS=d,c.INT_MAX=2147483647,c.INT_MIN=-1<<d-1,c.sign=function(a){return(a>0)-(a<0)},c.abs=function(a){var b=a>>d-1;return(a^b)-b},c.min=function(a,b){return b^(a^b)&-(a<b)},c.max=function(a,b){return a^(a^b)&-(a<b)},c.isPow2=function(a){return!(a&a-1)&&!!a},c.log2=function(a){var b,c;return b=(a>65535)<<4,a>>>=b,c=(a>255)<<3,a>>>=c,b|=c,c=(a>15)<<2,a>>>=c,b|=c,c=(a>3)<<1,a>>>=c,b|=c,b|a>>1},c.log10=function(a){return a>=1e9?9:a>=1e8?8:a>=1e7?7:a>=1e6?6:a>=1e5?5:a>=1e4?4:a>=1e3?3:a>=100?2:a>=10?1:0},c.popCount=function(a){return a-=a>>>1&1431655765,a=(a&858993459)+(a>>>2&858993459),(a+(a>>>4)&252645135)*16843009>>>24},c.countTrailingZeros=e,c.nextPow2=function(a){return a+=a===0,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a+1},c.prevPow2=function(a){return a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a-(a>>>1)},c.parity=function(a){return a^=a>>>16,a^=a>>>8,a^=a>>>4,a&=15,27030>>>a&1};var f=new Array(256);(function(a){for(var b=0;b<256;++b){var c=b,d=b,e=7;for(c>>>=1;c;c>>>=1)d<<=1,d|=c&1,--e;a[b]=d<<e&255}})(f),c.reverse=function(a){return f[a&255]<<24|f[a>>>8&255]<<16|f[a>>>16&255]<<8|f[a>>>24&255]},c.interleave2=function(a,b){return a&=65535,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,b&=65535,b=(b|b<<8)&16711935,b=(b|b<<4)&252645135,b=(b|b<<2)&858993459,b=(b|b<<1)&1431655765,a|b<<1},c.deinterleave2=function(a,b){return a=a>>>b&1431655765,a=(a|a>>>1)&858993459,a=(a|a>>>2)&252645135,a=(a|a>>>4)&16711935,a=(a|a>>>16)&65535,a<<16>>16},c.interleave3=function(a,b,c){return a&=1023,a=(a|a<<16)&4278190335,a=(a|a<<8)&251719695,a=(a|a<<4)&3272356035,a=(a|a<<2)&1227133513,b&=1023,b=(b|b<<16)&4278190335,b=(b|b<<8)&251719695,b=(b|b<<4)&3272356035,b=(b|b<<2)&1227133513,a|=b<<1,c&=1023,c=(c|c<<16)&4278190335,c=(c|c<<8)&251719695,c=(c|c<<4)&3272356035,c=(c|c<<2)&1227133513,a|c<<2},c.deinterleave3=function(a,b){return a=a>>>b&1227133513,a=(a|a>>>2)&3272356035,a=(a|a>>>4)&251719695,a=(a|a>>>8)&4278190335,a=(a|a>>>16)&1023,a<<22>>22},c.nextCombination=function(a){var b=a|a-1;return b+1|(~b&-~b)-1>>>e(a)+1}},{}],72:[function(a,b,c){((function(a){function g(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var d=c.buffer;if(c.byteLength!==d.byteLength){var e=new Uint8Array(c.byteLength);e.set(new Uint8Array(d,c.byteOffset,c.byteLength)),d=e.buffer}a[b]=d}}}function h(a,b){b=b||{};var d=new c;g(a);for(var e=0;e<a.length;e++)d.append(a[e]);return b.type?d.getBlob(b.type):d.getBlob()}function i(a,b){return g(a),new Blob(a,b||{})}var c=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder,d=function(){try{var a=new Blob(["hi"]);return a.size===2}catch(b){return!1}}(),e=d&&function(){try{var a=new Blob([new Uint8Array([1,2])]);return a.size===2}catch(b){return!1}}(),f=c&&c.prototype.append&&c.prototype.getBlob;b.exports=function(){return d?e?a.Blob:i:f?h:undefined}()})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],73:[function(a,b,c){function g(a,b){for(var c=0;c<a;++c)if(!(b[c]<=b[c+a]))return!0;return!1}function h(a,b,c,d){var e=0,f=0;for(var h=0,i=a.length;h<i;++h){var j=a[h];if(g(b,j))continue;for(var k=0;k<2*b;++k)c[e++]=j[k];d[f++]=h}return f}function i(a,b,c,g){var i=a.length,j=b.length;if(i<=0||j<=0)return;var k=a[0].length>>>1;if(k<=0)return;var l,m=d.mallocDouble(2*k*i),n=d.mallocInt32(i);i=h(a,k,m,n);if(i>0){if(k===1&&g)e.init(i),l=e.sweepComplete(k,c,0,i,m,n,0,i,m,n);else{var o=d.mallocDouble(2*k*j),p=d.mallocInt32(j);j=h(b,k,o,p),j>0&&(e.init(i+j),k===1?l=e.sweepBipartite(k,c,0,i,m,n,0,j,o,p):l=f(k,c,g,i,m,n,j,o,p),d.free(o),d.free(p))}d.free(m),d.free(n)}return l}function k(a,b){j.push([a,b])}function l(a){return j=[],i(a,a,k,!0),j}function m(a,b){return j=[],i(a,b,k,!1),j}function n(a,b,c){var d;switch(arguments.length){case 1:return l(a);case 2:return typeof b=="function"?i(a,a,b,!0):m(a,b);case 3:return i(a,b,c,!1);default:throw new Error("box-intersect: Invalid arguments")}}"use strict",b.exports=n;var d=a(150),e=a(79),f=a(75),j},{150:150,75:75,79:79}],74:[function(a,b,c){function v(a,b,c){var g="bruteForce"+(a?"Red":"Blue")+(b?"Flip":"")+(c?"Full":""),v=["function ",g,"(",u.join(),"){","var ",h,"=2*",d,";"],w="for(var i="+i+","+m+"="+h+"*"+i+";"+"i<"+j+";"+"++i,"+m+"+="+h+"){"+"var x0="+k+"["+e+"+"+m+"],"+"x1="+k+"["+e+"+"+m+"+"+d+"],"+"xi="+l+"[i];",x="for(var j="+n+","+r+"="+h+"*"+n+";"+"j<"+o+";"+"++j,"+r+"+="+h+"){"+"var y0="+p+"["+e+"+"+r+"],"+(c?"y1="+p+"["+e+"+"+r+"+"+d+"],":"")+"yi="+q+"[j];";return a?v.push(w,t,":",x):v.push(x,t,":",w),c?v.push("if(y1<x0||x1<y0)continue;"):b?v.push("if(y0<=x0||x1<y0)continue;"):v.push("if(y0<x0||x1<y0)continue;"),v.push("for(var k="+e+"+1;k<"+d+";++k){"+"var r0="+k+"[k+"+m+"],"+"r1="+k+"[k+"+d+"+"+m+"],"+"b0="+p+"[k+"+r+"],"+"b1="+p+"[k+"+d+"+"+r+"];"+"if(r1<b0||b1<r0)continue "+t+";}"+"var "+s+"="+f+"("),b?v.push("yi,xi"):v.push("xi,yi"),v.push(");if("+s+"!==void 0)return "+s+";}}}"),{name:g,code:v.join("")}}function w(a){function f(b,d){var f=v(b,d,a);c.push(f.code),e.push("return "+f.name+"("+u.join()+");")}var b="bruteForce"+(a?"Full":"Partial"),c=[],d=u.slice();a||d.splice(3,0,g);var e=["function "+b+"("+d.join()+"){"];e.push("if("+j+"-"+i+">"+o+"-"+n+"){"),a?(f(!0,!1),e.push("}else{"),f(!1,!1)):(e.push("if("+g+"){"),f(!0,!0),e.push("}else{"),f(!0,!1),e.push("}}else{if("+g+"){"),f(!1,!0),e.push("}else{"),f(!1,!1),e.push("}")),e.push("}}return "+b);var h=c.join("")+e.join(""),k=new Function(h);return k()}"use strict";var d="d",e="ax",f="vv",g="fp",h="es",i="rs",j="re",k="rb",l="ri",m="rp",n="bs",o="be",p="bb",q="bi",r="bp",s="rv",t="Q",u=[d,e,f,i,j,k,l,n,o,p,q];c.partial=w(!1),c.full=w(!0)},{}],75:[function(a,b,c){function z(a,b){var c=8*e.log2(b+1)*(a+1)|0,f=e.nextPow2(u*c);x.length<f&&(d.free(x),x=d.mallocInt32(f));var g=e.nextPow2(v*c);y<g&&(d.free(y),y=d.mallocDouble(g))}function A(a,b,c,d,e,f,g,h,i){var j=u*a;x[j]=b,x[j+1]=c,x[j+2]=d,x[j+3]=e,x[j+4]=f,x[j+5]=g;var k=v*a;y[k]=h,y[k+1]=i}function B(a,b,c,d,e,f,g,h,i,j,k){var l=2*a,m=i*l,n=j[m+b];a:for(var o=e,p=e*l;o<f;++o,p+=l){var q=g[p+b],r=g[p+b+a];if(n<q||r<n)continue;if(d&&n===q)continue;var s=h[o];for(var t=b+1;t<a;++t){var q=g[p+t],r=g[p+t+a],u=j[m+t],v=j[m+t+a];if(r<u||v<q)continue a}var w;d?w=c(k,s):w=c(s,k);if(w!==void 0)return w}}function C(a,b,c,d,e,f,g,h,i,j){var k=2*a,l=h*k,m=i[l+b];a:for(var n=d,o=d*k;n<e;++n,o+=k){var p=g[n];if(p===j)continue;var q=f[o+b],r=f[o+b+a];if(m<q||r<m)continue;for(var s=b+1;s<a;++s){var q=f[o+s],r=f[o+s+a],t=i[l+s],u=i[l+s+a];if(r<t||u<q)continue a}var v=c(p,j);if(v!==void 0)return v}}function D(a,b,c,d,e,f,k,w,D){z(a,d+k);var E=0,F=2*a,G;A(E++,0,0,d,0,k,c?16:0,-Infinity,Infinity),c||A(E++,0,0,k,0,d,1,-Infinity,Infinity);while(E>0){E-=1;var H=E*u,I=x[H],J=x[H+1],K=x[H+2],L=x[H+3],M=x[H+4],N=x[H+5],O=E*v,P=y[O],Q=y[O+1],R=N&1,S=!!(N&16),T=e,U=f,V=w,W=D;R&&(T=w,U=D,V=e,W=f);if(N&2){K=q(a,I,J,K,T,U,Q);if(J>=K)continue}if(N&4){J=r(a,I,J,K,T,U,P);if(J>=K)continue}var X=K-J,Y=M-L;if(S){if(a*X*(X+Y)<n){G=i.scanComplete(a,I,b,J,K,T,U,L,M,V,W);if(G!==void 0)return G;continue}}else{if(a*Math.min(X,Y)<l){G=g(a,I,b,R,J,K,T,U,L,M,V,W);if(G!==void 0)return G;continue}if(a*X*Y<m){G=i.scanBipartite(a,I,b,R,J,K,T,U,L,M,V,W);if(G!==void 0)return G;continue}}var Z=o(a,I,J,K,T,U,P,Q);if(J<Z)if(a*(Z-J)<l){G=h(a,I+1,b,J,Z,T,U,L,M,V,W);if(G!==void 0)return G}else if(I===a-2){R?G=i.sweepBipartite(a,b,L,M,V,W,J,Z,T,U):G=i.sweepBipartite(a,b,J,Z,T,U,L,M,V,W);if(G!==void 0)return G}else A(E++,I+1,J,Z,L,M,R,-Infinity,Infinity),A(E++,I+1,L,M,J,Z,R^1,-Infinity,Infinity);if(Z<K){var $=j(a,I,L,M,V,W),_=V[F*$+I],ba=p(a,I,$,M,V,W,_);ba<M&&A(E++,I,Z,K,ba,M,(R|4)+(S?16:0),_,Q),L<$&&A(E++,I,Z,K,L,$,(R|2)+(S?16:0),P,_);if($+1===ba){S?G=C(a,I,b,Z,K,T,U,$,V,W[$]):G=B(a,I,b,R,Z,K,T,U,$,V,W[$]);if(G!==void 0)return G}else if($<ba){var bb;if(S){bb=s(a,I,Z,K,T,U,_);if(Z<bb){var bc=p(a,I,Z,bb,T,U,_);if(I===a-2){if(Z<bc){G=i.sweepComplete(a,b,Z,bc,T,U,$,ba,V,W);if(G!==void 0)return G}if(bc<bb){G=i.sweepBipartite(a,b,bc,bb,T,U,$,ba,V,W);if(G!==void 0)return G}}else Z<bc&&A(E++,I+1,Z,bc,$,ba,16,-Infinity,Infinity),bc<bb&&(A(E++,I+1,bc,bb,$,ba,0,-Infinity,Infinity),A(E++,I+1,$,ba,bc,bb,1,-Infinity,Infinity))}}else R?bb=t(a,I,Z,K,T,U,_):bb=s(a,I,Z,K,T,U,_),Z<bb&&(I===a-2?R?G=i.sweepBipartite(a,b,$,ba,V,W,Z,bb,T,U):G=i.sweepBipartite(a,b,Z,bb,T,U,$,ba,V,W):(A(E++,I+1,Z,bb,$,ba,R,-Infinity,Infinity),A(E++,I+1,$,ba,Z,bb,R^1,-Infinity,Infinity)))}}}}"use strict",b.exports=D;var d=a(150),e=a(71),f=a(74),g=f.partial,h=f.full,i=a(79),j=a(76),k=a(77),l=128,m=1<<22,n=1<<22,o=k("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),p=k("lo===p0",["p0"]),q=k("lo<p0",["p0"]),r=k("hi<=p0",["p0"]),s=k("lo<=p0&&p0<=hi",["p0"]),t=k("lo<p0&&p0<=hi",["p0"]),u=6,v=2,w=1024,x=d.mallocInt32(w),y=d.mallocDouble(w)},{150:150,71:71,74:74,76:76,77:77,79:79}],76:[function(a,b,c){function g(a,b,c,d,e,f){var g=2*a,h=g*(c+1)+b;for(var i=c+1;i<d;++i,h+=g){var j=e[h];for(var k=i,l=g*(i-1);k>c&&e[l+b]>j;--k,l-=g){var m=l,n=l+g;for(var o=0;o<g;++o,++m,++n){var p=e[m];e[m]=e[n],e[n]=p}var q=f[k];f[k]=f[k-1],f[k-1]=q}}}function h(a,b,c,d,h,i){if(d<=c+1)return c;var j=c,k=d,l=d+c>>>1,m=2*a,n=l,o=h[m*l+b];while(j<k){if(k-j<f){g(a,b,j,k,h,i),o=h[m*l+b];break}var p=k-j,q=Math.random()*p+j|0,r=h[m*q+b],s=Math.random()*p+j|0,t=h[m*s+b],u=Math.random()*p+j|0,v=h[m*u+b];r<=t?v>=t?(n=s,o=t):r>=v?(n=q,o=r):(n=u,o=v):t>=v?(n=s,o=t):v>=r?(n=q,o=r):(n=u,o=v);var w=m*(k-1),x=m*n;for(var y=0;y<m;++y,++w,++x){var z=h[w];h[w]=h[x],h[x]=z}var A=i[k-1];i[k-1]=i[n],i[n]=A,n=e(a,b,j,k-1,h,i,o);var w=m*(k-1),x=m*n;for(var y=0;y<m;++y,++w,++x){var z=h[w];h[w]=h[x],h[x]=z}var A=i[k-1];i[k-1]=i[n],i[n]=A;if(l<n){k=n-1;while(j<k&&h[m*(k-1)+b]===o)k-=1;k+=1}else{if(!(n<l))break;j=n+1;while(j<k&&h[m*j+b]===o)j+=1}}return e(a,b,c,l,h,i,h[m*l+b])}"use strict",b.exports=h;var d=a(77),e=d("lo<p0",["p0"]),f=8},{77:77}],77:[function(a,b
,c){function e(a,b){var c="abcdef".split("").concat(b),e=[];return a.indexOf("lo")>=0&&e.push("lo=e[k+n]"),a.indexOf("hi")>=0&&e.push("hi=e[k+o]"),c.push(d.replace("_",e.join()).replace("$",a)),Function.apply(void 0,c)}"use strict",b.exports=e;var d="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m"},{}],78:[function(a,b,c){function e(a,b){b<=4*d?f(0,b-1,a):m(0,b-1,a)}function f(a,b,c){var d=2*(a+1);for(var e=a+1;e<=b;++e){var f=c[d++],g=c[d++],h=e,i=d-2;while(h-->a){var j=c[i-2],k=c[i-1];if(j<f)break;if(j===f&&k<g)break;c[i]=j,c[i+1]=k,i-=2}c[i]=f,c[i+1]=g}}function g(a,b,c){a*=2,b*=2;var d=c[a],e=c[a+1];c[a]=c[b],c[a+1]=c[b+1],c[b]=d,c[b+1]=e}function h(a,b,c){a*=2,b*=2,c[a]=c[b],c[a+1]=c[b+1]}function i(a,b,c,d){a*=2,b*=2,c*=2;var e=d[a],f=d[a+1];d[a]=d[b],d[a+1]=d[b+1],d[b]=d[c],d[b+1]=d[c+1],d[c]=e,d[c+1]=f}function j(a,b,c,d,e){a*=2,b*=2,e[a]=e[b],e[b]=c,e[a+1]=e[b+1],e[b+1]=d}function k(a,b,c){a*=2,b*=2;var d=c[a],e=c[b];return d<e?!1:d===e?c[a+1]>c[b+1]:!0}function l(a,b,c,d){a*=2;var e=d[a];return e<b?!0:e===b?d[a+1]<c:!1}function m(a,b,c){var e=(b-a+1)/6|0,n=a+e,o=b-e,p=a+b>>1,q=p-e,r=p+e,s=n,t=q,u=p,v=r,w=o,x=a+1,y=b-1,z=0;k(s,t,c)&&(z=s,s=t,t=z),k(v,w,c)&&(z=v,v=w,w=z),k(s,u,c)&&(z=s,s=u,u=z),k(t,u,c)&&(z=t,t=u,u=z),k(s,v,c)&&(z=s,s=v,v=z),k(u,v,c)&&(z=u,u=v,v=z),k(t,w,c)&&(z=t,t=w,w=z),k(t,u,c)&&(z=t,t=u,u=z),k(v,w,c)&&(z=v,v=w,w=z);var A=c[2*t],B=c[2*t+1],C=c[2*v],D=c[2*v+1],E=2*s,F=2*u,G=2*w,H=2*n,I=2*p,J=2*o;for(var K=0;K<2;++K){var L=c[E+K],M=c[F+K],N=c[G+K];c[H+K]=L,c[I+K]=M,c[J+K]=N}h(q,a,c),h(r,b,c);for(var O=x;O<=y;++O)if(l(O,A,B,c))O!==x&&g(O,x,c),++x;else if(!l(O,C,D,c))for(;;){if(!l(y,C,D,c)){if(--y<O)break;continue}l(y,A,B,c)?(i(O,x,y,c),++x,--y):(g(O,y,c),--y);break}j(a,x-1,A,B,c),j(b,y+1,C,D,c),x-2-a<=d?f(a,x-2,c):m(a,x-2,c),b-(y+2)<=d?f(y+2,b,c):m(y+2,b,c),y-x<=d?f(x,y,c):m(x,y,c)}"use strict",b.exports=e;var d=32},{}],79:[function(a,b,c){function p(a){var b=e.nextPow2(a);i.length<b&&(d.free(i),i=d.mallocInt32(b)),j.length<b&&(d.free(j),j=d.mallocInt32(b)),k.length<b&&(d.free(k),k=d.mallocInt32(b)),l.length<b&&(d.free(l),l=d.mallocInt32(b)),m.length<b&&(d.free(m),m=d.mallocInt32(b)),n.length<b&&(d.free(n),n=d.mallocInt32(b));var c=8*b;o.length<c&&(d.free(o),o=d.mallocDouble(c))}function q(a,b,c,d){var e=b[d],f=a[c-1];a[e]=f,b[f]=e}function r(a,b,c,d){a[c]=d,b[d]=c}function s(a,b,c,d,e,h,m,n,p,s){var t=0,u=2*a,v=a-1,w=u-1;for(var x=c;x<d;++x){var y=h[x],z=u*x;o[t++]=e[z+v],o[t++]=-(y+1),o[t++]=e[z+w],o[t++]=y}for(var x=m;x<n;++x){var y=s[x]+g,A=u*x;o[t++]=p[A+v],o[t++]=-y,o[t++]=p[A+w],o[t++]=y}var B=t>>>1;f(o,B);var C=0,D=0;for(var x=0;x<B;++x){var E=o[2*x+1]|0;if(E>=g)E=E-g|0,q(k,l,D--,E);else if(E>=0)q(i,j,C--,E);else if(E<=-g){E=-E-g|0;for(var F=0;F<C;++F){var G=b(i[F],E);if(G!==void 0)return G}r(k,l,D++,E)}else{E=-E-1|0;for(var F=0;F<D;++F){var G=b(E,k[F]);if(G!==void 0)return G}r(i,j,C++,E)}}}function t(a,b,c,d,e,g,h,p,s,t){var u=0,v=2*a,w=a-1,x=v-1;for(var y=c;y<d;++y){var z=g[y]+1<<1,A=v*y;o[u++]=e[A+w],o[u++]=-z,o[u++]=e[A+x],o[u++]=z}for(var y=h;y<p;++y){var z=t[y]+1<<1,B=v*y;o[u++]=s[B+w],o[u++]=-z|1,o[u++]=s[B+x],o[u++]=z|1}var C=u>>>1;f(o,C);var D=0,E=0,F=0;for(var y=0;y<C;++y){var G=o[2*y+1]|0,H=G&1;y<C-1&&G>>1===o[2*y+3]>>1&&(H=2,y+=1);if(G<0){var I=-(G>>1)-1;for(var J=0;J<F;++J){var K=b(m[J],I);if(K!==void 0)return K}if(H!==0)for(var J=0;J<D;++J){var K=b(i[J],I);if(K!==void 0)return K}if(H!==1)for(var J=0;J<E;++J){var K=b(k[J],I);if(K!==void 0)return K}H===0?r(i,j,D++,I):H===1?r(k,l,E++,I):H===2&&r(m,n,F++,I)}else{var I=(G>>1)-1;H===0?q(i,j,D--,I):H===1?q(k,l,E--,I):H===2&&q(m,n,F--,I)}}}function u(a,b,c,d,e,h,k,l,m,n,p,s){var t=0,u=2*a,v=b,w=b+a,x=1,y=1;d?y=g:x=g;for(var z=e;z<h;++z){var A=z+x,B=u*z;o[t++]=k[B+v],o[t++]=-A,o[t++]=k[B+w],o[t++]=A}for(var z=m;z<n;++z){var A=z+y,C=u*z;o[t++]=p[C+v],o[t++]=-A}var D=t>>>1;f(o,D);var E=0;for(var z=0;z<D;++z){var F=o[2*z+1]|0;if(F<0){var A=-F,G=!1;A>=g?(G=!d,A-=g):(G=!!d,A-=1);if(G)r(i,j,E++,A);else{var H=s[A],I=u*A,J=p[I+b+1],K=p[I+b+1+a];a:for(var L=0;L<E;++L){var M=i[L],N=u*M;if(K<k[N+b+1]||k[N+b+1+a]<J)continue;for(var O=b+2;O<a;++O)if(p[I+O+a]<k[N+O]||k[N+O+a]<p[I+O])continue a;var P=l[M],Q;d?Q=c(H,P):Q=c(P,H);if(Q!==void 0)return Q}}}else q(i,j,E--,F-x)}}function v(a,b,c,d,e,h,j,k,l,m,n){var p=0,q=2*a,r=b,s=b+a;for(var t=d;t<e;++t){var u=t+g,v=q*t;o[p++]=h[v+r],o[p++]=-u,o[p++]=h[v+s],o[p++]=u}for(var t=k;t<l;++t){var u=t+1,w=q*t;o[p++]=m[w+r],o[p++]=-u}var x=p>>>1;f(o,x);var y=0;for(var t=0;t<x;++t){var z=o[2*t+1]|0;if(z<0){var u=-z;if(u>=g)i[y++]=u-g;else{u-=1;var A=n[u],B=q*u,C=m[B+b+1],D=m[B+b+1+a];a:for(var E=0;E<y;++E){var F=i[E],G=j[F];if(G===A)break;var H=q*F;if(D<h[H+b+1]||h[H+b+1+a]<C)continue;for(var I=b+2;I<a;++I)if(m[B+I+a]<h[H+I]||h[H+I+a]<m[B+I])continue a;var J=c(G,A);if(J!==void 0)return J}}}else{var u=z-g;for(var E=y-1;E>=0;--E)if(i[E]===u){for(var I=E+1;I<y;++I)i[I-1]=i[I];break}--y}}}"use strict",b.exports={init:p,sweepBipartite:s,sweepComplete:t,scanBipartite:u,scanComplete:v};var d=a(150),e=a(71),f=a(78),g=1<<28,h=1024,i=d.mallocInt32(h),j=d.mallocInt32(h),k=d.mallocInt32(h),l=d.mallocInt32(h),m=d.mallocInt32(h),n=d.mallocInt32(h),o=d.mallocDouble(h*8)},{150:150,71:71,78:78}],80:[function(a,b,c){},{}],81:[function(a,b,c){function e(){}var d=b.exports={};d.nextTick=function(){var a=typeof window!="undefined"&&window.setImmediate,b=typeof window!="undefined"&&window.MutationObserver,c=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(b){d.length||e.setAttribute("yes","no"),d.push(b)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||b===null)&&a.data==="process-tick"){a.stopPropagation();if(d.length>0){var c=d.shift();c()}}},!0),function(b){d.push(b),window.postMessage("process-tick","*")}):function(b){setTimeout(b,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=e,d.addListener=e,d.once=e,d.off=e,d.removeListener=e,d.removeAllListeners=e,d.emit=e,d.binding=function(a){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],82:[function(a,b,c){((function(b){function h(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,b.foo()===42&&b.constructor===a&&typeof b.subarray=="function"&&b.subarray(1,1).byteLength===0}catch(c){return!1}}function i(){return j.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function j(a){return this instanceof j?(j.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=undefined),typeof a=="number"?k(this,a):typeof a=="string"?l(this,a,arguments.length>1?arguments[1]:"utf8"):m(this,a)):arguments.length>1?new j(a,arguments[1]):new j(a)}function k(a,b){a=t(a,b<0?0:u(b)|0);if(!j.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;c++)a[c]=0;return a}function l(a,b,c){if(typeof c!="string"||c==="")c="utf8";var d=w(b,c)|0;return a=t(a,d),a.write(b,c),a}function m(a,b){if(j.isBuffer(b))return n(a,b);if(f(b))return o(a,b);if(b==null)throw new TypeError("must start with number, buffer, array or string");if(typeof ArrayBuffer!="undefined"){if(b.buffer instanceof ArrayBuffer)return p(a,b);if(b instanceof ArrayBuffer)return q(a,b)}return b.length?r(a,b):s(a,b)}function n(a,b){var c=u(b.length)|0;return a=t(a,c),b.copy(a,0,0,c),a}function o(a,b){var c=u(b.length)|0;a=t(a,c);for(var d=0;d<c;d+=1)a[d]=b[d]&255;return a}function p(a,b){var c=u(b.length)|0;a=t(a,c);for(var d=0;d<c;d+=1)a[d]=b[d]&255;return a}function q(a,b){return j.TYPED_ARRAY_SUPPORT?(b.byteLength,a=j._augment(new Uint8Array(b))):a=p(a,new Uint8Array(b)),a}function r(a,b){var c=u(b.length)|0;a=t(a,c);for(var d=0;d<c;d+=1)a[d]=b[d]&255;return a}function s(a,b){var c,d=0;b.type==="Buffer"&&f(b.data)&&(c=b.data,d=u(c.length)|0),a=t(a,d);for(var e=0;e<d;e+=1)a[e]=c[e]&255;return a}function t(a,b){j.TYPED_ARRAY_SUPPORT?(a=j._augment(new Uint8Array(b)),a.__proto__=j.prototype):(a.length=b,a._isBuffer=!0);var c=b!==0&&b<=j.poolSize>>>1;return c&&(a.parent=g),a}function u(a){if(a>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return a|0}function v(a,b){if(this instanceof v){var c=new j(a,b);return delete c.parent,c}return new v(a,b)}function w(a,b){typeof a!="string"&&(a=""+a);var c=a.length;if(c===0)return 0;var d=!1;for(;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return Y(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return _(a).length;default:if(d)return Y(a).length;b=(""+b).toLowerCase(),d=!0}}function x(a,b,c){var d=!1;b|=0,c=c===undefined||c===Infinity?this.length:c|0,a||(a="utf8"),b<0&&(b=0),c>this.length&&(c=this.length);if(c<=b)return"";for(;;)switch(a){case"hex":return K(this,b,c);case"utf8":case"utf-8":return F(this,b,c);case"ascii":return I(this,b,c);case"binary":return J(this,b,c);case"base64":return E(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function y(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;g++){var h=parseInt(b.substr(g*2,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function z(a,b,c,d){return ba(Y(b,a.length-c),a,c,d)}function A(a,b,c,d){return ba(Z(b),a,c,d)}function B(a,b,c,d){return A(a,b,c,d)}function C(a,b,c,d){return ba(_(b),a,c,d)}function D(a,b,c,d){return ba($(b,a.length-c),a,c,d)}function E(a,b,c){return b===0&&c===a.length?d.fromByteArray(a):d.fromByteArray(a.slice(b,c))}function F(a,b,c){c=Math.min(a.length,c);var d=[],e=b;while(e<c){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],(i&192)===128&&(l=(f&31)<<6|i&63,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],(i&192)===128&&(j&192)===128&&(l=(f&15)<<12|(i&63)<<6|j&63,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],(i&192)===128&&(j&192)===128&&(k&192)===128&&(l=(f&15)<<18|(i&63)<<12|(j&63)<<6|k&63,l>65535&&l<1114112&&(g=l))}}g===null?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|g&1023),d.push(g),e+=h}return H(d)}function H(a){var b=a.length;if(b<=G)return String.fromCharCode.apply(String,a);var c="",d=0;while(d<b)c+=String.fromCharCode.apply(String,a.slice(d,d+=G));return c}function I(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]&127);return d}function J(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]);return d}function K(a,b,c){var d=a.length;if(!b||b<0)b=0;if(!c||c<0||c>d)c=d;var e="";for(var f=b;f<c;f++)e+=X(a[f]);return e}function L(a,b,c){var d=a.slice(b,c),e="";for(var f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+d[f+1]*256);return e}function M(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function N(a,b,c,d,e,f){if(!j.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function O(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>(d?e:1-e)*8}function P(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>(d?e:3-e)*8&255}function Q(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(c<0)throw new RangeError("index out of range")}function R(a,b,c,d,f){return f||Q(a,b,c,4,3.4028234663852886e+38,-3.4028234663852886e+38),e.write(a,b,c,d,23,4),c+4}function S(a,b,c,d,f){return f||Q(a,b,c,8,1.7976931348623157e+308,-1.7976931348623157e+308),e.write(a,b,c,d,52,8),c+8}function V(a){a=W(a).replace(U,"");if(a.length<2)return"";while(a.length%4!==0)a+="=";return a}function W(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function X(a){return a<16?"0"+a.toString(16):a.toString(16)}function Y(a,b){b=b||Infinity;var c,d=a.length,e=null,f=[];for(var g=0;g<d;g++){c=a.charCodeAt(g);if(c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);e=null;if(c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,c&63|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,c&63|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}}return f}function Z(a){var b=[];for(var c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b}function $(a,b){var c,d,e,f=[];for(var g=0;g<a.length;g++){if((b-=2)<0)break;c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d)}return f}function _(a){return d.toByteArray(V(a))}function ba(a,b,c,d){for(var e=0;e<d;e++){if(e+c>=b.length||e>=a.length)break;b[e+c]=a[e]}return e}"use strict";var d=a(70),e=a(107),f=a(83);c.Buffer=j,c.SlowBuffer=v,c.INSPECT_MAX_BYTES=50,j.poolSize=8192;var g={};j.TYPED_ARRAY_SUPPORT=b.TYPED_ARRAY_SUPPORT!==undefined?b.TYPED_ARRAY_SUPPORT:h(),j.TYPED_ARRAY_SUPPORT?(j.prototype.__proto__=Uint8Array.prototype,j.__proto__=Uint8Array):(j.prototype.length=undefined,j.prototype.parent=undefined),j.isBuffer=function(b){return b!=null&&!!b._isBuffer},j.compare=function(b,c){if(!j.isBuffer(b)||!j.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(b===c)return 0;var d=b.length,e=c.length,f=0,g=Math.min(d,e);while(f<g){if(b[f]!==c[f])break;++f}return f!==g&&(d=b[f],e=c[f]),d<e?-1:e<d?1:0},j.isEncoding=function(b){switch(String(b).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},j.concat=function(b,c){if(!f(b))throw new TypeError("list argument must be an Array of Buffers.");if(b.length===0)return new j(0);var d;if(c===undefined){c=0;for(d=0;d<b.length;d++)c+=b[d].length}var e=new j(c),g=0;for(d=0;d<b.length;d++){var h=b[d];h.copy(e,g),g+=h.length}return e},j.byteLength=w,j.prototype.toString=function bb(){var a=this.length|0;return a===0?"":arguments.length===0?F(this,0,a):x.apply(this,arguments)},j.prototype.equals=function(b){if(!j.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:j.compare(this,b)===0},j.prototype.inspect=function(){var b="",d=c.INSPECT_MAX_BYTES;return this.length>0&&(b=this.toString("hex",0,d).match(/.{2}/g).join(" "),this.length>d&&(b+=" ... ")),"<Buffer "+b+">"},j.prototype.compare=function(b){if(!j.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:j.compare(this,b)},j.prototype.indexOf=function(b,c){function d(a,b,c){var d=-1;for(var e=0;c+e<a.length;e++)if(a[c+e]===b[d===-1?0:e-d]){d===-1&&(d=e);if(e-d+1===b.length)return c+d}else d=-1;return-1}c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c>>=0;if(this.length===0)return-1;if(c>=this.length)return-1;c<0&&(c=Math.max(this.length+c,0));if(typeof b=="string")return b.length===0?-1:String.prototype.indexOf.call(this,b,c);if(j.isBuffer(b))return d(this,b,c);if(typeof b=="number")return j.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"?Uint8Array.prototype.indexOf.call(this,b,c):d(this,[b],c);throw new TypeError("val must be string, number or Buffer")},j.prototype.get=function(b){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(b)},j.prototype.set=function(b,c){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(b,c)},j.prototype.write=function(b,c,d,e){if(c===undefined)e="utf8",d=this.length,c=0;else if(d===undefined&&typeof c=="string")e=c,d=this.length,c=0;else if(isFinite(c))c|=0,isFinite(d)?(d|=0,e===undefined&&(e="utf8")):(e=d,d=undefined);else{var f=e;e=c,c=d|0,d=f}var g=this.length-c;if(d===undefined||d>g)d=g;if(b.length>0&&(d<0||c<0)||c>this.length)throw new RangeError("attempt to write outside buffer bounds");e||(e="utf8");var h=!1;for(;;)switch(e){case"hex":return y(this,b,c,d);case"utf8":case"utf-8":return z(this,b,c,d);case"ascii":return A(this,b,c,d);case"binary":return B(this,b,c,d);case"base64":return C(this,b,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,b,c,d);default:if(h)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),h=!0}},j.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var G=4096;j.prototype.slice=function(b,c){var d=this.length;b=~~b,c=c===undefined?d:~~c,b<0?(b+=d,b<0&&(b=0)):b>d&&(b=d),c<0?(c+=d,c<0&&(c=0)):c>d&&(c=d),c<b&&(c=b);var e;if(j.TYPED_ARRAY_SUPPORT)e=j._augment(this.subarray(b,c));else{var f=c-b;e=new j(f,undefined);for(var g=0;g<f;g++)e[g]=this[g+b]}return e.length&&(e.parent=this.parent||this),e},j.prototype.readUIntLE=function(b,c,d){b|=0,c|=0,d||M(b,c,this.length);var e=this[b],f=1,g=0;while(++g<c&&(f*=256))e+=this[b+g]*f;return e},j.prototype.readUIntBE=function(b,c,d){b|=0,c|=0,d||M(b,c,this.length);var e=this[b+ --c],f=1;while(c>0&&(f*=256))e+=this[b+ --c]*f;return e},j.prototype.readUInt8=function(b,c){return c||M(b,1,this.length),this[b]},j.prototype.readUInt16LE=function(b,c){return c||M(b,2,this.length),this[b]|this[b+1]<<8},j.prototype.readUInt16BE=function(b,c){return c||M(b,2,this.length),this[b]<<8|this[b+1]},j.prototype.readUInt32LE=function(b,c){return c||M(b,4,this.length),(this[b]|this[b+1]<<8|this[b+2]<<16)+this[b+3]*16777216},j.prototype.readUInt32BE=function(b,c){return c||M(b,4,this.length),this[b]*16777216+(this[b+1]<<16|this[b+2]<<8|this[b+3])},j.prototype.readIntLE=function(b,c,d){b|=0,c|=0,d||M(b,c,this.length);var e=this[b],f=1,g=0;while(++g<c&&(f*=256))e+=this[b+g]*f;return f*=128,e>=f&&(e-=Math.pow(2,8*c)),e},j.prototype.readIntBE=function(b,c,d){b|=0,c|=0,d||M(b,c,this.length);var e=c,f=1,g=this[b+ --e];while(e>0&&(f*=256))g+=this[b+ --e]*f;return f*=128,g>=f&&(g-=Math.pow(2,8*c)),g},j.prototype.readInt8=function(b,c){return c||M(b,1,this.length),this[b]&128?(255-this[b]+1)*-1:this[b]},j.prototype.readInt16LE=function(b,c){c||M(b,2,this.length);var d=this[b]|this[b+1]<<8;return d&32768?d|4294901760:d},j.prototype.readInt16BE=function(b,c){c||M(b,2,this.length);var d=this[b+1]|this[b]<<8;return d&32768?d|4294901760:d},j.prototype.readInt32LE=function(b,c){return c||M(b,4,this.length),this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24},j.prototype.readInt32BE=function(b,c){return c||M(b,4,this.length),this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]},j.prototype.readFloatLE=function(b,c){return c||M(b,4,this.length),e.read(this,b,!0,23,4)},j.prototype.readFloatBE=function(b,c){return c||M(b,4,this.length),e.read(this,b,!1,23,4)},j.prototype.readDoubleLE=function(b,c){return c||M(b,8,this.length),e.read(this,b,!0,52,8)},j.prototype.readDoubleBE=function(b,c){return c||M(b,8,this.length),e.read(this,b,!1,52,8)},j.prototype.writeUIntLE=function(b,c,d,e){b=+b,c|=0,d|=0,e||N(this,b,c,d,Math.pow(2,8*d),0);var f=1,g=0;this[c]=b&255;while(++g<d&&(f*=256))this[c+g]=b/f&255;return c+d},j.prototype.writeUIntBE=function(b,c,d,e){b=+b,c|=0,d|=0,e||N(this,b,c,d,Math.pow(2,8*d),0);var f=d-1,g=1;this[c+f]=b&255;while(--f>=0&&(g*=256))this[c+f]=b/g&255;return c+d},j.prototype.writeUInt8=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,1,255,0),j.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),this[c]=b&255,c+1},j.prototype.writeUInt16LE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,2,65535,0),j.TYPED_ARRAY_SUPPORT?(this[c]=b&255,this[c+1]=b>>>8):O(this,b,c,!0),c+2},j.prototype.writeUInt16BE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,2,65535,0),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=b&255):O(this,b,c,!1),c+2},j.prototype.writeUInt32LE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,4,4294967295,0),j.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=b&255):P(this,b,c,!0),c+4},j.prototype.writeUInt32BE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,4,4294967295,0),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b&255):P(this,b,c,!1),c+4},j.prototype.writeIntLE=function(b,c,d,e){b=+b,c|=0;if(!e){var f=Math.pow(2,8*d-1);N(this,b,c,d,f-1,-f)}var g=0,h=1,i=b<0?1:0;this[c]=b&255;while(++g<d&&(h*=256))this[c+g]=(b/h>>0)-i&255;return c+d},j.prototype.writeIntBE=function(b,c,d,e){b=+b,c|=0;if(!e){var f=Math.pow(2,8*d-1);N(this,b,c,d,f-1,-f)}var g=d-1,h=1,i=b<0?1:0;this[c+g]=b&255;while(--g>=0&&(h*=256))this[c+g]=(b/h>>0)-i&255;return c+d},j.prototype.writeInt8=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,1,127,-128),j.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),b<0&&(b=255+b+1),this[c]=b&255,c+1},j.prototype.writeInt16LE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,2,32767,-32768),j.TYPED_ARRAY_SUPPORT?(this[c]=b&255,this[c+1]=b>>>8):O(this,b,c,!0),c+2},j.prototype.writeInt16BE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,2,32767,-32768),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=b&255):O(this,b,c,!1),c+2},j.prototype.writeInt32LE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,4,2147483647,-2147483648),j.TYPED_ARRAY_SUPPORT?(this[c]=b&255,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):P(this,b,c,!0),c+4},j.prototype.writeInt32BE=function(b,c,d){return b=+b,c|=0,d||N(this,b,c,4,2147483647,-2147483648),b<0&&(b=4294967295+b+1),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b&255):P(this,b,c,!1),c+4},j.prototype.writeFloatLE=function(b,c,d){return R(this,b,c,!0,d)},j.prototype.writeFloatBE=function(b,c,d){return R(this,b,c,!1,d)},j.prototype.writeDoubleLE=function(b,c,d){return S(this,b,c,!0,d)},j.prototype.writeDoubleBE=function(b,c,d){return S(this,b,c,!1,d)},j.prototype.copy=function(b,c,d,e){d||(d=0),!e&&e!==0&&(e=this.length),c>=b.length&&(c=b.length),c||(c=0),e>0&&e<d&&(e=d);if(e===d)return 0;if(b.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),b.length-c<e-d&&(e=b.length-c+d);var f=e-d,g;if(this===b&&d<c&&c<e)for(g=f-1;g>=0;g--)b[g+c]=this[g+d];else if(f<1e3||!j.TYPED_ARRAY_SUPPORT)for(g=0;g<f;g++)b[g+c]=this[g+d];else b._set(this.subarray(d,d+f),c);return f},j.prototype.fill=function(b,c,d){b||(b=0),c||(c=0),d||(d=this.length);if(d<c)throw new RangeError("end < start");if(d===c)return;if(this.length===0)return;if(c<0||c>=this.length)throw new RangeError("start out of bounds");if(d<0||d>this.length)throw new RangeError("end out of bounds");var e;if(typeof b=="number")for(e=c;e<d;e++)this[e]=b;else{var f=Y(b.toString()),g=f.length;for(e=c;e<d;e++)this[e]=f[e%g]}return this},j.prototype.toArrayBuffer=function(){if(typeof Uint8Array!="undefined"){if(j.TYPED_ARRAY_SUPPORT)return(new j(this)).buffer;var b=new Uint8Array(this.length);for(var c=0,d=b.length;c<d;c+=1)b[c]=this[c];return b.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var T=j.prototype;j._augment=function(b){return b.constructor=j,b._isBuffer=!0,b._set=b.set,b.get=T.get,b.set=T.set,b.write=T.write,b.toString=T.toString,b.toLocaleString=T.toString,b.toJSON=T.toJSON,b.equals=T.equals,b.compare=T.compare,b.indexOf=T.indexOf,b.copy=T.copy,b.slice=T.slice,b.readUIntLE=T.readUIntLE,b.readUIntBE=T.readUIntBE,b.readUInt8=T.readUInt8,b.readUInt16LE=T.readUInt16LE,b.readUInt16BE=T.readUInt16BE,b.readUInt32LE=T.readUInt32LE,b.readUInt32BE=T.readUInt32BE,b.readIntLE=T.readIntLE,b.readIntBE=T.readIntBE,b.readInt8=T.readInt8,b.readInt16LE=T.readInt16LE,b.readInt16BE=T.readInt16BE,b.readInt32LE=T.readInt32LE,b.readInt32BE=T.readInt32BE,b.readFloatLE=T.readFloatLE,b.readFloatBE=T.readFloatBE,b.readDoubleLE=T.readDoubleLE,b.readDoubleBE=T.readDoubleBE,b.writeUInt8=T.writeUInt8,b.writeUIntLE=T.writeUIntLE,b.writeUIntBE=T.writeUIntBE,b.writeUInt16LE=T.writeUInt16LE,b.writeUInt16BE=T.writeUInt16BE,b.writeUInt32LE=T.writeUInt32LE,b.writeUInt32BE=T.writeUInt32BE,b.writeIntLE=T.writeIntLE,b.writeIntBE=T.writeIntBE,b.writeInt8=T.writeInt8,b.writeInt16LE=T.writeInt16LE,b.writeInt16BE=T.writeInt16BE,b.writeInt32LE=T.writeInt32LE,b.writeInt32BE=T.writeInt32BE,b.writeFloatLE=T.writeFloatLE,b.writeFloatBE=T.writeFloatBE,b.writeDoubleLE=T.writeDoubleLE,b.writeDoubleBE=T.writeDoubleBE,b.fill=T.fill,b.inspect=T.inspect,b.toArrayBuffer=T.toArrayBuffer,b};var U=/[^+\/0-9A-Za-z-_]/g})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{107:107,70:70,83:83}],83:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return d.call(a)=="[object Array]"}},{}],84:[function(a,b,c){var d=[].slice;b.exports=function(a,b){"string"==typeof b&&(b=a[b]);if("function"!=typeof b)throw new Error("bind() requires a function");var c=d.call(arguments,2);return function(){return b.apply(a,c.concat(d.call(arguments)))}}},{}],85:[function(a,b,c){function d(a){if(a)return e(a)}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}typeof b!="undefined"&&(b.exports=d),d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){this.off(a,c),b.apply(this,arguments)}return c.fn=b,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var c=this._callbacks["$"+a];if(!c)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;var d;for(var e=0;e<c.length;e++){d=c[e];if(d===b||d.fn===b){c.splice(e,1);break}}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks["$"+a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],86:[function(a,b,c){b.exports=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],87:[function(a,b,c){((function(d){function e(){return typeof document!="undefined"&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function f(){var a=arguments,b=this.useColors;a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff);if(!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){if("%%"===a)return;e++,"%c"===a&&(f=e)}),a.splice(f,0,d),a}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function h(a){try{null==a?c.storage.removeItem("debug"):c.storage.debug=a}catch(b){}}function i(){var a;try{return c.storage.debug}catch(b){}if(typeof d!="undefined"&&"env"in d)return d.env.DEBUG}function j(){try{return window.localStorage}catch(a){}}c=b.exports=a(88),c.log=g,c.formatArgs=f,c.save=h,c.load=i,c.useColors=e,c.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:j(),c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){try{return JSON.stringify(a)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}},c.enable(i())})).call(this,a(81))},{81:81,88:88}],88:[function(a,b,c){function f(){return c.colors[d++%c.colors.length]}function g(a){function b(){}function d(){var a=d,b=+(new Date),g=b-(e||b);a.diff=g,a.prev=e,a.curr=b,e=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=f());var h=new Array(arguments.length);for(var i=0;i<h.length;i++)h[i]=arguments[i];h[0]=c.coerce(h[0]),"string"!=typeof h[0]&&(h=["%o"].concat(h));var j=0;h[0]=h[0].replace(/%([a-z%])/g,function(b,d){if(b==="%%")return b;j++;var e=c.formatters[d];if("function"==typeof e){var f=h[j];b=e.call(a,f),h.splice(j,1),j--}return b}),h=c.formatArgs.apply(a,h);var k=d.log||c.log||console.log.bind(console);k.apply(a,h)}b.enabled=!1,d.enabled=!0;var g=c.enabled(a)?d:b;return g.namespace=a,g}function h(a){c.save(a);var b=(a||"").split(/[\s,]+/),d=b.length;for(var e=0;e<d;e++){if(!b[e])continue;a=b[e].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),a[0]==="-"?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$"))}}function i(){c.enable("")}function j(a){var b,d;for(b=0,d=c.skips.length;b<d;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;b<d;b++)if(c.names[b].test(a))return!0;return!1}function k(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=g.debug=g,c.coerce=k,c.disable=i,c.enable=h,c.enabled=j,c.humanize=a(89),c.names=[],c.skips=[],c.formatters={};var d=0,e},{89:89}],89:[function(a,b,c){function i(a){a=String(a);if(a.length>1e4)return;var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(!b)return;var c=parseFloat(b[1]),i=(b[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return c*h;case"days":case"day":case"d":return c*g;case"hours":case"hour":case"hrs":case"hr":case"h":return c*f;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return undefined}}function j(a){return a>=g?Math.round(a/g)+"d":a>=f?Math.round(a/f)+"h":a>=e?Math.round(a/e)+"m":a>=d?Math.round(a/d)+"s":a+"ms"}function k(a){return l(a,g,"day")||l(a,f,"hour")||l(a,e,"minute")||l(a,d,"second")||a+" ms"}function l(a,b,c){if(a<b)return;return a<b*1.5?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var d=1e3,e=d*60,f=e*60,g=f*24,h=g*365.25;b.exports=function(a,b){b=b||{};var c=typeof a;if(c==="string"&&a.length>0)return i(a);if(c==="number"&&isNaN(a)===!1)return b.long?k(a):j(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},{}],90:[function(a,b,c){function d(a,b,c){var e=a[c]|0;if(e<=0)return[];var f=new Array(e),g;if(c===a.length-1)for(g=0;g<e;++g)f[g]=b;else for(g=0;g<e;++g)f[g]=d(a,b,c+1);return f}function e(a,b){var c,d;c=new Array(a);for(d=0;d<a;++d)c[d]=b;return c}function f(a,b){typeof b=="undefined"&&(b=0);switch(typeof a){case"number":if(a>0)return e(a|0,b);break;case"object":if(typeof a.length=="number")return d(a,b,0)}return[]}"use strict",b.exports=f},{}],91:[function(a,b,c){b.exports=a(92)},{92:92}],92:[function(a,b,c){b.exports=a(93),b.exports.parser=a(101)},{101:101,93:93}],93:[function(a,b,c){((function(c){function l(a,b){if(!(this instanceof l))return new l(a,b);b=b||{},a&&"object"==typeof a&&(b=a,a=null),a?(a=i(a),b.hostname=a.host,b.secure=a.protocol==="https"||a.protocol==="wss",b.port=a.port,a.query&&(b.query=a.query)):b.host&&(b.hostname=i(b.host).host),this.secure=null!=b.secure?b.secure:c.location&&"https:"===location.protocol,b.hostname&&!b.port&&(b.port=this.secure?"443":"80"),this.agent=b.agent||!1,this.hostname=b.hostname||(c.location?location.hostname:"localhost"),this.port=b.port||(c.location&&location.port?location.port:this.secure?443:80),this.query=b.query||{},"string"==typeof this.query&&(this.query=k.decode(this.query)),this.upgrade=!1!==b.upgrade,this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!b.forceJSONP,this.jsonp=!1!==b.jsonp,this.forceBase64=!!b.forceBase64,this.enablesXDR=!!b.enablesXDR,this.timestampParam=b.timestampParam||"t",this.timestampRequests=b.timestampRequests,this.transports=b.transports||["polling","websocket"],this.readyState="",this.
writeBuffer=[],this.prevBufferLen=0,this.policyPort=b.policyPort||843,this.rememberUpgrade=b.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=b.onlyBinaryUpgrades,this.perMessageDeflate=!1!==b.perMessageDeflate?b.perMessageDeflate||{}:!1,!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=b.pfx||null,this.key=b.key||null,this.passphrase=b.passphrase||null,this.cert=b.cert||null,this.ca=b.ca||null,this.ciphers=b.ciphers||null,this.rejectUnauthorized=b.rejectUnauthorized===undefined?null:b.rejectUnauthorized,this.forceNode=!!b.forceNode;var d=typeof c=="object"&&c;d.global===d&&(b.extraHeaders&&Object.keys(b.extraHeaders).length>0&&(this.extraHeaders=b.extraHeaders),b.localAddress&&(this.localAddress=b.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function m(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var d=a(95),e=a(85),f=a(87)("engine.io-client:socket"),g=a(108),h=a(101),i=a(115),j=a(113),k=a(114);b.exports=l,l.priorWebsocketSuccess=!1,e(l.prototype),l.protocol=h.protocol,l.Socket=l,l.Transport=a(94),l.transports=a(95),l.parser=a(101),l.prototype.createTransport=function(a){f('creating transport "%s"',a);var b=m(this.query);b.EIO=h.protocol,b.transport=a,this.id&&(b.sid=this.id);var c=new d[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return c},l.prototype.open=function(){var a;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)a="websocket";else{if(0===this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},0);return}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(c){this.transports.shift(),this.open();return}a.open(),this.setTransport(a)},l.prototype.setTransport=function(a){f("setting transport %s",a.name);var b=this;this.transport&&(f("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},l.prototype.probe=function(a){function e(){if(d.onlyBinaryUpgrades){var e=!this.supportsBinary&&d.transport.supportsBinary;c=c||e}if(c)return;f('probe transport "%s" opened',a),b.send([{type:"ping",data:"probe"}]),b.once("packet",function(e){if(c)return;if("pong"===e.type&&"probe"===e.data){f('probe transport "%s" pong',a),d.upgrading=!0,d.emit("upgrading",b);if(!b)return;l.priorWebsocketSuccess="websocket"===b.name,f('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){if(c)return;if("closed"===d.readyState)return;f("changing transport and sending upgrade packet"),m(),d.setTransport(b),b.send([{type:"upgrade"}]),d.emit("upgrade",b),b=null,d.upgrading=!1,d.flush()})}else{f('probe transport "%s" failed',a);var g=new Error("probe error");g.transport=b.name,d.emit("upgradeError",g)}})}function g(){if(c)return;c=!0,m(),b.close(),b=null}function h(c){var e=new Error("probe error: "+c);e.transport=b.name,g(),f('probe transport "%s" failed because of error: %s',a,c),d.emit("upgradeError",e)}function i(){h("transport closed")}function j(){h("socket closed")}function k(a){b&&a.name!==b.name&&(f('"%s" works - aborting "%s"',a.name,b.name),g())}function m(){b.removeListener("open",e),b.removeListener("error",h),b.removeListener("close",i),d.removeListener("close",j),d.removeListener("upgrading",k)}f('probing transport "%s"',a);var b=this.createTransport(a,{probe:1}),c=!1,d=this;l.priorWebsocketSuccess=!1,b.once("open",e),b.once("error",h),b.once("close",i),this.once("close",j),this.once("upgrading",k),b.open()},l.prototype.onOpen=function(){f("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush();if("open"===this.readyState&&this.upgrade&&this.transport.pause){f("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}},l.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){f('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat");switch(a.type){case"open":this.onHandshake(j(a.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var b=new Error("server error");b.code=a.data,this.onError(b);break;case"message":this.emit("data",a.data),this.emit("message",a.data)}}else f('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.onOpen();if("closed"===this.readyState)return;this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat)},l.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"===b.readyState)return;b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)},l.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer),a.pingIntervalTimer=setTimeout(function(){f("writing ping packet - expecting pong within %sms",a.pingTimeout),a.ping(),a.onHeartbeat(a.pingTimeout)},a.pingInterval)},l.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(f("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(a,b,c){return this.sendPacket("message",a,b,c),this},l.prototype.sendPacket=function(a,b,c,d){"function"==typeof b&&(d=b,b=undefined),"function"==typeof c&&(d=c,c=null);if("closing"===this.readyState||"closed"===this.readyState)return;c=c||{},c.compress=!1!==c.compress;var e={type:a,data:b,options:c};this.emit("packetCreate",e),this.writeBuffer.push(e),d&&this.once("flush",d),this.flush()},l.prototype.close=function(){function b(){a.onClose("forced close"),f("socket closing - telling transport to close"),a.transport.close()}function c(){a.removeListener("upgrade",c),a.removeListener("upgradeError",c),b()}function d(){a.once("upgrade",c),a.once("upgradeError",c)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var a=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?d():b()}):this.upgrading?d():b()}return this},l.prototype.onError=function(a){f("socket error %j",a),l.priorWebsocketSuccess=!1,this.emit("error",a),this.onClose("transport error",a)},l.prototype.onClose=function(a,b){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){f('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b),c.writeBuffer=[],c.prevBufferLen=0}},l.prototype.filterUpgrades=function(a){var b=[];for(var c=0,d=a.length;c<d;c++)~g(this.transports,a[c])&&b.push(a[c]);return b}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{101:101,108:108,113:113,114:114,115:115,85:85,87:87,94:94,95:95}],94:[function(a,b,c){function f(a){this.path=a.path,this.hostname=a.hostname,this.port=a.port,this.secure=a.secure,this.query=a.query,this.timestampParam=a.timestampParam,this.timestampRequests=a.timestampRequests,this.readyState="",this.agent=a.agent||!1,this.socket=a.socket,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.forceNode=a.forceNode,this.extraHeaders=a.extraHeaders,this.localAddress=a.localAddress}var d=a(101),e=a(85);b.exports=f,e(f.prototype),f.prototype.onError=function(a,b){var c=new Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},f.prototype.open=function(){if("closed"===this.readyState||""===this.readyState)this.readyState="opening",this.doOpen();return this},f.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState)this.doClose(),this.onClose();return this},f.prototype.send=function(a){if("open"!==this.readyState)throw new Error("Transport not open");this.write(a)},f.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},f.prototype.onData=function(a){var b=d.decodePacket(a,this.socket.binaryType);this.onPacket(b)},f.prototype.onPacket=function(a){this.emit("packet",a)},f.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{101:101,85:85}],95:[function(a,b,c){((function(b){function h(a){var c,g=!1,h=!1,i=!1!==a.jsonp;if(b.location){var j="https:"===location.protocol,k=location.port;k||(k=j?443:80),g=a.hostname!==location.hostname||k!==a.port,h=a.secure!==j}a.xdomain=g,a.xscheme=h,c=new d(a);if("open"in c&&!a.forceJSONP)return new e(a);if(!i)throw new Error("JSONP disabled");return new f(a)}var d=a(100),e=a(97),f=a(96),g=a(99);c.polling=h,c.websocket=g})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{100:100,96:96,97:97,99:99}],96:[function(a,b,c){((function(c){function i(){}function j(a){d.call(this,a),this.query=this.query||{},h||(c.___eio||(c.___eio=[]),h=c.___eio),this.index=h.length;var b=this;h.push(function(a){b.onData(a)}),this.query.j=this.index,c.document&&c.addEventListener&&c.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=i)},!1)}var d=a(98),e=a(86);b.exports=j;var f=/\n/g,g=/\\n/g,h;e(j,d),j.prototype.supportsBinary=!1,j.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),d.prototype.doClose.call(this)},j.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),b.async=!0,b.src=this.uri(),b.onerror=function(b){a.onError("jsonp poll error",b)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(b,c):(document.head||document.body).appendChild(b),this.script=b;var d="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);d&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},j.prototype.doWrite=function(a,b){function j(){k(),b()}function k(){if(c.iframe)try{c.form.removeChild(c.iframe)}catch(a){c.onError("jsonp polling iframe removal error",a)}try{var b='<iframe src="javascript:0" name="'+c.iframeId+'">';i=document.createElement(b)}catch(a){i=document.createElement("iframe"),i.name=c.iframeId,i.src="javascript:0"}i.id=c.iframeId,c.form.appendChild(i),c.iframe=i}var c=this;if(!this.form){var d=document.createElement("form"),e=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index,i;d.className="socketio",d.style.position="absolute",d.style.top="-1000px",d.style.left="-1000px",d.target=h,d.method="POST",d.setAttribute("accept-charset","utf-8"),e.name="d",d.appendChild(e),document.body.appendChild(d),this.form=d,this.area=e}this.form.action=this.uri(),k(),a=a.replace(g,"\\\n"),this.area.value=a.replace(f,"\\n");try{this.form.submit()}catch(l){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){c.iframe.readyState==="complete"&&j()}:this.iframe.onload=j}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{86:86,98:98}],97:[function(a,b,c){((function(c){function i(){}function j(a){e.call(this,a),this.requestTimeout=a.requestTimeout;if(c.location){var b="https:"===location.protocol,d=location.port;d||(d=b?443:80),this.xd=a.hostname!==c.location.hostname||d!==a.port,this.xs=a.secure!==b}else this.extraHeaders=a.extraHeaders}function k(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.xs=!!a.xs,this.async=!1!==a.async,this.data=undefined!==a.data?a.data:null,this.agent=a.agent,this.isBinary=a.isBinary,this.supportsBinary=a.supportsBinary,this.enablesXDR=a.enablesXDR,this.requestTimeout=a.requestTimeout,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.extraHeaders=a.extraHeaders,this.create()}function l(){for(var a in k.requests)k.requests.hasOwnProperty(a)&&k.requests[a].abort()}var d=a(100),e=a(98),f=a(85),g=a(86),h=a(87)("engine.io-client:polling-xhr");b.exports=j,b.exports.Request=k,g(j,e),j.prototype.supportsBinary=!0,j.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=this.requestTimeout,a.extraHeaders=this.extraHeaders,new k(a)},j.prototype.doWrite=function(a,b){var c=typeof a!="string"&&a!==undefined,d=this.request({method:"POST",data:a,isBinary:c}),e=this;d.on("success",b),d.on("error",function(a){e.onError("xhr post error",a)}),this.sendXhr=d},j.prototype.doPoll=function(){h("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},f(k.prototype),k.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new d(a),e=this;try{h("xhr open %s: %s",this.method,this.uri),b.open(this.method,this.uri,this.async);try{if(this.extraHeaders){b.setDisableHeaderCheck(!0);for(var f in this.extraHeaders)this.extraHeaders.hasOwnProperty(f)&&b.setRequestHeader(f,this.extraHeaders[f])}}catch(g){}this.supportsBinary&&(b.responseType="arraybuffer");if("POST"===this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(g){}try{b.setRequestHeader("Accept","*/*")}catch(g){}"withCredentials"in b&&(b.withCredentials=!0),this.requestTimeout&&(b.timeout=this.requestTimeout),this.hasXDR()?(b.onload=function(){e.onLoad()},b.onerror=function(){e.onError(b.responseText)}):b.onreadystatechange=function(){if(4!==b.readyState)return;200===b.status||1223===b.status?e.onLoad():setTimeout(function(){e.onError(b.status)},0)},h("xhr data %s",this.data),b.send(this.data)}catch(g){setTimeout(function(){e.onError(g)},0);return}c.document&&(this.index=k.requestsCount++,k.requests[this.index]=this)},k.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},k.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},k.prototype.onError=function(a){this.emit("error",a),this.cleanup(!0)},k.prototype.cleanup=function(a){if("undefined"==typeof this.xhr||null===this.xhr)return;this.hasXDR()?this.xhr.onload=this.xhr.onerror=i:this.xhr.onreadystatechange=i;if(a)try{this.xhr.abort()}catch(b){}c.document&&delete k.requests[this.index],this.xhr=null},k.prototype.onLoad=function(){var a;try{var b;try{b=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(c){}if(b==="application/octet-stream")a=this.xhr.response||this.xhr.responseText;else if(!this.supportsBinary)a=this.xhr.responseText;else try{a=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(c){var d=new Uint8Array(this.xhr.response),e=[];for(var f=0,g=d.length;f<g;f++)e.push(d[f]);a=String.fromCharCode.apply(null,e)}}catch(c){this.onError(c)}null!=a&&this.onData(a)},k.prototype.hasXDR=function(){return"undefined"!=typeof c.XDomainRequest&&!this.xs&&this.enablesXDR},k.prototype.abort=function(){this.cleanup()},k.requestsCount=0,k.requests={},c.document&&(c.attachEvent?c.attachEvent("onunload",l):c.addEventListener&&c.addEventListener("beforeunload",l,!1))})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{100:100,85:85,86:86,87:87,98:98}],98:[function(a,b,c){function k(a){var b=a&&a.forceBase64;if(!j||b)this.supportsBinary=!1;d.call(this,a)}var d=a(94),e=a(114),f=a(101),g=a(86),h=a(154),i=a(87)("engine.io-client:polling");b.exports=k;var j=function(){var b=a(100),c=new b({xdomain:!1});return null!=c.responseType}();g(k,d),k.prototype.name="polling",k.prototype.doOpen=function(){this.poll()},k.prototype.pause=function(a){function c(){i("paused"),b.readyState="paused",a()}var b=this;this.readyState="pausing";if(this.polling||!this.writable){var d=0;this.polling&&(i("we are currently polling - waiting to pause"),d++,this.once("pollComplete",function(){i("pre-pause polling complete"),--d||c()})),this.writable||(i("we are currently writing - waiting to pause"),d++,this.once("drain",function(){i("pre-pause writing complete"),--d||c()}))}else c()},k.prototype.poll=function(){i("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},k.prototype.onData=function(a){var b=this;i("polling got data %s",a);var c=function(a,c,d){"opening"===b.readyState&&b.onOpen();if("close"===a.type)return b.onClose(),!1;b.onPacket(a)};f.decodePayload(a,this.socket.binaryType,c),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():i('ignoring poll - transport state "%s"',this.readyState))},k.prototype.doClose=function(){function b(){i("writing close packet"),a.write([{type:"close"}])}var a=this;"open"===this.readyState?(i("transport open - closing"),b()):(i("transport not open - deferring close"),this.once("open",b))},k.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0,b.emit("drain")};f.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})},k.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";!1!==this.timestampRequests&&(a[this.timestampParam]=h()),!this.supportsBinary&&!a.sid&&(a.b64=1),a=e.encode(a),this.port&&("https"===b&&Number(this.port)!==443||"http"===b&&Number(this.port)!==80)&&(c=":"+this.port),a.length&&(a="?"+a);var d=this.hostname.indexOf(":")!==-1;return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a}},{100:100,101:101,114:114,154:154,86:86,87:87,94:94}],99:[function(a,b,c){((function(c){function n(a){var b=a&&a.forceBase64;b&&(this.supportsBinary=!1),this.perMessageDeflate=a.perMessageDeflate,this.usingBrowserWebSocket=j&&!a.forceNode,this.usingBrowserWebSocket||(m=k),d.call(this,a)}var d=a(94),e=a(101),f=a(114),g=a(86),h=a(154),i=a(87)("engine.io-client:websocket"),j=c.WebSocket||c.MozWebSocket,k;if(typeof window=="undefined")try{k=a(80)}catch(l){}var m=j;!m&&typeof window=="undefined"&&(m=k),b.exports=n,g(n,d),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(!this.check())return;var a=this.uri(),b=void 0,c={agent:this.agent,perMessageDeflate:this.perMessageDeflate};c.pfx=this.pfx,c.key=this.key,c.passphrase=this.passphrase,c.cert=this.cert,c.ca=this.ca,c.ciphers=this.ciphers,c.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(c.headers=this.extraHeaders),this.localAddress&&(c.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new m(a):new m(a,b,c)}catch(d){return this.emit("error",d)}this.ws.binaryType===undefined&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()},n.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(){a.onClose()},this.ws.onmessage=function(b){a.onData(b.data)},this.ws.onerror=function(b){a.onError("websocket error",b)}},n.prototype.write=function(a){function h(){b.emit("flush"),setTimeout(function(){b.writable=!0,b.emit("drain")},0)}var b=this;this.writable=!1;var d=a.length;for(var f=0,g=d;f<g;f++)(function(a){e.encodePacket(a,b.supportsBinary,function(e){if(!b.usingBrowserWebSocket){var f={};a.options&&(f.compress=a.options.compress);if(b.perMessageDeflate){var g="string"==typeof e?c.Buffer.byteLength(e):e.length;g<b.perMessageDeflate.threshold&&(f.compress=!1)}}try{b.usingBrowserWebSocket?b.ws.send(e):b.ws.send(e,f)}catch(j){i("websocket closed before onclose event")}--d||h()})})(a[f])},n.prototype.onClose=function(){d.prototype.onClose.call(this)},n.prototype.doClose=function(){typeof this.ws!="undefined"&&this.ws.close()},n.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"===b&&Number(this.port)!==443||"ws"===b&&Number(this.port)!==80)&&(c=":"+this.port),this.timestampRequests&&(a[this.timestampParam]=h()),this.supportsBinary||(a.b64=1),a=f.encode(a),a.length&&(a="?"+a);var d=this.hostname.indexOf(":")!==-1;return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a},n.prototype.check=function(){return!!m&&!("__initialize"in m&&this.name===n.prototype.name)}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{101:101,114:114,154:154,80:80,86:86,87:87,94:94}],100:[function(a,b,c){((function(c){var d=a(105);b.exports=function(a){var b=a.xdomain,e=a.xscheme,f=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(g){}try{if("undefined"!=typeof XDomainRequest&&!e&&f)return new XDomainRequest}catch(g){}if(!b)try{return new(c[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(g){}}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{105:105}],101:[function(a,b,c){((function(b){function q(a,b){var d="b"+c.packets[a.type]+a.data.data;return b(d)}function r(a,b,d){if(!b)return c.encodeBase64Packet(a,d);var e=a.data,f=new Uint8Array(e),g=new Uint8Array(1+e.byteLength);g[0]=m[a.type];for(var h=0;h<f.length;h++)g[h+1]=f[h];return d(g.buffer)}function s(a,b,d){if(!b)return c.encodeBase64Packet(a,d);var e=new FileReader;return e.onload=function(){a.data=e.result,c.encodePacket(a,b,!0,d)},e.readAsArrayBuffer(a.data)}function t(a,b,d){if(!b)return c.encodeBase64Packet(a,d);if(l)return s(a,b,d);var e=new Uint8Array(1);e[0]=m[a.type];var f=new p([e.buffer,a.data]);return d(f)}function u(a){try{a=h.decode(a)}catch(b){return!1}return a}function v(a,b,c){var d=new Array(a.length),e=g(a.length,c),f=function(a,c,e){b(c,function(b,c){d[a]=c,e(b,d)})};for(var h=0;h<a.length;h++)f(h,a[h],e)}var d=a(102),e=a(104),f=a(67),g=a(66),h=a(153),i;b&&b.ArrayBuffer&&(i=a(69));var j=typeof navigator!="undefined"&&/Android/i.test(navigator.userAgent),k=typeof navigator!="undefined"&&/PhantomJS/i.test(navigator.userAgent),l=j||k;c.protocol=3;var m=c.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},n=d(m),o={type:"error",data:"parser error"},p=a(72);c.encodePacket=function(a,c,d,e){"function"==typeof c&&(e=c,c=!1),"function"==typeof d&&(e=d,d=null);var f=a.data===undefined?undefined:a.data.buffer||a.data;if(b.ArrayBuffer&&f instanceof ArrayBuffer)return r(a,c,e);if(p&&f instanceof b.Blob)return t(a,c,e);if(f&&f.base64)return q(a,e);var g=m[a.type];return undefined!==a.data&&(g+=d?h.encode(String(a.data)):String(a.data)),e(""+g)},c.encodeBase64Packet=function(a,d){var e="b"+c.packets[a.type];if(p&&a.data instanceof b.Blob){var f=new FileReader;return f.onload=function(){var a=f.result.split(",")[1];d(e+a)},f.readAsDataURL(a.data)}var g;try{g=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(h){var i=new Uint8Array(a.data),j=new Array(i.length);for(var k=0;k<i.length;k++)j[k]=i[k];g=String.fromCharCode.apply(null,j)}return e+=b.btoa(g),d(e)},c.decodePacket=function(a,b,d){if(a===undefined)return o;if(typeof a=="string"){if(a.charAt(0)=="b")return c.decodeBase64Packet(a.substr(1),b);if(d){a=u(a);if(a===!1)return o}var e=a.charAt(0);return Number(e)!=e||!n[e]?o:a.length>1?{type:n[e],data:a.substring(1)}:{type:n[e]}}var g=new Uint8Array(a),e=g[0],h=f(a,1);return p&&b==="blob"&&(h=new p([h])),{type:n[e],data:h}},c.decodeBase64Packet=function(a,b){var c=n[a.charAt(0)];if(!i)return{type:c,data:{base64:!0,data:a.substr(1)}};var d=i.decode(a.substr(1));return b==="blob"&&p&&(d=new p([d])),{type:c,data:d}},c.encodePayload=function(a,b,d){function g(a){return a.length+":"+a}function h(a,d){c.encodePacket(a,f?b:!1,!0,function(a){d(null,g(a))})}typeof b=="function"&&(d=b,b=null);var f=e(a);if(b&&f)return p&&!l?c.encodePayloadAsBlob(a,d):c.encodePayloadAsArrayBuffer(a,d);if(!a.length)return d("0:");v(a,h,function(a,b){return d(b.join(""))})},c.decodePayload=function(a,b,d){if(typeof a!="string")return c.decodePayloadAsBinary(a,b,d);typeof b=="function"&&(d=b,b=null);var e;if(a=="")return d(o,0,1);var f="",g,h;for(var i=0,j=a.length;i<j;i++){var k=a.charAt(i);if(":"!=k)f+=k;else{if(""==f||f!=(g=Number(f)))return d(o,0,1);h=a.substr(i+1,g);if(f!=h.length)return d(o,0,1);if(h.length){e=c.decodePacket(h,b,!0);if(o.type==e.type&&o.data==e.data)return d(o,0,1);var l=d(e,i+g,j);if(!1===l)return}i+=g,f=""}}if(f!="")return d(o,0,1)},c.encodePayloadAsArrayBuffer=function(a,b){function d(a,b){c.encodePacket(a,!0,!0,function(a){return b(null,a)})}if(!a.length)return b(new ArrayBuffer(0));v(a,d,function(a,c){var d=c.reduce(function(a,b){var c;return typeof b=="string"?c=b.length:c=b.byteLength,a+c.toString().length+c+2},0),e=new Uint8Array(d),f=0;return c.forEach(function(a){var b=typeof a=="string",c=a;if(b){var d=new Uint8Array(a.length);for(var g=0;g<a.length;g++)d[g]=a.charCodeAt(g);c=d.buffer}b?e[f++]=0:e[f++]=1;var h=c.byteLength.toString();for(var g=0;g<h.length;g++)e[f++]=parseInt(h[g]);e[f++]=255;var d=new Uint8Array(c);for(var g=0;g<d.length;g++)e[f++]=d[g]}),b(e.buffer)})},c.encodePayloadAsBlob=function(a,b){function d(a,b){c.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);c[0]=1;if(typeof a=="string"){var d=new Uint8Array(a.length);for(var e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer,c[0]=0}var f=a instanceof ArrayBuffer?a.byteLength:a.size,g=f.toString(),h=new Uint8Array(g.length+1);for(var e=0;e<g.length;e++)h[e]=parseInt(g[e]);h[g.length]=255;if(p){var i=new p([c.buffer,h.buffer,a]);b(null,i)}})}v(a,d,function(a,c){return b(new p(c))})},c.decodePayloadAsBinary=function(a,b,d){typeof b=="function"&&(d=b,b=null);var e=a,g=[],h=!1;while(e.byteLength>0){var i=new Uint8Array(e),j=i[0]===0,k="";for(var l=1;;l++){if(i[l]==255)break;if(k.length>310){h=!0;break}k+=i[l]}if(h)return d(o,0,1);e=f(e,2+k.length),k=parseInt(k);var m=f(e,0,k);if(j)try{m=String.fromCharCode.apply(null,new Uint8Array(m))}catch(n){var p=new Uint8Array(m);m="";for(var l=0;l<p.length;l++)m+=String.fromCharCode(p[l])}g.push(m),e=f(e,k)}var q=g.length;g.forEach(function(a,e){d(c.decodePacket(a,b,!0),e,q)})}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{102:102,104:104,153:153,66:66,67:67,69:69,72:72}],102:[function(a,b,c){b.exports=Object.keys||function(b){var c=[],d=Object.prototype.hasOwnProperty;for(var e in b)d.call(b,e)&&c.push(e);return c}},{}],103:[function(a,b,c){function f(a){var b;return function(){return b||(b=d(a)),b()}}function g(a){for(var b in a)this[b]=a[b];if(this.speed<=0)throw new Error("speed must be non null positive.");if(typeof this.spawn!="function")throw new Error("spawn must be a function.");this.lastti=null}var d=a(126),e=2*Math.PI;g.prototype={spawn:function(a){console.log("NOT IMPLEMENTED: Spawner#spawn",a)},speed:1e3,count:1,rot:0,pos:[0,0],ang:0,vel:0,front:0,pattern:null,patternMask:null,initialTime:0,randPos:0,randAng:0,randVel:0,seed:"",maxCatchup:1e3,maxPerLoop:100},Object.defineProperty(g.prototype,"pattern",{set:function(a){this._pattern=a;if(a){var b=a.reduce(function(a,b){return a+Math.abs(b)},0),c=new Uint8Array(b),d=0;for(var e=0;e<a.length;++e){var f=a[e],g=f>0?1:0,h=Math.abs(f);for(var i=0;i<h;++i)c[d++]=g}this.patternMask=c}},get:function(){return this._pattern}}),g.prototype.init=function(a){var b=Math.floor((a-this.initialTime)/this.speed);if(this.patternMask){var c=b*this.count%this.patternMask.length;this._ip=c}this.lastti=b,this._headsRef=[];for(var d=0;d<this.count;++d)this._headsRef[d]={trigger:!1,angleFrom:0,angleTo:0,p:0}},g.prototype.getHeads=function(a){if(!this._headsRef)return[];var b=(a-this.initialTime)/this.speed,c=Math.floor(b),d=b-c,f=this._headstifrom===c;this._headstifrom=c;var g=this._headsRef;for(var h=0;h<this.count;++h){var i=g[h];if(!f){var j=this.count*c+h,k=j+this.count,l=!this.patternMask||this.patternMask[j%this.patternMask.length]!==0,m=(this.rot*j+this.ang+e)%e,n=(this.rot*k+this.ang+e)%e;m>n+Math.PI&&(m-=e),n>m+Math.PI&&(n-=e),i.trigger=l,i.angleFrom=m,i.angleTo=n}i.angle=i.angleFrom*(1-d)+i.angleTo*d,i.p=d}return g},g.prototype.update=function(a){this.lastti===null&&this.init(a);var b=Math.floor((a-this.initialTime)/this.speed),c=b-this.lastti;c>this.maxCatchup&&(console.log("Spawner: "+c+" entities to catchup. maximized to "+this.maxCatchup+" and lost some."),this.lastti=b-this.maxCatchup);for(var d=0;this.lastti<b&&d<this.maxPerLoop;++d){var e=++this.lastti,g=a-e*this.speed,h=f(this.seed+"@"+e);for(var i=0;i<this.count;++i){if(this.patternMask){var j=this.patternMask[this._ip]===0;this._ip=this._ip>=this.patternMask.length-1?0:this._ip+1;if(j)continue}var k=this.ang+this.randAng*(h()-.5)+this.rot*(this.count*e+i)%(2*Math.PI),l=[Math.cos(k),Math.sin(k)],m=this.vel+this.randVel*(h()-.5),n=[m*l[0],m*l[1]],o=[this.pos[0]+this.randPos*(h()-.5)+n[0]*g+this.front*l[0],this.pos[1]+this.randPos*(h()-.5)+n[1]*g+this.front*l[1]];this.spawn({random:h,timeIndex:e,countIndex:i,angle:k,position:o,velocity:n,direction:l})}}},b.exports=g},{126:126}],104:[function(a,b,c){((function(c){function e(a){function b(a){if(!a)return!1;if(c.Buffer&&c.Buffer.isBuffer&&c.Buffer.isBuffer(a)||c.ArrayBuffer&&a instanceof ArrayBuffer||c.Blob&&a instanceof Blob||c.File&&a instanceof File)return!0;if(d(a)){for(var e=0;e<a.length;e++)if(b(a[e]))return!0}else if(a&&"object"==typeof a){a.toJSON&&"function"==typeof a.toJSON&&(a=a.toJSON());for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)&&b(a[f]))return!0}return!1}return b(a)}var d=a(109);b.exports=e})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{109:109}],105:[function(a,b,c){try{b.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(d){b.exports=!1}},{}],106:[function(a,b,c){(function(){function o(){try{typeof AudioContext!="undefined"?a=new AudioContext:typeof webkitAudioContext!="undefined"?a=new webkitAudioContext:b=!1}catch(c){b=!1}if(!b)if(typeof Audio!="undefined")try{new Audio}catch(c){d=!0}else d=!0}"use strict";var a=null,b=!0,d=!1;o();if(b){var e=typeof a.createGain=="undefined"?a.createGainNode():a.createGain();e.gain.value=1,e.connect(a.destination)}var f=function(){this.init()};f.prototype={init:function(){var c=this||g;return c._codecs={},c._howls=[],c._muted=!1,c._volume=1,c.iOSAutoEnable=!0,c.noAudio=d,c.usingWebAudio=b,c.ctx=a,d||c._setupCodecs(),c},volume:function(a){var c=this||g;a=parseFloat(a);if(typeof a!="undefined"&&a>=0&&a<=1){c._volume=a,b&&(e.gain.value=a);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio){var f=c
._howls[d]._getSoundIds();for(var h=0;h<f.length;h++){var i=c._howls[d]._soundById(f[h]);i&&i._node&&(i._node.volume=i._volume*a)}}return c}return c._volume},mute:function(a){var c=this||g;c._muted=a,b&&(e.gain.value=a?0:c._volume);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio){var f=c._howls[d]._getSoundIds();for(var h=0;h<f.length;h++){var i=c._howls[d]._soundById(f[h]);i&&i._node&&(i._node.muted=a?!0:i._muted)}}return c},codecs:function(a){return(this||g)._codecs[a]},_setupCodecs:function(){var a=this||g,b=new Audio,c=b.canPlayType("audio/mpeg;").replace(/^no$/,"");return a._codecs={mp3:!!c||!!b.canPlayType("audio/mp3;").replace(/^no$/,""),mpeg:!!c,opus:!!b.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!b.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!b.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!b.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/m4a;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(b.canPlayType("audio/x-mp4;")||b.canPlayType("audio/mp4;")||b.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!b.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")},a},_enableiOSAudio:function(){var b=this||g;if(a&&(b._iOSEnabled||!/iPhone|iPad|iPod/i.test(navigator.userAgent)))return;b._iOSEnabled=!1;var c=function(){var d=a.createBuffer(1,1,22050),e=a.createBufferSource();e.buffer=d,e.connect(a.destination),typeof e.start=="undefined"?e.noteOn(0):e.start(0),setTimeout(function(){if(e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE)b._iOSEnabled=!0,b.iOSAutoEnable=!1,window.removeEventListener("touchstart",c,!1)},0)};return window.addEventListener("touchstart",c,!1),b}};var g=new f,h=function(a){var b=this;if(!a.src){console.error("An array of source files must be passed with any new Howl.");return}b.init(a)};h.prototype={init:function(c){var d=this;return d._autoplay=c.autoplay||!1,d._ext=c.ext||null,d._html5=c.html5||!1,d._muted=c.mute||!1,d._loop=c.loop||!1,d._pool=c.pool||5,d._preload=typeof c.preload=="boolean"?c.preload:!0,d._rate=c.rate||1,d._sprite=c.sprite||{},d._src=typeof c.src!="string"?c.src:[c.src],d._volume=c.volume!==undefined?c.volume:1,d._duration=0,d._loaded=!1,d._sounds=[],d._endTimers={},d._onend=c.onend?[{fn:c.onend}]:[],d._onfaded=c.onfaded?[{fn:c.onfaded}]:[],d._onload=c.onload?[{fn:c.onload}]:[],d._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[],d._onpause=c.onpause?[{fn:c.onpause}]:[],d._onplay=c.onplay?[{fn:c.onplay}]:[],d._webAudio=b&&!d._html5,typeof a!="undefined"&&a&&g.iOSAutoEnable&&g._enableiOSAudio(),g._howls.push(d),d._preload&&d.load(),d},load:function(){var a=this,b=null;if(d){a._emit("loaderror");return}typeof a._src=="string"&&(a._src=[a._src]);for(var c=0;c<a._src.length;c++){var e,f;a._ext&&a._ext[c]?e=a._ext[c]:(f=a._src[c],e=/^data:audio\/([^;,]+);/i.exec(f),e||(e=/\.([^.]+)$/.exec(f.split("?",1)[0])),e&&(e=e[1].toLowerCase()));if(g.codecs(e)){b=a._src[c];break}}if(!b){a._emit("loaderror");return}return a._src=b,new i(a),a._webAudio&&k(a),a},play:function(b){var c=this,d=null;if(typeof b=="number")d=b,b=null;else if(typeof b=="undefined"){b="__default";var e=0;for(var f=0;f<c._sounds.length;f++)c._sounds[f]._paused&&!c._sounds[f]._ended&&(e++,d=c._sounds[f]._id);e===1?b=null:d=null}var h=d?c._soundById(d):c._inactiveSound();if(!h)return null;d&&!b&&(b=h._sprite||"__default");if(!c._loaded&&!c._sprite[b])return c.once("load",function(){c.play(c._soundById(h._id)?h._id:undefined)}),h._id;if(d&&!h._paused)return h._id;var i=h._seek>0?h._seek:c._sprite[b][0]/1e3,j=(c._sprite[b][0]+c._sprite[b][1])/1e3-i,k=!!h._loop||!!c._sprite[b][2],l=function(){c._emit("end",h._id),!c._webAudio&&k&&c.stop(h._id).play(h._id),c._webAudio&&k&&(c._emit("play",h._id),h._seek=h._start||0,h._playStart=a.currentTime,c._endTimers[h._id]=setTimeout(l,(h._stop-h._start)*1e3/Math.abs(c._rate))),c._webAudio&&!k&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,c._clearTimer(h._id),h._node.bufferSource=null),!c._webAudio&&!k&&c.stop(h._id)};c._endTimers[h._id]=setTimeout(l,j*1e3/Math.abs(c._rate)),h._paused=!1,h._ended=!1,h._sprite=b,h._seek=i,h._start=c._sprite[b][0]/1e3,h._stop=(c._sprite[b][0]+c._sprite[b][1])/1e3,h._loop=k;var m=h._node;if(c._webAudio){var n=function(){c._refreshBuffer(h);var b=h._muted||c._muted?0:h._volume*g.volume();m.gain.setValueAtTime(b,a.currentTime),h._playStart=a.currentTime,typeof m.bufferSource.start=="undefined"?m.bufferSource.noteGrainOn(0,i,j):m.bufferSource.start(0,i,j),c._endTimers[h._id]||(c._endTimers[h._id]=setTimeout(l,j*1e3/Math.abs(c._rate))),setTimeout(function(){c._emit("play",h._id)},0)};c._loaded?n():(c.once("load",n),c._clearTimer(h._id))}else{var o=function(){m.currentTime=i,m.muted=h._muted||c._muted||g._muted||m.muted,m.volume=h._volume*g.volume(),m.playbackRate=c._rate,setTimeout(function(){m.play(),c._emit("play",h._id)},0)};if(m.readyState===4||!m.readyState&&navigator.isCocoonJS)o();else{var p=function(){c._endTimers[h._id]=setTimeout(l,j*1e3/Math.abs(c._rate)),o(),m.removeEventListener("canplaythrough",p,!1)};m.addEventListener("canplaythrough",p,!1),c._clearTimer(h._id)}}return h._id},pause:function(a){var b=this;if(!b._loaded)return b.once("play",function(){b.pause(a)}),b;var c=b._getSoundIds(a);for(var d=0;d<c.length;d++){b._clearTimer(c[d]);var e=b._soundById(c[d]);if(e&&!e._paused){e._seek=b.seek(c[d]),e._paused=!0;if(b._webAudio){if(!e._node.bufferSource)return b;typeof e._node.bufferSource.stop=="undefined"?e._node.bufferSource.noteOff(0):e._node.bufferSource.stop(0),e._node.bufferSource=null}else isNaN(e._node.duration)||e._node.pause();arguments[1]||b._emit("pause",e._id)}}return b},stop:function(a){var b=this;if(!b._loaded)return typeof b._sounds[0]._sprite!="undefined"&&b.once("play",function(){b.stop(a)}),b;var c=b._getSoundIds(a);for(var d=0;d<c.length;d++){b._clearTimer(c[d]);var e=b._soundById(c[d]);if(e&&!e._paused){e._seek=e._start||0,e._paused=!0,e._ended=!0;if(b._webAudio&&e._node){if(!e._node.bufferSource)return b;typeof e._node.bufferSource.stop=="undefined"?e._node.bufferSource.noteOff(0):e._node.bufferSource.stop(0),e._node.bufferSource=null}else e._node&&!isNaN(e._node.duration)&&(e._node.pause(),e._node.currentTime=e._start||0)}}return b},mute:function(b,c){var d=this;if(!d._loaded)return d.once("play",function(){d.mute(b,c)}),d;if(typeof c=="undefined"){if(typeof b!="boolean")return d._muted;d._muted=b}var e=d._getSoundIds(c);for(var f=0;f<e.length;f++){var h=d._soundById(e[f]);h&&(h._muted=b,d._webAudio&&h._node?h._node.gain.setValueAtTime(b?0:h._volume*g.volume(),a.currentTime):h._node&&(h._node.muted=g._muted?!0:b))}return d},volume:function(){var b=this,c=arguments,d,e;if(c.length===0)return b._volume;if(c.length===1){var f=b._getSoundIds(),h=f.indexOf(c[0]);h>=0?e=parseInt(c[0],10):d=parseFloat(c[0])}else c.length===2&&(d=parseFloat(c[0]),e=parseInt(c[1],10));var i;if(typeof d!="undefined"&&d>=0&&d<=1){if(!b._loaded)return b.once("play",function(){b.volume.apply(b,c)}),b;typeof e=="undefined"&&(b._volume=d),e=b._getSoundIds(e);for(var j=0;j<e.length;j++)i=b._soundById(e[j]),i&&(i._volume=d,b._webAudio&&i._node?i._node.gain.setValueAtTime(d*g.volume(),a.currentTime):i._node&&(i._node.volume=d*g.volume()));return b}return i=e?b._soundById(e):b._sounds[0],i?i._volume:0},fade:function(b,c,d,e){var f=this;if(!f._loaded)return f.once("play",function(){f.fade(b,c,d,e)}),f;f.volume(b,e);var g=f._getSoundIds(e);for(var h=0;h<g.length;h++){var i=f._soundById(g[h]);if(i)if(f._webAudio){var j=a.currentTime,k=j+d/1e3;i._volume=b,i._node.gain.setValueAtTime(b,j),i._node.gain.linearRampToValueAtTime(c,k),setTimeout(function(b,d){setTimeout(function(){d._volume=c,f._emit("faded",b)},k-a.currentTime>0?Math.ceil((k-a.currentTime)*1e3):0)}.bind(f,g[h],i),d)}else{var l=Math.abs(b-c),m=b>c?"out":"in",n=l/.01,o=d/n;(function(){var a=b,d=setInterval(function(b){a+=m==="in"?.01:-0.01,a=Math.max(0,a),a=Math.min(1,a),a=Math.round(a*100)/100,f.volume(a,b),a===c&&(clearInterval(d),f._emit("faded",b))}.bind(f,g[h]),o)})()}}return f},loop:function(){var a=this,b=arguments,c,d,e;if(b.length===0)return a._loop;if(b.length===1){if(typeof b[0]!="boolean")return e=a._soundById(parseInt(b[0],10)),e?e._loop:!1;c=b[0],a._loop=c}else b.length===2&&(c=b[0],d=parseInt(b[1],10));var f=a._getSoundIds(d);for(var g=0;g<f.length;g++)e=a._soundById(f[g]),e&&(e._loop=c);return a},seek:function(){var b=this,c=arguments,d,e;if(c.length===0)e=b._sounds[0]._id;else if(c.length===1){var f=b._getSoundIds(),g=f.indexOf(c[0]);g>=0?e=parseInt(c[0],10):(e=b._sounds[0]._id,d=parseFloat(c[0]))}else c.length===2&&(d=parseFloat(c[0]),e=parseInt(c[1],10));if(typeof e=="undefined")return b;if(!b._loaded)return b.once("load",function(){b.seek.apply(b,c)}),b;var h=b._soundById(e);if(h){if(!(d>=0))return b._webAudio?h._seek+(a.currentTime-h._playStart):h._node.currentTime;var i=b.playing(e);i&&b.pause(e,!0),h._seek=d,b._clearTimer(e),i&&b.play(e)}return b},playing:function(a){var b=this,c=b._soundById(a)||b._sounds[0];return c?!c._paused:!1},duration:function(){return this._duration},unload:function(){var a=this,b=a._sounds;for(var c=0;c<b.length;c++){b[c]._paused||(a.stop(b[c]._id),a._emit("end",b[c]._id)),a._webAudio||(b[c]._node.src="",b[c]._node.removeEventListener("error",b[c]._errorFn,!1),b[c]._node.removeEventListener("canplaythrough",b[c]._loadFn,!1)),delete b[c]._node,a._clearTimer(b[c]._id);var d=g._howls.indexOf(a);d>=0&&g._howls.splice(d,1)}return j&&delete j[a._src],a=null,null},on:function(a,b,c){var d=this,e=d["_on"+a];return typeof b=="function"&&e.push({id:c,fn:b}),d},off:function(a,b,c){var d=this,e=d["_on"+a];if(b){for(var f=0;f<e.length;f++)if(b===e[f].fn&&c===e[f].id){e.splice(f,1);break}}else e=[];return d},once:function(a,b,c){var d=this,e=function(){b.apply(d,arguments),d.off(a,e,c)};return d.on(a,e,c),d},_emit:function(a,b,c){var d=this,e=d["_on"+a];for(var f=0;f<e.length;f++)(!e[f].id||e[f].id===b)&&setTimeout(function(a){a.call(this,b,c)}.bind(d,e[f].fn),0);return d},_clearTimer:function(a){var b=this;return b._endTimers[a]&&(clearTimeout(b._endTimers[a]),delete b._endTimers[a]),b},_soundById:function(a){var b=this;for(var c=0;c<b._sounds.length;c++)if(a===b._sounds[c]._id)return b._sounds[c];return null},_inactiveSound:function(){var a=this;a._drain();for(var b=0;b<a._sounds.length;b++)if(a._sounds[b]._ended)return a._sounds[b].reset();return new i(a)},_drain:function(){var a=this,b=a._pool,c=0,d=0;if(a._sounds.length<b)return;for(d=0;d<a._sounds.length;d++)a._sounds[d]._ended&&c++;for(d=a._sounds.length-1;d>=0;d--){if(c<=b)return;a._sounds[d]._ended&&(a._webAudio&&a._sounds[d]._node&&a._sounds[d]._node.disconnect(0),a._sounds.splice(d,1),c--)}},_getSoundIds:function(a){var b=this;if(typeof a=="undefined"){var c=[];for(var d=0;d<b._sounds.length;d++)c.push(b._sounds[d]._id);return c}return[a]},_refreshBuffer:function(b){var c=this;return b._node.bufferSource=a.createBufferSource(),b._node.bufferSource.buffer=j[c._src],b._panner?b._node.bufferSource.connect(b._panner):b._node.bufferSource.connect(b._node),b._node.bufferSource.loop=b._loop,b._loop&&(b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop),b._node.bufferSource.playbackRate.value=c._rate,c}};var i=function(a){this._parent=a,this.init()};i.prototype={init:function(){var a=this,b=a._parent;return a._muted=b._muted,a._loop=b._loop,a._volume=b._volume,a._muted=b._muted,a._seek=0,a._paused=!0,a._ended=!0,a._id=Math.round(Date.now()*Math.random()),b._sounds.push(a),a.create(),a},create:function(){var b=this,c=b._parent,d=g._muted||b._muted||b._parent._muted?0:b._volume*g.volume();return c._webAudio?(b._node=typeof a.createGain=="undefined"?a.createGainNode():a.createGain(),b._node.gain.setValueAtTime(d,a.currentTime),b._node.paused=!0,b._node.connect(e)):(b._node=new Audio,b._errorFn=b._errorListener.bind(b),b._node.addEventListener("error",b._errorFn,!1),b._loadFn=b._loadListener.bind(b),b._node.addEventListener("canplaythrough",b._loadFn,!1),b._node.src=c._src,b._node.preload="auto",b._node.volume=d,b._node.load()),b},reset:function(){var a=this,b=a._parent;return a._muted=b._muted,a._loop=b._loop,a._volume=b._volume,a._muted=b._muted,a._seek=0,a._paused=!0,a._ended=!0,a._sprite=null,a._id=Math.round(Date.now()*Math.random()),a},_errorListener:function(){var a=this;a._node.error&&a._node.error.code===4&&(g.noAudio=!0),a._parent._emit("loaderror",a._id,a._node.error?a._node.error.code:0),a._node.removeEventListener("error",a._errorListener,!1)},_loadListener:function(){var a=this,b=a._parent;b._duration=Math.ceil(a._node.duration*10)/10,Object.keys(b._sprite).length===0&&(b._sprite={__default:[0,b._duration*1e3]}),b._loaded||(b._loaded=!0,b._emit("load")),b._autoplay&&b.play(),a._node.removeEventListener("canplaythrough",a._loadListener,!1)}};if(b)var j={},k=function(a){var b=a._src;if(j[b]){a._duration=j[b].duration,n(a);return}if(/^data:[^;]+;base64,/.test(b)){window.atob=window.atob||function(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=String(a).replace(/=+$/,"");for(var d=0,e,f,g=0,h="";f=c.charAt(g++);~f&&(e=d%4?e*64+f:f,d++%4)?h+=String.fromCharCode(255&e>>(-2*d&6)):0)f=b.indexOf(f);return h};var c=atob(b.split(",")[1]),d=new Uint8Array(c.length);for(var e=0;e<c.length;++e)d[e]=c.charCodeAt(e);m(d.buffer,a)}else{var f=new XMLHttpRequest;f.open("GET",b,!0),f.responseType="arraybuffer",f.onload=function(){m(f.response,a)},f.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete j[b],a.load())},l(f)}},l=function(a){try{a.send()}catch(b){a.onerror()}},m=function(b,c){a.decodeAudioData(b,function(a){a&&(j[c._src]=a,n(c,a))},function(){c._emit("loaderror")})},n=function(a,b){b&&!a._duration&&(a._duration=b.duration),Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._loaded||(a._loaded=!0,a._emit("load")),a._autoplay&&a.play()};typeof define=="function"&&define.amd&&define("howler",function(){return{Howler:g,Howl:h}}),typeof c!="undefined"&&(c.Howler=g,c.Howl=h),typeof window!="undefined"&&(window.HowlerGlobal=f,window.Howler=g,window.Howl=h,window.Sound=i)})(),function(){"use strict",HowlerGlobal.prototype.init=function(a){return function(){var b=this;return b._pos=[0,0,0],b._orientation=[0,0,-1,0,1,0],b._velocity=[0,0,0],b._listenerAttr={dopplerFactor:1,speedOfSound:343.3},a.call(this,o)}}(HowlerGlobal.prototype.init),HowlerGlobal.prototype.pos=function(a,b,c){var d=this;return!d.ctx||!d.ctx.listener?d:(b=typeof b!="number"?d._pos[1]:b,c=typeof c!="number"?d._pos[2]:c,typeof a!="number"?d._pos:(d._pos=[a,b,c],d.ctx.listener.setPosition(d._pos[0],d._pos[1],d._pos[2]),d))},HowlerGlobal.prototype.orientation=function(a,b,c,d,e,f){var g=this;if(!g.ctx||!g.ctx.listener)return g;var h=g._orientation;return b=typeof b!="number"?h[1]:b,c=typeof c!="number"?h[2]:c,d=typeof d!="number"?h[3]:d,e=typeof e!="number"?h[4]:e,f=typeof f!="number"?h[5]:f,typeof a!="number"?h:(g._orientation=[a,b,c,d,e,f],g.ctx.listener.setOrientation(h[0],h[1],h[2],h[3],h[4],h[5]),g)},HowlerGlobal.prototype.velocity=function(a,b,c){var d=this;return!d.ctx||!d.ctx.listener?d:(b=typeof b!="number"?d._velocity[1]:b,c=typeof c!="number"?d._velocity[2]:c,typeof a!="number"?d._velocity:(d._velocity=[a,b,c],d))},HowlerGlobal.prototype.listenerAttr=function(a){var b=this;if(!b.ctx||!b.ctx.listener)return b;var c=b._listenerAttr;return a?(b._listenerAttr={dopplerFactor:typeof a.dopplerFactor!="undefined"?a.dopplerFactor:c.dopplerFactor,speedOfSound:typeof a.speedOfSound!="undefined"?a.speedOfSound:c.speedOfSound},b.ctx.listener.dopplerFactor=c.dopplerFactor,b.ctx.listener.speedOfSound=c.speedOfSound,b):c},Howl.prototype.init=function(a){return function(b){var c=this;return c._orientation=b.orientation||[1,0,0],c._pos=b.pos||null,c._velocity=b.velocity||[0,0,0],c._pannerAttr={coneInnerAngle:typeof b.coneInnerAngle!="undefined"?b.coneInnerAngle:360,coneOUterAngle:typeof b.coneOUterAngle!="undefined"?b.coneOUterAngle:360,coneOuterGain:typeof b.coneOuterGain!="undefined"?b.coneOuterGain:0,distanceModel:typeof b.distanceModel!="undefined"?b.distanceModel:"inverse",maxDistance:typeof b.maxDistance!="undefined"?b.maxDistance:1e4,panningModel:typeof b.panningModel!="undefined"?b.panningModel:"HRTF",refDistance:typeof b.refDistance!="undefined"?b.refDistance:1,rolloffFactor:typeof b.rolloffFactor!="undefined"?b.rolloffFactor:1},a.call(this,b)}}(Howl.prototype.init),Howl.prototype.pos=function(b,c,d,e){var f=this;if(!f._webAudio)return f;if(!f._loaded)return f.once("play",function(){f.pos(b,c,d,e)}),f;c=typeof c!="number"?0:c,d=typeof d!="number"?-0.5:d;if(typeof e=="undefined"){if(typeof b!="number")return f._pos;f._pos=[b,c,d]}var g=f._getSoundIds(e);for(var h=0;h<g.length;h++){var i=f._soundById(g[h]);if(i){if(typeof b!="number")return i._pos;i._pos=[b,c,d],i._node&&(i._panner||a(i),i._panner.setPosition(b,c,d))}}return f},Howl.prototype.orientation=function(b,c,d,e){var f=this;if(!f._webAudio)return f;if(!f._loaded)return f.once("play",function(){f.orientation(b,c,d,e)}),f;c=typeof c!="number"?f._orientation[1]:c,d=typeof d!="number"?f._orientation[1]:d;if(typeof e=="undefined"){if(typeof b!="number")return f._orientation;f._orientation=[b,c,d]}var g=f._getSoundIds(e);for(var h=0;h<g.length;h++){var i=f._soundById(g[h]);if(i){if(typeof b!="number")return i._orientation;i._orientation=[b,c,d],i._node&&(i._panner||a(i),i._panner.setOrientation(b,c,d))}}return f},Howl.prototype.velocity=function(b,c,d,e){var f=this;if(!f._webAudio)return f;if(!f._loaded)return f.once("play",function(){f.velocity(b,c,d,e)}),f;c=typeof c!="number"?f._velocity[1]:c,d=typeof d!="number"?f._velocity[1]:d;if(typeof e=="undefined"){if(typeof b!="number")return f._velocity;f._velocity=[b,c,d]}var g=f._getSoundIds(e);for(var h=0;h<g.length;h++){var i=f._soundById(g[h]);if(i){if(typeof b!="number")return i._velocity;i._velocity=[b,c,d],i._node&&(i._panner||a(i))}}return f},Howl.prototype.pannerAttr=function(){var b=this,c=arguments,d,e,f;if(!b._webAudio)return b;if(c.length===0)return b._pannerAttr;if(c.length===1){if(typeof c[0]!="object")return f=b._soundById(parseInt(c[0],10)),f?f._pannerAttr:b._pannerAttr;d=c[0],typeof e=="undefined"&&(b._pannerAttr={coneInnerAngle:typeof d.coneInnerAngle!="undefined"?d.coneInnerAngle:b._coneInnerAngle,coneOUterAngle:typeof d.coneOUterAngle!="undefined"?d.coneOUterAngle:b._coneOUterAngle,coneOuterGain:typeof d.coneOuterGain!="undefined"?d.coneOuterGain:b._coneOuterGain,distanceModel:typeof d.distanceModel!="undefined"?d.distanceModel:b._distanceModel,maxDistance:typeof d.maxDistance!="undefined"?d.maxDistance:b._maxDistance,panningModel:typeof d.panningModel!="undefined"?d.panningModel:b._panningModel,refDistance:typeof d.refDistance!="undefined"?d.refDistance:b._refDistance,rolloffFactor:typeof d.rolloffFactor!="undefined"?d.rolloffFactor:b._rolloffFactor})}else c.length===2&&(d=c[0],e=parseInt(c[1],10));var g=b._getSoundIds(e);for(var h=0;h<g.length;h++){f=b._soundById(g[h]);if(f){var i=f._pannerAttr;i={coneInnerAngle:typeof d.coneInnerAngle!="undefined"?d.coneInnerAngle:i.coneInnerAngle,coneOUterAngle:typeof d.coneOUterAngle!="undefined"?d.coneOUterAngle:i.coneOUterAngle,coneOuterGain:typeof d.coneOuterGain!="undefined"?d.coneOuterGain:i.coneOuterGain,distanceModel:typeof d.distanceModel!="undefined"?d.distanceModel:i.distanceModel,maxDistance:typeof d.maxDistance!="undefined"?d.maxDistance:i.maxDistance,panningModel:typeof d.panningModel!="undefined"?d.panningModel:i.panningModel,refDistance:typeof d.refDistance!="undefined"?d.refDistance:i.refDistance,rolloffFactor:typeof d.rolloffFactor!="undefined"?d.rolloffFactor:i.rolloffFactor};var j=f._panner;j?(j.coneInnerAngle=i.coneInnerAngle,j.coneOUterAngle=i.coneOUterAngle,j.coneOuterGain=i.coneOuterGain,j.distanceModel=i.distanceModel,j.maxDistance=i.maxDistance,j.panningModel=i.panningModel,j.refDistance=i.refDistance,j.rolloffFactor=i.rolloffFactor):(f._pos||(f._pos=b._pos||[0,0,-0.5]),a(f))}}return b},Sound.prototype.init=function(a){return function(){var b=this,c=b._parent;b._orientation=c._orientation,b._pos=c._pos,b._velocity=c._velocity,b._pannerAttr=c._pannerAttr,a.call(this),b._pos&&c.pos(b._pos[0],b._pos[1],b._pos[2],b._id)}}(Sound.prototype.init),Sound.prototype.reset=function(a){return function(){var b=this,c=b._parent;return b._orientation=c._orientation,b._pos=c._pos,b._velocity=c._velocity,b._pannerAttr=c._pannerAttr,a.call(this)}}(Sound.prototype.reset);var a=function(a){a._panner=Howler.ctx.createPanner(),a._panner.coneInnerAngle=a._pannerAttr.coneInnerAngle,a._panner.coneOUterAngle=a._pannerAttr.coneOUterAngle,a._panner.coneOuterGain=a._pannerAttr.coneOuterGain,a._panner.distanceModel=a._pannerAttr.distanceModel,a._panner.maxDistance=a._pannerAttr.maxDistance,a._panner.panningModel=a._pannerAttr.panningModel,a._panner.refDistance=a._pannerAttr.refDistance,a._panner.rolloffFactor=a._pannerAttr.rolloffFactor,a._panner.setPosition(a._pos[0],a._pos[1],a._pos[2]),a._panner.setOrientation(a._orientation[0],a._orientation[1],a._orientation[2]),a._panner.connect(a._node),a._paused||a._parent.pause(a._id).play(a._id)}}()},{}],107:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=e*8-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;for(;k>0;f=f*256+a[b+l],l+=m,k-=8);g=f&(1<<-k)-1,f>>=-k,k+=d;for(;k>0;g=g*256+a[b+l],l+=m,k-=8);if(f===0)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*Infinity;g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=f*8-e-1,k=(1<<j)-1,l=k>>1,m=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||b===0&&1/b<0?1:0;b=Math.abs(b),isNaN(b)||b===Infinity?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?b+=m/i:b+=m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));for(;e>=8;a[c+n]=h&255,n+=o,h/=256,e-=8);g=g<<e|h,j+=e;for(;j>0;a[c+n]=g&255,n+=o,g/=256,j-=8);a[c+n-o]|=p*128}},{}],108:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],109:[function(a,b,c){b.exports=Array.isArray||function(a){return Object.prototype.toString.call(a)=="[object Array]"}},{}],110:[function(a,b,c){function d(){this.setSettings=function(a){for(var b=0;b<24;b++)this[String.fromCharCode(97+b)]=a[b]||0;this.c<.01&&(this.c=.01);var c=this.b+this.c+this.e;if(c<.18){var d=.18/c;this.b*=d,this.c*=d,this.e*=d}}}function e(){this._params=new d;var a,b,c,e,f,g,h,i,j,k,l,m;this.reset=function(){var a=this._params;e=100/(a.f*a.f+.001),f=100/(a.g*a.g+.001),g=1-a.h*a.h*a.h*.01,h=-a.i*a.i*a.i*1e-6,a.a||(l=.5-a.n/2,m=-a.o*5e-5),i=1+a.l*a.l*(a.l>0?-0.9:10),j=0,k=a["m"]==1?0:(1-a.m)*(1-a.m)*2e4+32},this.totalReset=function(){this.reset();var d=this._params;return a=d.b*d.b*1e5,b=d.c*d.c*1e5,c=d.e*d.e*1e5+12,((a+b+c)/3|0)*3},this.synthWave=function(d,n){var o=this._params,p=o["s"]!=1||o.v,q=o.v*o.v*.1,r=1+o.w*3e-4,s=o.s*o.s*o.s*.1,t=1+o.t*1e-4,u=o["s"]!=1,v=o.x*o.x,w=o.g,x=o.q||o.r,y=o.r*o.r*o.r*.2,z=o.q*o.q*(o.q<0?-1020:1020),A=o.p?((1-o.p)*(1-o.p)*2e4|0)+32:0,B=o.d,C=o.j/2,D=o.k*o.k*.01,E=o.a,F=a,G=1/a,H=1/b,I=1/c,J=5/(1+o.u*o.u*20)*(.01+s);J>.8&&(J=.8),J=1-J;var K=!1,L=0,M=0,N=0,O=0,P=0,Q,R=0,S,T=0,U,V=0,W,X=0,Y,Z,$=0,_=new Array(1024),ba=new Array(32);for(var bb=_.length;bb--;)_[bb]=0;for(var bb=ba.length;bb--;)ba[bb]=Math.random()*2-1;for(var bb=0;bb<n;bb++){if(K)return bb;A&&++X>=A&&(X=0,this.reset()),k&&++j>=k&&(k=0,e*=i),g+=h,e*=g,e>f&&(e=f,w>0&&(K=!0)),S=e,C>0&&($+=D,S*=1+Math.sin($)*C),S|=0,S<8&&(S=8),E||(l+=m,l<0?l=0:l>.5&&(l=.5));if(++M>F){M=0;switch(++L){case 1:F=b;break;case 2:F=c}}switch(L){case 0:N=M*G;break;case 1:N=1+(1-M*H)*2*B;break;case 2:N=1-M*I;break;case 3:N=0,K=!0}x&&(z+=y,U=z|0,U<0?U=-U:U>1023&&(U=1023)),p&&r&&(q*=r,q<1e-5?q=1e-5:q>.1&&(q=.1)),Z=0;for(var bc=8;bc--;){T++;if(T>=S){T%=S;if(E==3)for(var bd=ba.length;bd--;)ba[bd]=Math.random()*2-1}switch(E){case 0:Y=T/S<l?.5:-0.5;break;case 1:Y=1-T/S*2;break;case 2:W=T/S,W=(W>.5?W-1:W)*6.28318531,Y=1.27323954*W+.405284735*W*W*(W<0?1:-1),Y=.225*((Y<0?-1:1)*Y*Y-Y)+Y;break;case 3:Y=ba[Math.abs(T*32/S|0)]}p&&(Q=R,s*=t,s<0?s=0:s>.1&&(s=.1),u?(P+=(Y-R)*s,P*=J):(R=Y,P=0),R+=P,O+=R-Q,O*=1-q,Y=O),x&&(_[V%1024]=Y,Y+=_[(V-U+1024)%1024],V++),Z+=Y}Z*=.125*N*v,d[bb]=Z>=1?32767:Z<=-1?-32768:Z*32767|0}return n}}var f=new e,g=function(a){f._params.setSettings(a);var b=f.totalReset(),c=new Uint8Array(((b+1)/2|0)*4+44),d=f.synthWave(new Uint16Array(c.buffer,44),b)*2,e=new Uint32Array(c.buffer,0,44);e[0]=1179011410,e[1]=d+36,e[2]=1163280727,e[3]=544501094,e[4]=16,e[5]=65537,e[6]=44100,e[7]=88200,e[8]=1048578,e[9]=1635017060,e[10]=d,d+=44;var g=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="data:audio/wav;base64,";for(;g<d;g+=3){var j=c[g]<<16|c[g+1]<<8|c[g+2];i+=h[j>>18]+h[j>>12&63]+h[j>>6&63]+h[j&63]}return i};typeof a=="function"?b.exports=g:this.jsfxr=g},{}],111:[function(a,b,c){((function(a){((function(){function i(a,b){function u(a){if(u[a]!==r)return u[a];var e;if(a=="bug-string-char-index")e="a"[0]!="a";else if(a=="json")e=u("json-stringify")&&u("json-parse");else{var f,g='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(a=="json-stringify"){var i=b.stringify,j=typeof i=="function"&&s;if(j){(f=function(){return 1}).toJSON=f;try{j=i(0)==="0"&&i(new c)==="0"&&i(new d)=='""'&&i(o)===r&&i(r)===r&&i()===r&&i(f)==="1"&&i([f])=="[1]"&&i([r])=="[null]"&&i(null)=="null"&&i([r,o,null])=="[null,null,null]"&&i({a:[f,true,false,null,"\0\b\n\f\r\t"]})==g&&i(null,f)==="1"&&i([1,2],null,1)=="[\n 1,\n 2\n]"&&i(new h(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&i(new h(864e13))=='"+275760-09-13T00:00:00.000Z"'&&i(new h(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&i(new h(-1))=='"1969-12-31T23:59:59.999Z"'}catch(k){j=!1}}e=j}if(a=="json-parse"){var l=b.parse;if(typeof l=="function")try{if(l("0")===0&&!l(!1)){f=l(g);var m=f["a"].length==5&&f.a[0]===1;if(m){try{m=!l('"\t"')}catch(k){}if(m)try{m=l("01")!==1}catch(k){}if(m)try{m=l("1.")!==1}catch(k){}}}}catch(k){m=!1}e=m}}return u[a]=!!e}a||(a=g.Object()),b||(b=g.Object());var c=a.Number||g.Number,d=a.String||g.String,f=a.Object||g.Object,h=a.Date||g.Date,j=a.SyntaxError||g.SyntaxError,k=a.TypeError||g.TypeError,l=a.Math||g.Math,m=a.JSON||g.JSON;typeof m=="object"&&m&&(b.stringify=m.stringify,b.parse=m.parse);var n=f.prototype,o=n.toString,p,q,r,s=new h(-0xc782b5b800cec);try{s=s.getUTCFullYear()==-109252&&s.getUTCMonth()===0&&s.getUTCDate()===1&&s.getUTCHours()==10&&s.getUTCMinutes()==37&&s.getUTCSeconds()==6&&s.getUTCMilliseconds()==708}catch(t){}if(!u("json")){var v="[object Function]",w="[object Date]",x="[object Number]",y="[object String]",z="[object Array]",A="[object Boolean]",B=u("bug-string-char-index");if(!s)var C=l.floor,D=[0,31,59,90,120,151,181,212,243,273,304,334],E=function(a,b){return D[b]+365*(a-1970)+C((a-1969+(b=+(b>1)))/4)-C((a-1901+b)/100)+C((a-1601+b)/400)};(p=n.hasOwnProperty)||(p=function(a){var b={},c;return(b.__proto__=null,b.__proto__={toString:1},b).toString!=o?p=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(c=b.constructor,p=function(a){var b=(this.constructor||c).prototype;return a in this&&!(a in b&&this[a]===b[a])}),b=null,p.call(this,a)}),q=function(a,b){var c=0,d,f,g;(d=function(){this.valueOf=0}).prototype.valueOf=0,f=new d;for(g in f)p.call(f,g)&&c++;return d=f=null,c?c==2?q=function(a,b){var c={},d=o.call(a)==v,e;for(e in a)(!d||e!="prototype")&&!p.call(c,e)&&(c[e]=1)&&p.call(a,e)&&b(e)}:q=function(a,b){var c=o.call(a)==v,d,e;for(d in a)(!c||d!="prototype")&&p.call(a,d)&&!(e=d==="constructor")&&b(d);(e||p.call(a,d="constructor"))&&b(d)}:(f=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],q=function(a,b){var c=o.call(a)==v,d,g,h=!c&&typeof a.constructor!="function"&&e[typeof a.hasOwnProperty]&&a.hasOwnProperty||p;for(d in a)(!c||d!="prototype")&&h.call(a,d)&&b(d);for(g=f.length;d=f[--g];h.call(a,d)&&b(d));}),q(a,b)};if(!u("json-stringify")){var F={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},G="000000",H=function(a,b){return(G+(b||0)).slice(-a)},I="\\u00",J=function(a){var b='"',c=0,d=a.length,e=!B||d>10,f=e&&(B?a.split(""):a);for(;c<d;c++){var g=a.charCodeAt(c);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=F[g];break;default:if(g<32){b+=I+H(2,g.toString(16));break}b+=e?f[c]:a.charAt(c)}}return b+'"'},K=function(a,b,c,d,e,f,g){var h,i,j,l,m,n,s,t,u,v,B,D,F,G,I,L;try{h=b[a]}catch(M){}if(typeof h=="object"&&h){i=o.call(h);if(i==w&&!p.call(h,"toJSON"))if(h>-1/0&&h<1/0){if(E){m=C(h/864e5);for(j=C(m/365.2425)+1970-1;E(j+1,0)<=m;j++);for(l=C((m-E(j,0))/30.42);E(j,l+1)<=m;l++);m=1+m-E(j,l),n=(h%864e5+864e5)%864e5,s=C(n/36e5)%24,t=C(n/6e4)%60,u=C(n/1e3)%60,v=n%1e3}else j=h.getUTCFullYear(),l=h.getUTCMonth(),m=h.getUTCDate(),s=h.getUTCHours(),t=h.getUTCMinutes(),u=h.getUTCSeconds(),v=h.getUTCMilliseconds();h=(j<=0||j>=1e4?(j<0?"-":"+")+H(6,j<0?-j:j):H(4,j))+"-"+H(2,l+1)+"-"+H(2,m)+"T"+H(2,s)+":"+H(2,t)+":"+H(2,u)+"."+H(3,v)+"Z"}else h=null;else typeof h.toJSON=="function"&&(i!=x&&i!=y&&i!=z||p.call(h,"toJSON"))&&(h=h.toJSON(a))}c&&(h=c.call(b,a,h));if(h===null)return"null";i=o.call(h);if(i==A)return""+h;if(i==x)return h>-1/0&&h<1/0?""+h:"null";if(i==y)return J(""+h);if(typeof h=="object"){for(G=g.length;G--;)if(g[G]===h)throw k();g.push(h),B=[],I=f,f+=e;if(i==z){for(F=0,G=h.length;F<G;F++)D=K(F,h,c,d,e,f,g),B.push(D===r?"null":D);L=B.length?e?"[\n"+f+B.join(",\n"+f)+"\n"+I+"]":"["+B.join(",")+"]":"[]"}else q(d||h,function(a){var b=K(a,h,c,d,e,f,g);b!==r&&B.push(J(a)+":"+(e?" ":"")+b)}),L=B.length?e?"{\n"+f+B.join(",\n"+f)+"\n"+I+"}":"{"+B.join(",")+"}":"{}";return g.pop(),L}};b.stringify=function(a,b,c){var d,f,g,h;if(e[typeof b]&&b)if((h=o.call(b))==v)f=b;else if(h==z){g={};for(var i=0,j=b.length,k;i<j;k=b[i++],(h=o.call(k),h==y||h==x)&&(g[k]=1));}if(c)if((h=o.call(c))==x){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else h==y&&(d=c.length<=10?c:c.slice(0,10));return K("",(k={},k[""]=a,k),f,g,d,"",[])}}if(!u("json-parse")){var L=d.fromCharCode,M={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},N,O,P=function(){throw N=O=null,j()},Q=function(){var a=O,b=a.length,c,d,e,f,g;while(N<b){g=a.charCodeAt(N);switch(g){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return c=B?a.charAt(N):a[N],N++,c;case 34:for(c="@",N++;N<b;){g=a.charCodeAt(N);if(g<32)P();else if(g==92){g=a.charCodeAt(++N);switch(g){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:c+=M[g],N++;break;case 117:d=++N;for(e=N+4;N<e;N++)g=a.charCodeAt(N),g>=48&&g<=57||g>=97&&g<=102||g>=65&&g<=70||P();c+=L("0x"+a.slice(d,N));break;default:P()}}else{if(g==34)break;g=a.charCodeAt(N),d=N;while(g>=32&&g!=92&&g!=34)g=a.charCodeAt(++N);c+=a.slice(d,N)}}if(a.charCodeAt(N)==34)return N++,c;P();default:d=N,g==45&&(f=!0,g=a.charCodeAt(++N));if(g>=48&&g<=57){g==48&&(g=a.charCodeAt(N+1),g>=48&&g<=57)&&P(),f=!1;for(;N<b&&(g=a.charCodeAt(N),g>=48&&g<=57);N++);if(a.charCodeAt(N)==46){e=++N;for(;e<b&&(g=a.charCodeAt(e),g>=48&&g<=57);e++);e==N&&P(),N=e}g=a.charCodeAt(N);if(g==101||g==69){g=a.charCodeAt(++N),(g==43||g==45)&&N++;for(e=N;e<b&&(g=a.charCodeAt(e),g>=48&&g<=57);e++);e==N&&P(),N=e}return+a.slice(d,N)}f&&P();if(a.slice(N,N+4)=="true")return N+=4,!0;if(a.slice(N,N+5)=="false")return N+=5,!1;if(a.slice(N,N+4)=="null")return N+=4,null;P()}}return"$"},R=function(a){var b,c;a=="$"&&P();if(typeof a=="string"){if((B?a.charAt(0):a[0])=="@")return a.slice(1);if(a=="["){b=[];for(;;c||(c=!0)){a=Q();if(a=="]")break;c&&(a==","?(a=Q(),a=="]"&&P()):P()),a==","&&P(),b.push(R(a))}return b}if(a=="{"){b={};for(;;c||(c=!0)){a=Q();if(a=="}")break;c&&(a==","?(a=Q(),a=="}"&&P()):P()),(a==","||typeof a!="string"||(B?a.charAt(0):a[0])!="@"||Q()!=":")&&P(),b[a.slice(1)]=R(Q())}return b}P()}return a},S=function(a,b,c){var d=T(a,b,c);d===r?delete a[b]:a[b]=d},T=function(a,b,c){var d=a[b],e;if(typeof d=="object"&&d)if(o.call(d)==z)for(e=d.length;e--;)S(d,e,c);else q(d,function(a){S(d,a,c)});return c.call(a,b,d)};b.parse=function(a,b){var c,d;return N=0,O=""+a,c=R(Q()),Q()!="$"&&P(),N=O=null,b&&o.call(b)==v?T((d={},d[""]=c,d),"",b):c}}}return b.runInContext=i,b}var d=typeof define=="function"&&define.amd,e={"function":!0,object:!0},f=e[typeof c]&&c&&!c.nodeType&&c,g=e[typeof window]&&window||this,h=f&&e[typeof b]&&b&&!b.nodeType&&typeof a=="object"&&a;h&&(h.global===
h||h.window===h||h.self===h)&&(g=h);if(f&&!d)i(g,f);else{var j=g.JSON,k=g.JSON3,l=!1,m=i(g,g.JSON3={noConflict:function(){return l||(l=!0,g.JSON=j,g.JSON3=k,j=k=null),m}});g.JSON={parse:m.parse,stringify:m.stringify}}d&&define(function(){return m})})).call(this)})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],112:[function(a,b,c){((function(a){((function(){function R(a,b,c){var d=(c||0)-1,e=a?a.length:0;while(++d<e)if(a[d]===b)return d;return-1}function S(a,b){var c=typeof b;a=a.cache;if(c=="boolean"||b==null)return a[b]?0:-1;c!="number"&&c!="string"&&(c="object");var d=c=="number"?b:h+b;return a=(a=a[c])&&a[d],c=="object"?a&&R(a,b)>-1?0:-1:a?0:-1}function T(a){var b=this.cache,c=typeof a;if(c=="boolean"||a==null)b[a]=!0;else{c!="number"&&c!="string"&&(c="object");var d=c=="number"?a:h+a,e=b[c]||(b[c]={});c=="object"?(e[d]||(e[d]=[])).push(a):e[d]=!0}}function U(a){return a.charCodeAt(0)}function V(a,b){var c=a.criteria,d=b.criteria,e=-1,f=c.length;while(++e<f){var g=c[e],h=d[e];if(g!==h){if(g>h||typeof g=="undefined")return 1;if(g<h||typeof h=="undefined")return-1}}return a.index-b.index}function W(a){var b=-1,c=a.length,d=a[0],e=a[c/2|0],f=a[c-1];if(d&&typeof d=="object"&&e&&typeof e=="object"&&f&&typeof f=="object")return!1;var g=Z();g["false"]=g["null"]=g["true"]=g["undefined"]=!1;var h=Z();h.array=a,h.cache=g,h.push=T;while(++b<c)h.push(a[b]);return h}function X(a){return"\\"+L[a]}function Y(){return e.pop()||[]}function Z(){return f.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,"undefined":!1,value:null}}function $(a){a.length=0,e.length<j&&e.push(a)}function _(a){var b=a.cache;b&&_(b),a.array=a.cache=a.criteria=a.object=a.number=a.string=a.value=null,f.length<j&&f.push(a)}function ba(a,b,c){b||(b=0),typeof c=="undefined"&&(c=a?a.length:0);var d=-1,e=c-b||0,f=Array(e<0?0:e);while(++d<e)f[d]=a[b+d];return f}function bb(a){function bC(a){return a&&typeof a=="object"&&!bZ(a)&&bm.call(a,"__wrapped__")?a:new bD(a)}function bD(a,b){this.__chain__=!!b,this.__wrapped__=a}function bF(a){function e(){if(c){var a=ba(c);bn.apply(a,arguments)}if(this instanceof e){var f=bH(b.prototype),g=b.apply(f,a||arguments);return cz(g)?g:f}return b.apply(d,a||arguments)}var b=a[0],c=a[2],d=a[4];return bV(e,a),e}function bG(a,b,c,d,e){if(c){var f=c(a);if(typeof f!="undefined")return f}var g=cz(a);if(!g)return a;var h=bf.call(a);if(!H[h])return a;var i=bB[h];switch(h){case A:case B:return new i(+a);case D:case G:return new i(a);case F:return f=i(a.source,p.exec(a)),f.lastIndex=a.lastIndex,f}var j=bZ(a);if(b){var k=!d;d||(d=Y()),e||(e=Y());var l=d.length;while(l--)if(d[l]==a)return e[l];f=j?i(a.length):{}}else f=j?ba(a):ce({},a);return j&&(bm.call(a,"index")&&(f.index=a.index),bm.call(a,"input")&&(f.input=a.input)),b?(d.push(a),e.push(f),(j?cV:cn)(a,function(a,g){f[g]=bG(a,b,c,d,e)}),k&&($(d),$(e)),f):f}function bH(a,b){return cz(a)?bs(a):{}}function bI(a,b,c){if(typeof a!="function")return d_;if(typeof b!="undefined"&&"prototype"in a){var d=a.__bindData__;if(typeof d=="undefined"){bE.funcNames&&(d=!a.name),d=d||!bE.funcDecomp;if(!d){var e=bk.call(a);bE.funcNames||(d=!q.test(e)),d||(d=u.test(e),bV(a,d))}}if(d===!1||d!==!0&&d[1]&1)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return dK(a,b)}return a}function bJ(a){function m(){var a=h?f:this;if(d){var n=ba(d);bn.apply(n,arguments)}if(e||j){n||(n=ba(arguments)),e&&bn.apply(n,e);if(j&&n.length<g)return c|=16,bJ([b,k?c:c&-4,n,null,f,g])}n||(n=arguments),i&&(b=a[l]);if(this instanceof m){a=bH(b.prototype);var o=b.apply(a,n);return cz(o)?o:a}return b.apply(a,n)}var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=c&1,i=c&2,j=c&4,k=c&8,l=b;return bV(m,a),m}function bK(a,b){var c=-1,d=bT(),e=a?a.length:0,f=e>=i&&d===R,g=[];if(f){var h=W(b);h?(d=S,b=h):f=!1}while(++c<e){var j=a[c];d(b,j)<0&&g.push(j)}return f&&_(b),g}function bL(a,b,c,d){var e=(d||0)-1,f=a?a.length:0,g=[];while(++e<f){var h=a[e];if(h&&typeof h=="object"&&typeof h.length=="number"&&(bZ(h)||bY(h))){b||(h=bL(h,b,c));var i=-1,j=h.length,k=g.length;g.length+=j;while(++i<j)g[k++]=h[i]}else c||g.push(h)}return g}function bM(a,b,c,d,e,f){if(c){var g=c(a,b);if(typeof g!="undefined")return!!g}if(a===b)return a!==0||1/a==1/b;var h=typeof a,i=typeof b;if(a===a&&(!a||!K[h])&&(!b||!K[i]))return!1;if(a==null||b==null)return a===b;var j=bf.call(a),k=bf.call(b);j==y&&(j=E),k==y&&(k=E);if(j!=k)return!1;switch(j){case A:case B:return+a==+b;case D:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case F:case G:return a==P(b)}var l=j==z;if(!l){var m=bm.call(a,"__wrapped__"),n=bm.call(b,"__wrapped__");if(m||n)return bM(m?a.__wrapped__:a,n?b.__wrapped__:b,c,d,e,f);if(j!=E)return!1;var o=a.constructor,p=b.constructor;if(o!=p&&!(cy(o)&&o instanceof o&&cy(p)&&p instanceof p)&&"constructor"in a&&"constructor"in b)return!1}var q=!e;e||(e=Y()),f||(f=Y());var r=e.length;while(r--)if(e[r]==a)return f[r]==b;var s=0;g=!0,e.push(a),f.push(b);if(l){r=a.length,s=b.length,g=s==r;if(g||d)while(s--){var t=r,u=b[s];if(d){while(t--)if(g=bM(a[t],u,c,d,e,f))break}else if(!(g=bM(a[s],u,c,d,e,f)))break}}else cl(b,function(b,h,i){if(bm.call(i,h))return s++,g=bm.call(a,h)&&bM(a[h],b,c,d,e,f)}),g&&!d&&cl(a,function(a,b,c){if(bm.call(c,b))return g=--s>-1});return e.pop(),f.pop(),q&&($(e),$(f)),g}function bN(a,b,c,d,e){(bZ(b)?cV:cn)(b,function(b,f){var g,h,i=b,j=a[f];if(b&&((h=bZ(b))||cD(b))){var k=d.length;while(k--)if(g=d[k]==b){j=e[k];break}if(!g){var l;if(c){i=c(j,b);if(l=typeof i!="undefined")j=i}l||(j=h?bZ(j)?j:[]:cD(j)?j:{}),d.push(b),e.push(j),l||bN(j,b,c,d,e)}}else c&&(i=c(j,b),typeof i=="undefined"&&(i=b)),typeof i!="undefined"&&(j=i);a[f]=j})}function bO(a,b){return a+bj(bA()*(b-a+1))}function bP(a,b,c){var d=-1,e=bT(),f=a?a.length:0,g=[],h=!b&&f>=i&&e===R,j=c||h?Y():g;if(h){var k=W(j);e=S,j=k}while(++d<f){var l=a[d],m=c?c(l,d,a):l;if(b?!d||j[j.length-1]!==m:e(j,m)<0)(c||h)&&j.push(m),g.push(l)}return h?($(j.array),_(j)):c&&$(j),g}function bQ(a){return function(b,c,d){var e={};c=bC.createCallback(c,d,3);var f=-1,g=b?b.length:0;if(typeof g=="number")while(++f<g){var h=b[f];a(e,h,c(h,f,b),b)}else cn(b,function(b,d,f){a(e,b,c(b,d,f),f)});return e}}function bR(a,b,c,d,e,f){var g=b&1,h=b&2,i=b&4,j=b&8,k=b&16,l=b&32;if(!h&&!cy(a))throw new Q;k&&!c.length&&(b&=-17,k=c=!1),l&&!d.length&&(b&=-33,l=d=!1);var m=a&&a.__bindData__;if(m&&m!==!0)return m=ba(m),m[2]&&(m[2]=ba(m[2])),m[3]&&(m[3]=ba(m[3])),g&&!(m[1]&1)&&(m[4]=e),!g&&m[1]&1&&(b|=8),i&&!(m[1]&4)&&(m[5]=f),k&&bn.apply(m[2]||(m[2]=[]),c),l&&bq.apply(m[3]||(m[3]=[]),d),m[1]|=b,bR.apply(null,m);var n=b==1||b===17?bF:bJ;return n([a,b,c,d,e,f])}function bS(a){return ca[a]}function bT(){var a=(a=bC.indexOf)===dt?R:a;return a}function bU(a){return typeof a=="function"&&bg.test(a)}function bW(a){var b,c;return!!a&&bf.call(a)==E&&(b=a.constructor,!cy(b)||b instanceof b)?(cl(a,function(a,b){c=b}),typeof c=="undefined"||bm.call(a,c)):!1}function bX(a){return cb[a]}function bY(a){return a&&typeof a=="object"&&typeof a.length=="number"&&bf.call(a)==y||!1}function cf(a,b,c,d){return typeof b!="boolean"&&b!=null&&(d=c,c=b,b=!1),bG(a,b,typeof c=="function"&&bI(c,d,1))}function cg(a,b,c){return bG(a,!0,typeof b=="function"&&bI(b,c,1))}function ch(a,b){var c=bH(a);return b?ce(c,b):c}function cj(a,b,c){var d;return b=bC.createCallback(b,c,3),cn(a,function(a,c,e){if(b(a,c,e))return d=c,!1}),d}function ck(a,b,c){var d;return b=bC.createCallback(b,c,3),co(a,function(a,c,e){if(b(a,c,e))return d=c,!1}),d}function cm(a,b,c){var d=[];cl(a,function(a,b){d.push(b,a)});var e=d.length;b=bI(b,c,3);while(e--)if(b(d[e--],d[e],a)===!1)break;return a}function co(a,b,c){var d=b_(a),e=d.length;b=bI(b,c,3);while(e--){var f=d[e];if(b(a[f],f,a)===!1)break}return a}function cp(a){var b=[];return cl(a,function(a,c){cy(a)&&b.push(c)}),b.sort()}function cq(a,b){return a?bm.call(a,b):!1}function cr(a){var b=-1,c=b_(a),d=c.length,e={};while(++b<d){var f=c[b];e[a[f]]=f}return e}function cs(a){return a===!0||a===!1||a&&typeof a=="object"&&bf.call(a)==A||!1}function ct(a){return a&&typeof a=="object"&&bf.call(a)==B||!1}function cu(a){return a&&a.nodeType===1||!1}function cv(a){var b=!0;if(!a)return b;var c=bf.call(a),d=a.length;return c==z||c==G||c==y||c==E&&typeof d=="number"&&cy(a.splice)?!d:(cn(a,function(){return b=!1}),b)}function cw(a,b,c,d){return bM(a,b,typeof c=="function"&&bI(c,d,2))}function cx(a){return bu(a)&&!bv(parseFloat(a))}function cy(a){return typeof a=="function"}function cz(a){return!!a&&!!K[typeof a]}function cA(a){return cC(a)&&a!=+a}function cB(a){return a===null}function cC(a){return typeof a=="number"||a&&typeof a=="object"&&bf.call(a)==D||!1}function cE(a){return a&&typeof a=="object"&&bf.call(a)==F||!1}function cF(a){return typeof a=="string"||a&&typeof a=="object"&&bf.call(a)==G||!1}function cG(a){return typeof a=="undefined"}function cH(a,b,c){var d={};return b=bC.createCallback(b,c,3),cn(a,function(a,c,e){d[c]=b(a,c,e)}),d}function cI(a){var b=arguments,c=2;if(!cz(a))return a;typeof b[2]!="number"&&(c=b.length);if(c>3&&typeof b[c-2]=="function")var d=bI(b[--c-1],b[c--],2);else c>2&&typeof b[c-1]=="function"&&(d=b[--c]);var e=ba(arguments,1,c),f=-1,g=Y(),h=Y();while(++f<c)bN(a,e[f],d,g,h);return $(g),$(h),a}function cJ(a,b,c){var d={};if(typeof b!="function"){var e=[];cl(a,function(a,b){e.push(b)}),e=bK(e,bL(arguments,!0,!1,1));var f=-1,g=e.length;while(++f<g){var h=e[f];d[h]=a[h]}}else b=bC.createCallback(b,c,3),cl(a,function(a,c,e){b(a,c,e)||(d[c]=a)});return d}function cK(a){var c=-1,d=b_(a),e=d.length,f=b(e);while(++c<e){var g=d[c];f[c]=[g,a[g]]}return f}function cL(a,b,c){var d={};if(typeof b!="function"){var e=-1,f=bL(arguments,!0,!1,1),g=cz(a)?f.length:0;while(++e<g){var h=f[e];h in a&&(d[h]=a[h])}}else b=bC.createCallback(b,c,3),cl(a,function(a,c,e){b(a,c,e)&&(d[c]=a)});return d}function cM(a,b,c,d){var e=bZ(a);if(c==null)if(e)c=[];else{var f=a&&a.constructor,g=f&&f.prototype;c=bH(g)}return b&&(b=bC.createCallback(b,d,4),(e?cV:cn)(a,function(a,d,e){return b(c,a,d,e)})),c}function cN(a){var c=-1,d=b_(a),e=d.length,f=b(e);while(++c<e)f[c]=a[d[c]];return f}function cO(a){var c=arguments,d=-1,e=bL(c,!0,!1,1),f=c[2]&&c[2][c[1]]===a?1:e.length,g=b(f);while(++d<f)g[d]=a[e[d]];return g}function cP(a,b,c){var d=-1,e=bT(),f=a?a.length:0,g=!1;return c=(c<0?bx(0,f+c):c)||0,bZ(a)?g=e(a,b,c)>-1:typeof f=="number"?g=(cF(a)?a.indexOf(b,c):e(a,b,c))>-1:cn(a,function(a){if(++d>=c)return!(g=a===b)}),g}function cR(a,b,c){var d=!0;b=bC.createCallback(b,c,3);var e=-1,f=a?a.length:0;if(typeof f=="number"){while(++e<f)if(!(d=!!b(a[e],e,a)))break}else cn(a,function(a,c,e){return d=!!b(a,c,e)});return d}function cS(a,b,c){var d=[];b=bC.createCallback(b,c,3);var e=-1,f=a?a.length:0;if(typeof f=="number")while(++e<f){var g=a[e];b(g,e,a)&&d.push(g)}else cn(a,function(a,c,e){b(a,c,e)&&d.push(a)});return d}function cT(a,b,c){b=bC.createCallback(b,c,3);var d=-1,e=a?a.length:0;if(typeof e!="number"){var g;return cn(a,function(a,c,d){if(b(a,c,d))return g=a,!1}),g}while(++d<e){var f=a[d];if(b(f,d,a))return f}}function cU(a,b,c){var d;return b=bC.createCallback(b,c,3),cW(a,function(a,c,e){if(b(a,c,e))return d=a,!1}),d}function cV(a,b,c){var d=-1,e=a?a.length:0;b=b&&typeof c=="undefined"?b:bI(b,c,3);if(typeof e=="number"){while(++d<e)if(b(a[d],d,a)===!1)break}else cn(a,b);return a}function cW(a,b,c){var d=a?a.length:0;b=b&&typeof c=="undefined"?b:bI(b,c,3);if(typeof d=="number"){while(d--)if(b(a[d],d,a)===!1)break}else{var e=b_(a);d=e.length,cn(a,function(a,c,f){return c=e?e[--d]:--d,b(f[c],c,f)})}return a}function cZ(a,c){var d=ba(arguments,2),e=-1,f=typeof c=="function",g=a?a.length:0,h=b(typeof g=="number"?g:0);return cV(a,function(a){h[++e]=(f?c:a[c]).apply(a,d)}),h}function c$(a,c,d){var e=-1,f=a?a.length:0;c=bC.createCallback(c,d,3);if(typeof f=="number"){var g=b(f);while(++e<f)g[e]=c(a[e],e,a)}else g=[],cn(a,function(a,b,d){g[++e]=c(a,b,d)});return g}function c_(a,b,c){var d=-Infinity,e=d;typeof b!="function"&&c&&c[b]===a&&(b=null);if(b==null&&bZ(a)){var f=-1,g=a.length;while(++f<g){var h=a[f];h>e&&(e=h)}}else b=b==null&&cF(a)?U:bC.createCallback(b,c,3),cV(a,function(a,c,f){var g=b(a,c,f);g>d&&(d=g,e=a)});return e}function da(a,b,c){var d=Infinity,e=d;typeof b!="function"&&c&&c[b]===a&&(b=null);if(b==null&&bZ(a)){var f=-1,g=a.length;while(++f<g){var h=a[f];h<e&&(e=h)}}else b=b==null&&cF(a)?U:bC.createCallback(b,c,3),cV(a,function(a,c,f){var g=b(a,c,f);g<d&&(d=g,e=a)});return e}function dc(a,b,c,d){if(!a)return c;var e=arguments.length<3;b=bC.createCallback(b,d,4);var f=-1,g=a.length;if(typeof g=="number"){e&&(c=a[++f]);while(++f<g)c=b(c,a[f],f,a)}else cn(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)});return c}function dd(a,b,c,d){var e=arguments.length<3;return b=bC.createCallback(b,d,4),cW(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)}),c}function de(a,b,c){return b=bC.createCallback(b,c,3),cS(a,function(a,c,d){return!b(a,c,d)})}function df(a,b,c){a&&typeof a.length!="number"&&(a=cN(a));if(b==null||c)return a?a[bO(0,a.length-1)]:d;var e=dg(a);return e.length=by(bx(0,b),e.length),e}function dg(a){var c=-1,d=a?a.length:0,e=b(typeof d=="number"?d:0);return cV(a,function(a){var b=bO(0,++c);e[c]=e[b],e[b]=a}),e}function dh(a){var b=a?a.length:0;return typeof b=="number"?b:b_(a).length}function di(a,b,c){var d;b=bC.createCallback(b,c,3);var e=-1,f=a?a.length:0;if(typeof f=="number"){while(++e<f)if(d=b(a[e],e,a))break}else cn(a,function(a,c,e){return!(d=b(a,c,e))});return!!d}function dj(a,c,d){var e=-1,f=bZ(c),g=a?a.length:0,h=b(typeof g=="number"?g:0);f||(c=bC.createCallback(c,d,3)),cV(a,function(a,b,d){var g=h[++e]=Z();f?g.criteria=c$(c,function(b){return a[b]}):(g.criteria=Y())[0]=c(a,b,d),g.index=e,g.value=a}),g=h.length,h.sort(V);while(g--){var i=h[g];h[g]=i.value,f||$(i.criteria),_(i)}return h}function dk(a){return a&&typeof a.length=="number"?ba(a):cN(a)}function dm(a){var b=-1,c=a?a.length:0,d=[];while(++b<c){var e=a[b];e&&d.push(e)}return d}function dn(a){return bK(a,bL(arguments,!0,!0,1))}function dp(a,b,c){var d=-1,e=a?a.length:0;b=bC.createCallback(b,c,3);while(++d<e)if(b(a[d],d,a))return d;return-1}function dq(a,b,c){var d=a?a.length:0;b=bC.createCallback(b,c,3);while(d--)if(b(a[d],d,a))return d;return-1}function dr(a,b,c){var e=0,f=a?a.length:0;if(typeof b!="number"&&b!=null){var g=-1;b=bC.createCallback(b,c,3);while(++g<f&&b(a[g],g,a))e++}else{e=b;if(e==null||c)return a?a[0]:d}return ba(a,0,by(bx(0,e),f))}function ds(a,b,c,d){return typeof b!="boolean"&&b!=null&&(d=c,c=typeof b!="function"&&d&&d[b]===a?null:b,b=!1),c!=null&&(a=c$(a,c,d)),bL(a,b)}function dt(a,b,c){if(typeof c=="number"){var d=a?a.length:0;c=c<0?bx(0,d+c):c||0}else if(c){var e=dC(a,b);return a[e]===b?e:-1}return R(a,b,c)}function du(a,b,c){var d=0,e=a?a.length:0;if(typeof b!="number"&&b!=null){var f=e;b=bC.createCallback(b,c,3);while(f--&&b(a[f],f,a))d++}else d=b==null||c?1:b||d;return ba(a,0,by(bx(0,e-d),e))}function dv(){var a=[],b=-1,c=arguments.length,d=Y(),e=bT(),f=e===R,g=Y();while(++b<c){var h=arguments[b];if(bZ(h)||bY(h))a.push(h),d.push(f&&h.length>=i&&W(b?a[b]:g))}var j=a[0],k=-1,l=j?j.length:0,m=[];a:while(++k<l){var n=d[0];h=j[k];if((n?S(n,h):e(g,h))<0){b=c,(n||g).push(h);while(--b){n=d[b];if((n?S(n,h):e(a[b],h))<0)continue a}m.push(h)}}while(c--)n=d[c],n&&_(n);return $(d),$(g),m}function dw(a,b,c){var e=0,f=a?a.length:0;if(typeof b!="number"&&b!=null){var g=f;b=bC.createCallback(b,c,3);while(g--&&b(a[g],g,a))e++}else{e=b;if(e==null||c)return a?a[f-1]:d}return ba(a,bx(0,f-e))}function dx(a,b,c){var d=a?a.length:0;typeof c=="number"&&(d=(c<0?bx(0,d+c):by(c,d-1))+1);while(d--)if(a[d]===b)return d;return-1}function dy(a){var b=arguments,c=0,d=b.length,e=a?a.length:0;while(++c<d){var f=-1,g=b[c];while(++f<e)a[f]===g&&(bp.call(a,f--,1),e--)}return a}function dz(a,c,d){a=+a||0,d=typeof d=="number"?d:+d||1,c==null&&(c=a,a=0);var e=-1,f=bx(0,bh((c-a)/(d||1))),g=b(f);while(++e<f)g[e]=a,a+=d;return g}function dA(a,b,c){var d=-1,e=a?a.length:0,f=[];b=bC.createCallback(b,c,3);while(++d<e){var g=a[d];b(g,d,a)&&(f.push(g),bp.call(a,d--,1),e--)}return f}function dB(a,b,c){if(typeof b!="number"&&b!=null){var d=0,e=-1,f=a?a.length:0;b=bC.createCallback(b,c,3);while(++e<f&&b(a[e],e,a))d++}else d=b==null||c?1:bx(0,b);return ba(a,d)}function dC(a,b,c,d){var e=0,f=a?a.length:e;c=c?bC.createCallback(c,d,1):d_,b=c(b);while(e<f){var g=e+f>>>1;c(a[g])<b?e=g+1:f=g}return e}function dD(){return bP(bL(arguments,!0,!0))}function dE(a,b,c,d){return typeof b!="boolean"&&b!=null&&(d=c,c=typeof b!="function"&&d&&d[b]===a?null:b,b=!1),c!=null&&(c=bC.createCallback(c,d,3)),bP(a,b,c)}function dF(a){return bK(a,ba(arguments,1))}function dG(){var a=-1,b=arguments.length;while(++a<b){var c=arguments[a];if(bZ(c)||bY(c))var d=d?bP(bK(d,c).concat(bK(c,d))):c}return d||[]}function dH(){var a=arguments.length>1?arguments:arguments[0],c=-1,d=a?c_(db(a,"length")):0,e=b(d<0?0:d);while(++c<d)e[c]=db(a,c);return e}function dI(a,b){var c=-1,d=a?a.length:0,e={};!b&&d&&!bZ(a[0])&&(b=[]);while(++c<d){var f=a[c];b?e[f]=b[c]:f&&(e[f[0]]=f[1])}return e}function dJ(a,b){if(!cy(b))throw new Q;return function(){if(--a<1)return b.apply(this,arguments)}}function dK(a,b){return arguments.length>2?bR(a,17,ba(arguments,2),null,b):bR(a,1,null,null,b)}function dL(a){var b=arguments.length>1?bL(arguments,!0,!1,1):cp(a),c=-1,d=b.length;while(++c<d){var e=b[c];a[e]=bR(a[e],1,null,null,a)}return a}function dM(a,b){return arguments.length>2?bR(b,19,ba(arguments,2),null,a):bR(b,3,null,null,a)}function dN(){var a=arguments,b=a.length;while(b--)if(!cy(a[b]))throw new Q;return function(){var b=arguments,c=a.length;while(c--)b=[a[c].apply(this,b)];return b[0]}}function dO(a,b){return b=typeof b=="number"?b:+b||a.length,bR(a,4,null,null,null,b)}function dP(a,b,c){var e,f,g,h,i,j,k,l=0,m=!1,n=!0;if(!cy(a))throw new Q;b=bx(0,b)||0;if(c===!0){var o=!0;n=!1}else cz(c)&&(o=c.leading,m="maxWait"in c&&(bx(b,c.maxWait)||0),n="trailing"in c?c.trailing:n);var p=function(){var c=b-(ed()-h);if(c<=0){f&&bi(f);var m=k;f=j=k=d,m&&(l=ed(),g=a.apply(i,e),!j&&!f&&(e=i=null))}else j=bo(p,c)},q=function(){j&&bi(j),f=j=k=d;if(n||m!==b)l=ed(),g=a.apply(i,e),!j&&!f&&(e=i=null)};return function(){e=arguments,h=ed(),i=this,k=n&&(j||!o);if(m===!1)var c=o&&!j;else{!f&&!o&&(l=h);var d=m-(h-l),r=d<=0;r?(f&&(f=bi(f)),l=h,g=a.apply(i,e)):f||(f=bo(q,d))}return r&&j?j=bi(j):!j&&b!==m&&(j=bo(p,b)),c&&(r=!0,g=a.apply(i,e)),r&&!j&&!f&&(e=i=null),g}}function dQ(a){if(!cy(a))throw new Q;var b=ba(arguments,1);return bo(function(){a.apply(d,b)},1)}function dR(a,b){if(!cy(a))throw new Q;var c=ba(arguments,2);return bo(function(){a.apply(d,c)},b)}function dS(a,b){if(!cy(a))throw new Q;var c=function(){var d=c.cache,e=b?b.apply(this,arguments):h+arguments[0];return bm.call(d,e)?d[e]:d[e]=a.apply(this,arguments)};return c.cache={},c}function dT(a){var b,c;if(!cy(a))throw new Q;return function(){return b?c:(b=!0,c=a.apply(this,arguments),a=null,c)}}function dU(a){return bR(a,16,ba(arguments,1))}function dV(a){return bR(a,32,null,ba(arguments,1))}function dW(a,b,c){var d=!0,e=!0;if(!cy(a))throw new Q;return c===!1?d=!1:cz(c)&&(d="leading"in c?c.leading:d,e="trailing"in c?c.trailing:e),I.leading=d,I.maxWait=b,I.trailing=e,dP(a,b,I)}function dX(a,b){return bR(b,16,[a])}function dY(a){return function(){return a}}function dZ(a,b,c){var d=typeof a;if(a==null||d=="function")return bI(a,b,c);if(d!="object")return ef(a);var e=b_(a),f=e[0],g=a[f];return e.length==1&&g===g&&!cz(g)?function(a){var b=a[f];return g===b&&(g!==0||1/g==1/b)}:function(b){var c=e.length,d=!1;while(c--)if(!(d=bM(b[e[c]],a[e[c]],null,!0)))break;return d}}function d$(a){return a==null?"":P(a).replace(cd,bS)}function d_(a){return a}function ea(a,b,c){var d=!0,e=b&&cp(b);if(!b||!c&&!e.length)c==null&&(c=b),f=bD,b=a,a=bC,e=cp(b);c===!1?d=!1:cz(c)&&"chain"in c&&(d=c.chain);var f=a,g=cy(f);cV(e,function(c){var e=a[c]=b[c];g&&(f.prototype[c]=function(){var b=this.__chain__,c=this.__wrapped__,g=[c];bn.apply(g,arguments);var h=e.apply(a,g);if(d||b){if(c===h&&cz(h))return this;h=new f(h),h.__chain__=b}return h})})}function eb(){return a._=be,this}function ec(){}function ef(a){return function(b){return b[a]}}function eg(a,b,c){var d=a==null,e=b==null;c==null&&(typeof a=="boolean"&&e?(c=a,a=1):!e&&typeof b=="boolean"&&(c=b,e=!0)),d&&e&&(b=1),a=+a||0,e?(b=a,a=0):b=+b||0;if(c||a%1||b%1){var f=bA();return by(a+f*(b-a+parseFloat("1e-"+((f+"").length-1))),b)}return bO(a,b)}function eh(a,b){if(a){var c=a[b];return cy(c)?a[b]():c}}function ei(a,b,c){var e=bC.templateSettings;a=P(a||""),c=ci({},c,e);var g=ci({},c.imports,e.imports),h=b_(g),i=cN(g),j,k=0,p=c.interpolate||t,q="__p += '",s=O((c.escape||t).source+"|"+p.source+"|"+(p===r?o:t).source+"|"+(c.evaluate||t).source+"|$","g");a.replace(s,function(b,c,d,e,f,g){return d||(d=e),q+=a.slice(k,g).replace(v,X),c&&(q+="' +\n__e("+c+") +\n'"),f&&(j=!0,q+="';\n"+f+";\n__p += '"),d&&(q+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),k=g+b.length,b}),q+="';\n";var u=c.variable,w=u;w||(u="obj",q="with ("+u+") {\n"+q+"\n}\n"),q=(j?q.replace(l,""):q).replace(m,"$1").replace(n,"$1;"),q="function("+u+") {\n"+(w?"":u+" || ("+u+" = {});\n")+"var __t, __p = '', __e = _.escape"+(j?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+q+"return __p\n}";var y="\n/*\n//# sourceURL="+(c.sourceURL||"/lodash/template/source["+x++ +"]")+"\n*/";try{var z=f(h,"return "+q+y).apply(d,i)}catch(A){throw A.source=q,A}return b?z(b):(z.source=q,z)}function ej(a,c,d){a=(a=+a)>-1?a:0;var e=-1,f=b(a);c=bI(c,d,1);while(++e<a)f[e]=c(e);return f}function ek(a){return a==null?"":P(a).replace(cc,bX)}function el(a){var b=++g;return P(a==null?"":a)+b}function em(a){return a=new bD(a),a.__chain__=!0,a}function en(a,b){return b(a),a}function eo(){return this.__chain__=!0,this}function ep(){return P(this.__wrapped__)}function eq(){return this.__wrapped__}a=a?bc.defaults(M.Object(),a,bc.pick(M,w)):M;var b=a.Array,c=a.Boolean,e=a.Date,f=a.Function,j=a.Math,L=a.Number,N=a.Object,O=a.RegExp,P=a.String,Q=a.TypeError,T=[],bd=N.prototype,be=a._,bf=bd.toString,bg=O("^"+P(bf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),bh=j.ceil,bi=a.clearTimeout,bj=j.floor,bk=f.prototype.toString,bl=bU(bl=N.getPrototypeOf)&&bl,bm=bd.hasOwnProperty,bn=T.push,bo=a.setTimeout,bp=T.splice,bq=T.unshift,br=function(){try{var a={},b=bU(b=N.defineProperty)&&b,c=b(a,a,a)&&b}catch(d){}return c}(),bs=bU(bs=N.create)&&bs,bt=bU(bt=b.isArray)&&bt,bu=a.isFinite,bv=a.isNaN,bw=bU(bw=N.keys)&&bw,bx=j.max,by=j.min,bz=a.parseInt,bA=j.random,bB={};bB[z]=b,bB[A]=c,bB[B]=e,bB[C]=f,bB[E]=N,bB[D]=L,bB[F]=O,bB[G]=P,bD.prototype=bC.prototype;var bE=bC.support={};bE.funcDecomp=!bU(a.WinRTError)&&u.test(bb),bE.funcNames=typeof f.name=="string",bC.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:r,variable:"",imports:{_:bC}},bs||(bH=function(){function b(){}return function(c){if(cz(c)){b.prototype=c;var d=new b;b.prototype=null}return d||a.Object()}}());var bV=br?function(a,b){J.value=b,br(a,"__bindData__",J),J.value=null}:ec,bZ=bt||function(a){return a&&typeof a=="object"&&typeof a.length=="number"&&bf.call(a)==z||!1},b$=function(a){var b,c=a,d=[];if(!c)return d;if(!K[typeof a])return d;for(b in c)bm.call(c,b)&&d.push(b);return d},b_=bw?function(a){return cz(a)?bw(a):[]}:b$,ca={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},cb=cr(ca),cc=O("("+b_(cb).join("|")+")","g"),cd=O("["+b_(ca).join("")+"]","g"),ce=function(a,b,c){var d,e=a,f=e;if(!e)return f;var g=arguments,h=0,i=typeof c=="number"?2:g.length;if(i>3&&typeof g[i-2]=="function")var j=bI(g[--i-1],g[i--],2);else i>2&&typeof g[i-1]=="function"&&(j=g[--i]);while(++h<i){e=g[h];if(e&&K[typeof e]){var k=-1,l=K[typeof e]&&b_(e),m=l?l.length:0;while(++k<m)d=l[k],f[d]=j?j(f[d],e[d]):e[d]}}return f},ci=function(a,b,c){var d,e=a,f=e;if(!e)return f;var g=arguments,h=0,i=typeof c=="number"?2:g.length;while(++h<i){e=g[h];if(e&&K[typeof e]){var j=-1,k=K[typeof e]&&b_(e),l=k?k.length:0;while(++j<l)d=k[j],typeof f[d]=="undefined"&&(f[d]=e[d])}}return f},cl=function(a,b,c){var d,e=a,f=e;if(!e)return f;if(!K[typeof e])return f;b=b&&typeof c=="undefined"?b:bI(b,c,3);for(d in e)if(b(e[d],d,a)===!1)return f;return f},cn=function(a,b,c){var d,e=a,f=e;if(!e)return f;if(!K[typeof e])return f;b=b&&typeof c=="undefined"?b:bI(b,c,3);var g=-1,h=K[typeof e]&&b_(e),i=h?h.length:0;while(++g<i){d=h[g];if(b(e[d],d,a)===!1)return f}return f},cD=bl?function(a){if(!a||bf.call(a)!=E)return!1;var b=a.valueOf,c=bU(b)&&(c=bl(b))&&bl(c);return c?a==c||bl(a)==c:bW(a)}:bW,cQ=bQ(function(a,b,c){bm.call(a,c)?a[c]++:a[c]=1}),cX=bQ(function(a,b,c){(bm.call(a,c)?a[c]:a[c]=[]).push(b)}),cY=bQ(function(a,b,c){a[c]=b}),db=c$,dl=cS,ed=bU(ed=e.now)&&ed||function(){return(new e).getTime()},ee=bz(k+"08")==8?bz:function(a,b){return bz(cF(a)?a.replace(s,""):a,b||0)};return bC.after=dJ,bC.assign=ce,bC.at=cO,bC.bind=dK,bC.bindAll=dL,bC.bindKey=dM,bC.chain=em,bC.compact=dm,bC.compose=dN,bC.constant=dY,bC.countBy=cQ,bC.create=ch,bC.createCallback=dZ,bC.curry=dO,bC.debounce=dP,bC.defaults=ci,bC.defer=dQ,bC.delay=dR,bC.difference=dn,bC.filter=cS,bC.flatten=ds,bC.forEach=cV,bC.forEachRight=cW,bC.forIn=cl,bC.forInRight=cm,bC.forOwn=cn,bC.forOwnRight=co,bC.functions=cp,bC.groupBy=cX,bC.indexBy=cY,bC.initial=du,bC.intersection=dv,bC.invert=cr,bC.invoke=cZ,bC.keys=b_,bC.map=c$,bC.mapValues=cH,bC.max=c_,bC.memoize=dS,bC.merge=cI,bC.min=da,bC.omit=cJ,bC.once=dT,bC.pairs=cK,bC.partial=dU,bC.partialRight=dV,bC.pick=cL,bC.pluck=db,bC.property=ef,bC.pull=dy,bC.range=dz,bC.reject=de,bC.remove=dA,bC.rest=dB,bC.shuffle=dg,bC.sortBy=dj,bC.tap=en,bC.throttle=dW,bC.times=ej,bC.toArray=dk,bC.transform=cM,bC.union=dD,bC.uniq=dE,bC.values=cN,bC.where=dl,bC.without=dF,bC.wrap=dX,bC.xor=dG,bC.zip=dH,bC.zipObject=dI,bC.collect=c$,bC.drop=dB,bC.each=cV,bC.eachRight=cW,bC.extend=ce,bC.methods=cp,bC.object=dI,bC.select=cS,bC.tail=dB,bC.unique=dE,bC.unzip=dH,ea(bC),bC.clone=cf,bC.cloneDeep=cg,bC.contains=cP,bC.escape=d$,bC.every=cR,bC.find=cT,bC.findIndex=dp,bC.findKey=cj,bC.findLast=cU,bC.findLastIndex=dq,bC.findLastKey=ck,bC.has=cq,bC.identity=d_,bC.indexOf=dt,bC.isArguments=bY,bC.isArray=bZ,bC.isBoolean=cs,bC.isDate=ct,bC.isElement=cu,bC.isEmpty=cv,bC.isEqual=cw,bC.isFinite=cx,bC.isFunction=cy,bC.isNaN=cA,bC.isNull=cB,bC.isNumber=cC,bC.isObject=cz,bC.isPlainObject=cD,bC.isRegExp=cE,bC.isString=cF,bC.isUndefined=cG,bC.lastIndexOf=dx,bC.mixin=ea,bC.noConflict=eb,bC.noop=ec,bC.now=ed,bC.parseInt=ee,bC.random=eg,bC.reduce=dc,bC.reduceRight=dd,bC.result=eh,bC.runInContext=bb,bC.size=dh,bC.some=di,bC.sortedIndex=dC,bC.template=ei,bC.unescape=ek,bC.uniqueId=el,bC.all=cR,bC.any=di,bC.detect=cT,bC.findWhere=cT,bC.foldl=dc,bC.foldr=dd,bC.include=cP,bC.inject=dc,ea(function(){var a={};return cn(bC,function(b,c){bC.prototype[c]||(a[c]=b)}),a}(),!1),bC.first=dr,bC.last=dw,bC.sample=df,bC.take=dr,bC.head=dr,cn(bC,function(a,b){var c=b!=="sample";bC.prototype[b]||(bC.prototype[b]=function(b,d){var e=this.__chain__,f=a(this.__wrapped__,b,d);return!e&&(b==null||d&&(!c||typeof b!="function"))?f:new bD(f,e)})}),bC.VERSION="2.4.2",bC.prototype.chain=eo,bC.prototype.toString=ep,bC.prototype.value=eq,bC.prototype.valueOf=eq,cV(["join","pop","shift"],function(a){var b=T[a];bC.prototype[a]=function(){var a=this.__chain__,c=b.apply(this.__wrapped__,arguments);return a?new bD(c,a):c}}),cV(["push","reverse","sort","unshift"],function(a){var b=T[a];bC.prototype[a]=function(){return b.apply(this.__wrapped__,arguments),this}}),cV(["concat","slice","splice"],function(a){var b=T[a];bC.prototype[a]=function(){return new bD(b.apply(this.__wrapped__,arguments),this.__chain__)}}),bC}var d,e=[],f=[],g=0,h=+(new Date)+"",i=75,j=40,k=" \t\f\n\r\u2028\u2029",l=/\b__p \+= '';/g,m=/\b(__p \+=) '' \+/g,n=/(__e\(.*?\)|\b__t\)) \+\n'';/g,o=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,p=/\w*$/,q=/^\s*function[ \n\r\t]+\w/,r=/<%=([\s\S]+?)%>/g,s=RegExp("^["+k+"]*0+(?=.$)"),t=/($^)/,u=/\bthis\b/,v=/['\n\r\t\u2028\u2029\\]/g,w=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],x=0,y="[object Arguments]",z="[object Array]",A="[object Boolean]",B="[object Date]",C="[object Function]",D="[object Number]",E="[object Object]",F="[object RegExp]",G="[object String]",H={};H[C]=!1,H[y]=H[z]=H[A]=H[B]=H[D]=H[E]=H[F]=H[G]=!0;var I={leading:!1,maxWait:0,trailing:!1},J={configurable:!1,enumerable:!1,value:null,writable:!1},K={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},L={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},M=K[typeof window]&&window||this,N=K[typeof c]&&c&&!c.nodeType&&c,O=K[typeof b]&&b&&!b.nodeType&&b,P=O&&O.exports===N&&N,Q=K[typeof a]&&a;Q&&(Q.global===Q||Q.window===Q)&&(M=Q);var bc=bb();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(M._=bc,define(function(){return bc})):N&&O?P?(O.exports=bc)._=bc:N._=bc:M._=bc})).call(this)})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],113:[function(a,b,c){((function(a){var c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,g=/^\s+/,h=/\s+$/;b.exports=function(i){if("string"!=typeof i||!i)return null;i=i.replace(g,"").replace(h,"");if(a.JSON&&JSON.parse)return JSON.parse(i);if(c.test(i.replace(d,"@").replace(e,"]").replace(f,"")))return(new Function("return "+i))()}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],114:[function(a,b,c){c.encode=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b},c.decode=function(a){var b={},c=a.split("&");for(var d=0,e=c.length;d<e;d++){var f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},{}],115:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(b){var c=b,f=b.indexOf("["),g=b.indexOf("]");f!=-1&&g!=-1&&(b=b.substring(0,f)+b.substring(f,g).replace(/:/g,";")+b.substring(g,b.length));var h=d.exec(b||""),i={},j=14;while(j--)i[e[j]]=h[j]||"";return f!=-1&&g!=-1&&(i.source=c,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i}},{}],116:[function(a,b,c){((function(a){((function(){var c,d,e;typeof performance!="undefined"&&performance!==null&&performance.now?b.exports=function(){return performance.now()}:typeof a!="undefined"&&a!==null&&a.hrtime?(b.exports=function(){return(c()-e)/1e6},d=a.hrtime,c=function(){var a;return a=d(),a[0]*1e9+a[1]},e=c()):Date.now?(b.exports=function(){return Date.now()-e},e=Date.now()):(b.exports=function(){return(new Date).getTime()-e},e=(new Date).getTime())})).call(this)})).call(this,a(81))},{81:81}],117:[function(a,b,c){((function(){var a=this,d=d||{};d.WEBGL_RENDERER=0,d.CANVAS_RENDERER=1,d.VERSION="v2.2.3",d.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},d.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},d._UID=0,"undefined"!=typeof Float32Array?(d.Float32Array=Float32Array,d.Uint16Array=Uint16Array,d.Uint32Array=Uint32Array,d.ArrayBuffer=ArrayBuffer):(d.Float32Array=Array,d.Uint16Array=Array),d.INTERACTION_FREQUENCY=30,d.AUTO_PREVENT_DEFAULT=!0,d.PI_2=2*Math.PI,d.RAD_TO_DEG=180/Math.PI,d.DEG_TO_RAD=Math.PI/180,d.RETINA_PREFIX="@2x",d.dontSayHello=!1,d.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0,autoResize:!1},d.sayHello=function(a){if(!d.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var b=["%c %c %c Pixi.js "+d.VERSION+" - "+a+"  %c  %c  http://www.pixijs.com/  %c %c %c%c ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5"
,"color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,b)}else window.console&&console.log("Pixi.js "+d.VERSION+" - http://www.pixijs.com/");d.dontSayHello=!0}},d.Point=function(a,b){this.x=a||0,this.y=b||0},d.Point.prototype.clone=function(){return new d.Point(this.x,this.y)},d.Point.prototype.set=function(a,b){this.x=a||0,this.y=b||(0!==b?this.x:0)},d.Point.prototype.constructor=d.Point,d.Rectangle=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},d.Rectangle.prototype.clone=function(){return new d.Rectangle(this.x,this.y,this.width,this.height)},d.Rectangle.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=this.x;if(a>=c&&a<=c+this.width){var d=this.y;if(b>=d&&b<=d+this.height)return!0}return!1},d.Rectangle.prototype.constructor=d.Rectangle,d.EmptyRectangle=new d.Rectangle(0,0,0,0),d.Polygon=function(a){if(a instanceof Array||(a=Array.prototype.slice.call(arguments)),a[0]instanceof d.Point){for(var b=[],c=0,e=a.length;e>c;c++)b.push(a[c].x,a[c].y);a=b}this.closed=!0,this.points=a},d.Polygon.prototype.clone=function(){var a=this.points.slice();return new d.Polygon(a)},d.Polygon.prototype.contains=function(a,b){for(var c=!1,d=this.points.length/2,e=0,f=d-1;d>e;f=e++){var g=this.points[2*e],h=this.points[2*e+1],i=this.points[2*f],j=this.points[2*f+1],k=h>b!=j>b&&(i-g)*(b-h)/(j-h)+g>a;k&&(c=!c)}return c},d.Polygon.prototype.constructor=d.Polygon,d.Circle=function(a,b,c){this.x=a||0,this.y=b||0,this.radius=c||0},d.Circle.prototype.clone=function(){return new d.Circle(this.x,this.y,this.radius)},d.Circle.prototype.contains=function(a,b){if(this.radius<=0)return!1;var c=this.x-a,d=this.y-b,e=this.radius*this.radius;return c*=c,d*=d,e>=c+d},d.Circle.prototype.getBounds=function(){return new d.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},d.Circle.prototype.constructor=d.Circle,d.Ellipse=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},d.Ellipse.prototype.clone=function(){return new d.Ellipse(this.x,this.y,this.width,this.height)},d.Ellipse.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=(a-this.x)/this.width,d=(b-this.y)/this.height;return c*=c,d*=d,1>=c+d},d.Ellipse.prototype.getBounds=function(){return new d.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},d.Ellipse.prototype.constructor=d.Ellipse,d.RoundedRectangle=function(a,b,c,d,e){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.radius=e||20},d.RoundedRectangle.prototype.clone=function(){return new d.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},d.RoundedRectangle.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=this.x;if(a>=c&&a<=c+this.width){var d=this.y;if(b>=d&&b<=d+this.height)return!0}return!1},d.RoundedRectangle.prototype.constructor=d.RoundedRectangle,d.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},d.Matrix.prototype.fromArray=function(a){this.a=a[0],this.b=a[1],this.c=a[3],this.d=a[4],this.tx=a[2],this.ty=a[5]},d.Matrix.prototype.toArray=function(a){this.array||(this.array=new d.Float32Array(9));var b=this.array;return a?(b[0]=this.a,b[1]=this.b,b[2]=0,b[3]=this.c,b[4]=this.d,b[5]=0,b[6]=this.tx,b[7]=this.ty,b[8]=1):(b[0]=this.a,b[1]=this.c,b[2]=this.tx,b[3]=this.b,b[4]=this.d,b[5]=this.ty,b[6]=0,b[7]=0,b[8]=1),b},d.Matrix.prototype.apply=function(a,b){return b=b||new d.Point,b.x=this.a*a.x+this.c*a.y+this.tx,b.y=this.b*a.x+this.d*a.y+this.ty,b},d.Matrix.prototype.applyInverse=function(a,b){b=b||new d.Point;var c=1/(this.a*this.d+this.c*-this.b);return b.x=this.d*c*a.x+ -this.c*c*a.y+(this.ty*this.c-this.tx*this.d)*c,b.y=this.a*c*a.y+ -this.b*c*a.x+(-this.ty*this.a+this.tx*this.b)*c,b},d.Matrix.prototype.translate=function(a,b){return this.tx+=a,this.ty+=b,this},d.Matrix.prototype.scale=function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},d.Matrix.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this},d.Matrix.prototype.append=function(a){var b=this.a,c=this.b,d=this.c,e=this.d;return this.a=a.a*b+a.b*d,this.b=a.a*c+a.b*e,this.c=a.c*b+a.d*d,this.d=a.c*c+a.d*e,this.tx=a.tx*b+a.ty*d+this.tx,this.ty=a.tx*c+a.ty*e+this.ty,this},d.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},d.identityMatrix=new d.Matrix,d.DisplayObject=function(){this.position=new d.Point,this.scale=new d.Point(1,1),this.pivot=new d.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new d.Matrix,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new d.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},d.DisplayObject.prototype.constructor=d.DisplayObject,Object.defineProperty(d.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(a){this._interactive=a,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(d.DisplayObject.prototype,"worldVisible",{get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}}),Object.defineProperty(d.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(a){this._mask&&(this._mask.isMask=!1),this._mask=a,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(d.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(a){if(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].passes,e=0;e<d.length;e++)b.push(d[e]);this._filterBlock={target:this,filterPasses:b}}this._filters=a}}),Object.defineProperty(d.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&(a?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=a)}}),d.DisplayObject.prototype.updateTransform=function(){var a,b,c,e,f,g,h=this.parent.worldTransform,i=this.worldTransform;this.rotation%d.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),a=this._cr*this.scale.x,b=this._sr*this.scale.x,c=-this._sr*this.scale.y,e=this._cr*this.scale.y,f=this.position.x,g=this.position.y,(this.pivot.x||this.pivot.y)&&(f-=this.pivot.x*a+this.pivot.y*c,g-=this.pivot.x*b+this.pivot.y*e),i.a=a*h.a+b*h.c,i.b=a*h.b+b*h.d,i.c=c*h.a+e*h.c,i.d=c*h.b+e*h.d,i.tx=f*h.a+g*h.c+h.tx,i.ty=f*h.b+g*h.d+h.ty):(a=this.scale.x,e=this.scale.y,f=this.position.x-this.pivot.x*a,g=this.position.y-this.pivot.y*e,i.a=a*h.a,i.b=a*h.b,i.c=e*h.c,i.d=e*h.d,i.tx=f*h.a+g*h.c+h.tx,i.ty=f*h.b+g*h.d+h.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha},d.DisplayObject.prototype.displayObjectUpdateTransform=d.DisplayObject.prototype.updateTransform,d.DisplayObject.prototype.getBounds=function(a){return a=a,d.EmptyRectangle},d.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(d.identityMatrix)},d.DisplayObject.prototype.setStageReference=function(a){this.stage=a,this._interactive&&(this.stage.dirty=!0)},d.DisplayObject.prototype.generateTexture=function(a,b,c){var e=this.getLocalBounds(),f=new d.RenderTexture(0|e.width,0|e.height,c,b,a);return d.DisplayObject._tempMatrix.tx=-e.x,d.DisplayObject._tempMatrix.ty=-e.y,f.render(this,d.DisplayObject._tempMatrix),f},d.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},d.DisplayObject.prototype.toGlobal=function(a){return this.displayObjectUpdateTransform(),this.worldTransform.apply(a)},d.DisplayObject.prototype.toLocal=function(a,b){return b&&(a=b.toGlobal(a)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(a)},d.DisplayObject.prototype._renderCachedSprite=function(a){this._cachedSprite.worldAlpha=this.worldAlpha,a.gl?d.Sprite.prototype._renderWebGL.call(this._cachedSprite,a):d.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)},d.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var a=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|a.width,0|a.height);else{var b=new d.RenderTexture(0|a.width,0|a.height);this._cachedSprite=new d.Sprite(b),this._cachedSprite.worldTransform=this.worldTransform}var c=this._filters;this._filters=null,this._cachedSprite.filters=c,d.DisplayObject._tempMatrix.tx=-a.x,d.DisplayObject._tempMatrix.ty=-a.y,this._cachedSprite.texture.render(this,d.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-(a.x/a.width),this._cachedSprite.anchor.y=-(a.y/a.height),this._filters=c,this._cacheAsBitmap=!0},d.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},d.DisplayObject.prototype._renderWebGL=function(a){a=a},d.DisplayObject.prototype._renderCanvas=function(a){a=a},d.DisplayObject._tempMatrix=new d.Matrix,Object.defineProperty(d.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(a){this.position.x=a}}),Object.defineProperty(d.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(a){this.position.y=a}}),d.DisplayObjectContainer=function(){d.DisplayObject.call(this),this.children=[]},d.DisplayObjectContainer.prototype=Object.create(d.DisplayObject.prototype),d.DisplayObjectContainer.prototype.constructor=d.DisplayObjectContainer,Object.defineProperty(d.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(a){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1,this._width=a}}),Object.defineProperty(d.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1,this._height=a}}),d.DisplayObjectContainer.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)},d.DisplayObjectContainer.prototype.addChildAt=function(a,b){if(b>=0&&b<=this.children.length)return a.parent&&a.parent.removeChild(a),a.parent=this,this.children.splice(b,0,a),this.stage&&a.setStageReference(this.stage),a;throw new Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length)},d.DisplayObjectContainer.prototype.swapChildren=function(a,b){if(a!==b){var c=this.getChildIndex(a),d=this.getChildIndex(b);if(0>c||0>d)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[c]=b,this.children[d]=a}},d.DisplayObjectContainer.prototype.getChildIndex=function(a){var b=this.children.indexOf(a);if(-1===b)throw new Error("The supplied DisplayObject must be a child of the caller");return b},d.DisplayObjectContainer.prototype.setChildIndex=function(a,b){if(0>b||b>=this.children.length)throw new Error("The supplied index is out of bounds");var c=this.getChildIndex(a);this.children.splice(c,1),this.children.splice(b,0,a)},d.DisplayObjectContainer.prototype.getChildAt=function(a){if(0>a||a>=this.children.length)throw new Error("getChildAt: Supplied index "+a+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[a]},d.DisplayObjectContainer.prototype.removeChild=function(a){var b=this.children.indexOf(a);if(-1!==b)return this.removeChildAt(b)},d.DisplayObjectContainer.prototype.removeChildAt=function(a){var b=this.getChildAt(a);return this.stage&&b.removeStageReference(),b.parent=void 0,this.children.splice(a,1),b},d.DisplayObjectContainer.prototype.removeChildren=function(a,b){var c=a||0,d="number"==typeof b?b:this.children.length,e=d-c;if(e>0&&d>=e){for(var f=this.children.splice(c,e),g=0;g<f.length;g++){var h=f[g];this.stage&&h.removeStageReference(),h.parent=void 0}return f}if(0===e&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},d.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform()},d.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=d.DisplayObjectContainer.prototype.updateTransform,d.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return d.EmptyRectangle;for(var a,b,c,e=1/0,f=1/0,g=-1/0,h=-1/0,i=!1,j=0,k=this.children.length;k>j;j++){var l=this.children[j];l.visible&&(i=!0,a=this.children[j].getBounds(),e=e<a.x?e:a.x,f=f<a.y?f:a.y,b=a.width+a.x,c=a.height+a.y,g=g>b?g:b,h=h>c?h:c)}if(!i)return d.EmptyRectangle;var m=this._bounds;return m.x=e,m.y=f,m.width=g-e,m.height=h-f,m},d.DisplayObjectContainer.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=d.identityMatrix;for(var b=0,c=this.children.length;c>b;b++)this.children[b].updateTransform();var e=this.getBounds();return this.worldTransform=a,e},d.DisplayObjectContainer.prototype.setStageReference=function(a){this.stage=a,this._interactive&&(this.stage.dirty=!0);for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];d.setStageReference(a)}},d.DisplayObjectContainer.prototype.removeStageReference=function(){for(var a=0,b=this.children.length;b>a;a++){var c=this.children[a];c.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},d.DisplayObjectContainer.prototype._renderWebGL=function(a){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(a);var b,c;if(this._mask||this._filters){for(this._filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock)),this._mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start()),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop(),this._mask&&a.maskManager.popMask(this._mask,a),this._filters&&a.filterManager.popFilter(),a.spriteBatch.start()}else for(b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},d.DisplayObjectContainer.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(a);this._mask&&a.maskManager.pushMask(this._mask,a);for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];d._renderCanvas(a)}this._mask&&a.maskManager.popMask(a)}},d.Sprite=function(a){d.DisplayObjectContainer.call(this),this.anchor=new d.Point,this.texture=a||d.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.blendMode=d.blendModes.NORMAL,this.shader=null,this.texture.baseTexture.hasLoaded?this.onTextureUpdate():this.texture.on("update",this.onTextureUpdate.bind(this)),this.renderable=!0},d.Sprite.prototype=Object.create(d.DisplayObjectContainer.prototype),d.Sprite.prototype.constructor=d.Sprite,Object.defineProperty(d.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width,this._width=a}}),Object.defineProperty(d.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height,this._height=a}}),d.Sprite.prototype.setTexture=function(a){this.texture=a,this.cachedTint=16777215},d.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},d.Sprite.prototype.getBounds=function(a){var b=this.texture.frame.width,c=this.texture.frame.height,d=b*(1-this.anchor.x),e=b*-this.anchor.x,f=c*(1-this.anchor.y),g=c*-this.anchor.y,h=a||this.worldTransform,i=h.a,j=h.b,k=h.c,l=h.d,m=h.tx,n=h.ty,o=-1/0,p=-1/0,q=1/0,r=1/0;if(0===j&&0===k)0>i&&(i*=-1),0>l&&(l*=-1),q=i*e+m,o=i*d+m,r=l*g+n,p=l*f+n;else{var s=i*e+k*g+m,t=l*g+j*e+n,u=i*d+k*g+m,v=l*g+j*d+n,w=i*d+k*f+m,x=l*f+j*d+n,y=i*e+k*f+m,z=l*f+j*e+n;q=q>s?s:q,q=q>u?u:q,q=q>w?w:q,q=q>y?y:q,r=r>t?t:r,r=r>v?v:r,r=r>x?x:r,r=r>z?z:r,o=s>o?s:o,o=u>o?u:o,o=w>o?w:o,o=y>o?y:o,p=t>p?t:p,p=v>p?v:p,p=x>p?x:p,p=z>p?z:p}var A=this._bounds;return A.x=q,A.width=o-q,A.y=r,A.height=p-r,this._currentBounds=A,A},d.Sprite.prototype._renderWebGL=function(a){if(this.visible&&!(this.alpha<=0)){var b,c;if(this._mask||this._filters){var d=a.spriteBatch;for(this._filters&&(d.flush(),a.filterManager.pushFilter(this._filterBlock)),this._mask&&(d.stop(),a.maskManager.pushMask(this.mask,a),d.start()),d.render(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);d.stop(),this._mask&&a.maskManager.popMask(this._mask,a),this._filters&&a.filterManager.popFilter(),d.start()}else for(a.spriteBatch.render(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},d.Sprite.prototype._renderCanvas=function(a){if(!(this.visible===!1||0===this.alpha||this.texture.crop.width<=0||this.texture.crop.height<=0)){if(this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,a.context.globalCompositeOperation=d.blendModesCanvas[a.currentBlendMode]),this._mask&&a.maskManager.pushMask(this._mask,a),this.texture.valid){var b=this.texture.baseTexture.resolution/a.resolution;a.context.globalAlpha=this.worldAlpha,a.smoothProperty&&a.scaleMode!==this.texture.baseTexture.scaleMode&&(a.scaleMode=this.texture.baseTexture.scaleMode,a.context[a.smoothProperty]=a.scaleMode===d.scaleModes.LINEAR);var c=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,e=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;a.roundPixels?(a.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*a.resolution|0,this.worldTransform.ty*a.resolution|0),c=0|c,e=0|e):a.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*a.resolution,this.worldTransform.ty*a.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=d.CanvasTinter.getTintedTexture(this,this.tint)),a.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,c/b,e/b,this.texture.crop.width/b,this.texture.crop.height/b)):a.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,c/b,e/b,this.texture.crop.width/b,this.texture.crop.height/b)}for(var f=0,g=this.children.length;g>f;f++)this.children[f]._renderCanvas(a);this._mask&&a.maskManager.popMask(a)}},d.Sprite.fromFrame=function(a){var b=d.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache'+this);return new d.Sprite(b)},d.Sprite.fromImage=function(a,b,c){var e=d.Texture.fromImage(a,b,c);return new d.Sprite(e)},d.SpriteBatch=function(a){d.DisplayObjectContainer.call(this),this.textureThing=a,this.ready=!1},d.SpriteBatch.prototype=Object.create(d.DisplayObjectContainer.prototype),d.SpriteBatch.prototype.constructor=d.SpriteBatch,d.SpriteBatch.prototype.initWebGL=function(a){this.fastSpriteBatch=new d.WebGLFastSpriteBatch(a),this.ready=!0},d.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},d.SpriteBatch.prototype._renderWebGL=function(a){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(a.gl),a.spriteBatch.stop(),a.shaderManager.setShader(a.shaderManager.fastShader),this.fastSpriteBatch.begin(this,a),this.fastSpriteBatch.render(this),a.spriteBatch.start())},d.SpriteBatch.prototype._renderCanvas=function(a){if(this.visible&&!(this.alpha<=0)&&this.children.length){var b=a.context;b.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var c=this.worldTransform,d=!0,e=0;e<this.children.length;e++){var f=this.children[e];if(f.visible){var g=f.texture,h=g.frame;if(b.globalAlpha=this.worldAlpha*f.alpha,f.rotation%(2*Math.PI)===0)d&&(b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),d=!1),b.drawImage(g.baseTexture.source,h.x,h.y,h.width,h.height,f.anchor.x*-h.width*f.scale.x+f.position.x+.5|0,f.anchor.y*-h.height*f.scale.y+f.position.y+.5|0,h.width*f.scale.x,h.height*f.scale.y);else{d||(d=!0),f.displayObjectUpdateTransform();var i=f.worldTransform;a.roundPixels?b.setTransform(i.a,i.b,i.c,i.d,0|i.tx,0|i.ty):b.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),b.drawImage(g.baseTexture.source,h.x,h.y,h.width,h.height,f.anchor.x*-h.width+.5|0,f.anchor.y*-h.height+.5|0,h.width,h.height)}}}}},d.MovieClip=function(a){d.Sprite.call(this,a[0]),this.textures=a,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},d.MovieClip.prototype=Object.create(d.Sprite.prototype),d.MovieClip.prototype.constructor=d.MovieClip,Object.defineProperty(d.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),d.MovieClip.prototype.stop=function(){this.playing=!1},d.MovieClip.prototype.play=function(){this.playing=!0},d.MovieClip.prototype.gotoAndStop=function(a){this.playing=!1,this.currentFrame=a;var b=this.currentFrame+.5|0;this.setTexture(this.textures[b%this.textures.length])},d.MovieClip.prototype.gotoAndPlay=function(a){this.currentFrame=a,this.playing=!0},d.MovieClip.prototype.updateTransform=function(){if(this.displayObjectContainerUpdateTransform(),this.playing){this.currentFrame+=this.animationSpeed;var a=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length,this.loop||a<this.textures.length?this.setTexture(this.textures[a%this.textures.length]):a>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},d.MovieClip.fromFrames=function(a){for(var b=[],c=0;c<a.length;c++)b.push(new d.Texture.fromFrame(a[c]));return new d.MovieClip(b)},d.MovieClip.fromImages=function(a){for(var b=[],c=0;c<a.length;c++)b.push(new d.Texture.fromImage(a[c]));return new d.MovieClip(b)},d.FilterBlock=function(){this.visible=!0,this.renderable=!0},d.FilterBlock.prototype.constructor=d.FilterBlock,d.Text=function(a,b){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=1,d.Sprite.call(this,d.Texture.fromCanvas(this.canvas)),this.setText(a),this.setStyle(b)},d.Text.prototype=Object.create(d.Sprite.prototype),d.Text.prototype.constructor=d.Text,Object.defineProperty(d.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width,this._width=a}}),Object.defineProperty(d.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height,this._height=a}}),d.Text.prototype.setStyle=function(a){a=a||{},a.font=a.font||"bold 20pt Arial",a.fill=a.fill||"black",a.align=a.align||"left",a.stroke=a.stroke||"black",a.strokeThickness=a.strokeThickness||0,a.wordWrap=a.wordWrap||!1,a.wordWrapWidth=a.wordWrapWidth||100,a.dropShadow=a.dropShadow||!1,a.dropShadowAngle=a.dropShadowAngle||Math.PI/6,a.dropShadowDistance=a.dropShadowDistance||4,a.dropShadowColor=a.dropShadowColor||"black",this.style=a,this.dirty=!0},d.Text.prototype.setText=function(a){this.text=a.toString()||" ",this.dirty=!0},d.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution,this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.wordWrap(this.text));for(var b=a.split(/(?:\r\n|\r|\n)/),c=[],d=0,e=this.determineFontProperties(this.style.font),f=0;f<b.length;f++){var g=this.context.measureText(b[f]).width;c[f]=g,d=Math.max(d,g)}var h=d+this.style.strokeThickness;this.style.dropShadow&&(h+=this.style.dropShadowDistance),this.canvas.width=(h+this.context.lineWidth)*this.resolution;var i=e.fontSize+this.style.strokeThickness,j=i*b.length;this.style.dropShadow&&(j+=this.style.dropShadowDistance),this.canvas.height=j*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="alphabetic";var k,l;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var m=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,n=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(f=0;f<b.length;f++)k=this.style.strokeThickness/2,l=this.style.strokeThickness/2+f*i+e.ascent,"right"===this.style.align?k+=d-c[f]:"center"===this.style.align&&(k+=(d-c[f])/2),this.style.fill&&this.context.fillText(b[f],k+m,l+n)}for(this.context.fillStyle=this.style.fill,f=0;f<b.length;f++)k=this.style.strokeThickness/2,l=this.style.strokeThickness/2+f*i+e.ascent,"right"===this.style.align?k+=d-c[f]:"center"===this.style.align&&(k+=(d-c[f])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(b[f],k,l),this.style.fill&&this.context.fillText(b[f],k,l);this.updateTexture()},d.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.texture.baseTexture.dirty()},d.Text.prototype._renderWebGL=function(a){this.dirty&&(this.resolution=a.resolution,this.updateText(),this.dirty=!1),d.Sprite.prototype._renderWebGL.call(this,a)},d.Text.prototype._renderCanvas=function(a){this.dirty&&(this.resolution=a.resolution,this.updateText(),this.dirty=!1),d.Sprite.prototype._renderCanvas.call(this,a)},d.Text.prototype.determineFontProperties=function(a){var b=d.Text.fontPropertiesCache[a];if(!b){b={};var c=d.Text.fontPropertiesCanvas,e=d.Text.fontPropertiesContext;e.font=a;var f=Math.ceil(e.measureText("|Mq").width),g=Math.ceil(e.measureText("M").width),h=2*g;g=1.4*g|0,c.width=f,c.height=h,e.fillStyle="#f00",e.fillRect(0,0,f,h),e.font=a,e.textBaseline="alphabetic",e.fillStyle="#000",e.fillText("|Mq",0,g);var i,j,k=e.getImageData(0,0,f,h).data,l=k.length,m=4*f,n=0,o=!1;for(i=0;g>i;i++){for(j=0;m>j;j+=4)if(255!==k[n+j]){o=!0;break}if(o)break;n+=m}for(b.ascent=g-i,n=l-m,o=!1,i=h;i>g;i--){for(j=0;m>j;j+=4)if(255!==k[n+j]){o=!0;break}if(o)break;n-=m}b.descent=i-g,b.descent+=6,b.fontSize=b.ascent+b.descent,d.Text.fontPropertiesCache[a]=b}return b},d.Text.prototype.wordWrap=function(a){for(var b="",c=a.split("\n"),d=0;d<c.length;d++){for(var e=this.style.wordWrapWidth,f=c[d].split(" "),g=0;g<f.length;g++){var h=this.context.measureText(f[g]).width,i=h+this.context.measureText(" ").width;0===g||i>e?(g>0&&(b+="\n"),b+=f[g],e=this.style.wordWrapWidth-h):(e-=i,b+=" "+f[g])}d<c.length-1&&(b+="\n")}return b},d.Text.prototype.getBounds=function(a){return this.dirty&&(this.updateText(),this.dirty=!1),d.Sprite.prototype.getBounds.call(this,a)},d.Text.prototype.destroy=function(a){this.context=null,this.canvas=null,this.texture.destroy(void 0===a?!0:a)},d.Text.fontPropertiesCache={},d.Text.fontPropertiesCanvas=document.createElement("canvas"),d.Text.fontPropertiesContext=d.Text.fontPropertiesCanvas.getContext("2d"),d.BitmapText=function(a,b){d.DisplayObjectContainer.call(this),this.textWidth=0,this.textHeight=0,this._pool=[],this.setText(a),this.setStyle(b),this.updateText(),this.dirty=!1},d.BitmapText.prototype=Object.create(d.DisplayObjectContainer.prototype),d.BitmapText.prototype.constructor=d.BitmapText,d.BitmapText.prototype.setText=function(a){this.text=a||" ",this.dirty=!0},d.BitmapText.prototype.setStyle=function(a){a=a||{},a.align=a.align||"left",this.style=a;var b=a.font.split(" ");this.fontName=b[b.length-1],this.fontSize=b.length>=2?parseInt(b[b.length-2],10):d.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=a.tint},d.BitmapText.prototype.updateText=function(){for(var a=d.BitmapText.fonts[this.fontName],b=new d.Point,c=null,e=[],f=0,g=[],h=0,i=this.fontSize/a.size,j=0;j<this.text.length;j++){var k=this.text.charCodeAt(j);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(j)))g.push(b.x),f=Math.max(f,b.x),h++,b.x=0,b.y+=a.lineHeight,c=null;else{var l=a.chars[k];l&&(c&&l.kerning[c]&&(b.x+=l.kerning[c]),e.push({texture:l.texture,line:h,charCode:k,position:new d.Point(b.x+l.xOffset,b.y+l.yOffset)}),b.x+=l.xAdvance,c=k)}}g.push(b.x),f=Math.max(f,b.x);var m=[];for(j=0;h>=j;j++){var n=0;"right"===this.style.align?n=f-g[j]:"center"===this.style.align&&(n=(f-g[j])/2),m.push(n)}var o=this.children.length,p=e.length,q=this.tint||16777215;for(j=0;p>j;j++){var r=o>j?this.children[j]:this._pool.pop();r?r.setTexture(e[j].texture):r=new d.Sprite(e[j].texture),r.position.x=(e[j].position.x+m[e[j].line])*i,r.position.y=e[j].position.y*i,r.scale.x=r.scale.y=i,r.tint=q,r.parent||this.addChild(r)}for(;this.children.length>p;){var s=this.getChildAt(this.children.length-1);this._pool.push(s),this.removeChild(s)}this.textWidth=f*i,this.textHeight=(b.y+a.lineHeight)*i},d.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),d.DisplayObjectContainer.prototype.updateTransform.call(this)},d.BitmapText.fonts={},d.InteractionData=function(){this.global=new d.Point,this.target=null,this.originalEvent=null},d.InteractionData.prototype.getLocalPosition=function(a,b){var c=a.worldTransform,e=this.global,f=c.a,g=c.c,h=c.tx,i=c.b,j=c.d,k=c.ty,l=1/(f*j+g*-i);return b=b||new d.Point,b.x=j*l*e.x+ -g*l*e.y+(k*g-h*j)*l,b.y=f*l*e.y+ -i*l*e.x+(-k*f+h*i)*l,b},d.InteractionData.prototype.constructor=d.InteractionData,d.InteractionManager=function(a){this.stage=a,this.mouse=new d.InteractionData,this.touches={},this.tempPoint=new d.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1,this.resolution=1,this._tempPoint=new d.Point},d.InteractionManager.prototype.constructor=d.InteractionManager,d.InteractionManager.prototype.collectInteractiveSprite=function(a,b){for(var c=a.children,d=c.length,e=d-1;e>=0;e--){var f=c[e];f._interactive?(b.interactiveChildren=!0,this.interactiveItems.push(f),f.children.length>0&&this.collectInteractiveSprite(f,f)):(f.__iParent=null,f.children.length>0&&this.collectInteractiveSprite(f,b))}},d.InteractionManager.prototype.setTarget=function(a){this.target=a,this.resolution=a.resolution,null===this.interactionDOMElement&&this.setTargetDomElement(a.view)},d.InteractionManager.prototype.setTargetDomElement=function(a){this.removeEvents(),window.navigator.msPointerEnabled&&(a.style["-ms-content-zooming"]="none",a.style["-ms-touch-action"]="none"),this.interactionDOMElement=a,a.addEventListener("mousemove",this.onMouseMove,!0),a.addEventListener("mousedown",this.onMouseDown,!0),a.addEventListener("mouseout",this.onMouseOut,!0),a.addEventListener("touchstart",this.onTouchStart,!0),a.addEventListener("touchend",this.onTouchEnd,!0),a.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},d.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},d.InteractionManager.prototype.update=function(
){if(this.target){var a=Date.now(),b=a-this.last;if(b=b*d.INTERACTION_FREQUENCY/1e3,!(1>b)){this.last=a;var c=0;this.dirty&&this.rebuildInteractiveGraph();var e=this.interactiveItems.length,f="inherit",g=!1;for(c=0;e>c;c++){var h=this.interactiveItems[c];h.__hit=this.hitTest(h,this.mouse),this.mouse.target=h,h.__hit&&!g?(h.buttonMode&&(f=h.defaultCursor),h.interactiveChildren||(g=!0),h.__isOver||(h.mouseover&&h.mouseover(this.mouse),h.__isOver=!0)):h.__isOver&&(h.mouseout&&h.mouseout(this.mouse),h.__isOver=!1)}this.currentCursorStyle!==f&&(this.currentCursorStyle=f,this.interactionDOMElement.style.cursor=f)}}},d.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var a=this.interactiveItems.length,b=0;a>b;b++)this.interactiveItems[b].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},d.InteractionManager.prototype.onMouseMove=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a;var b=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(a.clientX-b.left)*(this.target.width/b.width)/this.resolution,this.mouse.global.y=(a.clientY-b.top)*(this.target.height/b.height)/this.resolution;for(var c=this.interactiveItems.length,d=0;c>d;d++){var e=this.interactiveItems[d];e.mousemove&&e.mousemove(this.mouse)}},d.InteractionManager.prototype.onMouseDown=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a,d.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var b=this.interactiveItems.length,c=this.mouse.originalEvent,e=2===c.button||3===c.which,f=e?"rightdown":"mousedown",g=e?"rightclick":"click",h=e?"__rightIsDown":"__mouseIsDown",i=e?"__isRightDown":"__isDown",j=0;b>j;j++){var k=this.interactiveItems[j];if((k[f]||k[g])&&(k[h]=!0,k.__hit=this.hitTest(k,this.mouse),k.__hit&&(k[f]&&k[f](this.mouse),k[i]=!0,!k.interactiveChildren)))break}},d.InteractionManager.prototype.onMouseOut=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a;var b=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var c=0;b>c;c++){var d=this.interactiveItems[c];d.__isOver&&(this.mouse.target=d,d.mouseout&&d.mouseout(this.mouse),d.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},d.InteractionManager.prototype.onMouseUp=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a;for(var b=this.interactiveItems.length,c=!1,d=this.mouse.originalEvent,e=2===d.button||3===d.which,f=e?"rightup":"mouseup",g=e?"rightclick":"click",h=e?"rightupoutside":"mouseupoutside",i=e?"__isRightDown":"__isDown",j=0;b>j;j++){var k=this.interactiveItems[j];(k[g]||k[f]||k[h])&&(k.__hit=this.hitTest(k,this.mouse),k.__hit&&!c?(k[f]&&k[f](this.mouse),k[i]&&k[g]&&k[g](this.mouse),k.interactiveChildren||(c=!0)):k[i]&&k[h]&&k[h](this.mouse),k[i]=!1)}},d.InteractionManager.prototype.hitTest=function(a,b){var c=b.global;if(!a.worldVisible)return!1;a.worldTransform.applyInverse(c,this._tempPoint);var e,f=this._tempPoint.x,g=this._tempPoint.y;if(b.target=a,a.hitArea&&a.hitArea.contains)return a.hitArea.contains(f,g);if(a instanceof d.Sprite){var h,i=a.texture.frame.width,j=a.texture.frame.height,k=-i*a.anchor.x;if(f>k&&k+i>f&&(h=-j*a.anchor.y,g>h&&h+j>g))return!0}else if(a instanceof d.Graphics){var l=a.graphicsData;for(e=0;e<l.length;e++){var m=l[e];if(m.fill&&m.shape&&m.shape.contains(f,g))return!0}}var n=a.children.length;for(e=0;n>e;e++){var o=a.children[e],p=this.hitTest(o,b);if(p)return b.target=a,!0}return!1},d.InteractionManager.prototype.onTouchMove=function(a){this.dirty&&this.rebuildInteractiveGraph();var b,c=this.interactionDOMElement.getBoundingClientRect(),d=a.changedTouches,e=0;for(e=0;e<d.length;e++){var f=d[e];b=this.touches[f.identifier],b.originalEvent=a,b.global.x=(f.clientX-c.left)*(this.target.width/c.width)/this.resolution,b.global.y=(f.clientY-c.top)*(this.target.height/c.height)/this.resolution,!navigator.isCocoonJS||c.left||c.top||a.target.style.width||a.target.style.height||(b.global.x=f.clientX,b.global.y=f.clientY);for(var g=0;g<this.interactiveItems.length;g++){var h=this.interactiveItems[g];h.touchmove&&h.__touchData&&h.__touchData[f.identifier]&&h.touchmove(b)}}},d.InteractionManager.prototype.onTouchStart=function(a){this.dirty&&this.rebuildInteractiveGraph();var b=this.interactionDOMElement.getBoundingClientRect();d.AUTO_PREVENT_DEFAULT&&a.preventDefault();for(var c=a.changedTouches,e=0;e<c.length;e++){var f=c[e],g=this.pool.pop();g||(g=new d.InteractionData),g.originalEvent=a,this.touches[f.identifier]=g,g.global.x=(f.clientX-b.left)*(this.target.width/b.width)/this.resolution,g.global.y=(f.clientY-b.top)*(this.target.height/b.height)/this.resolution,!navigator.isCocoonJS||b.left||b.top||a.target.style.width||a.target.style.height||(g.global.x=f.clientX,g.global.y=f.clientY);for(var h=this.interactiveItems.length,i=0;h>i;i++){var j=this.interactiveItems[i];if((j.touchstart||j.tap)&&(j.__hit=this.hitTest(j,g),j.__hit&&(j.touchstart&&j.touchstart(g),j.__isDown=!0,j.__touchData=j.__touchData||{},j.__touchData[f.identifier]=g,!j.interactiveChildren)))break}}},d.InteractionManager.prototype.onTouchEnd=function(a){this.dirty&&this.rebuildInteractiveGraph();for(var b=this.interactionDOMElement.getBoundingClientRect(),c=a.changedTouches,d=0;d<c.length;d++){var e=c[d],f=this.touches[e.identifier],g=!1;f.global.x=(e.clientX-b.left)*(this.target.width/b.width)/this.resolution,f.global.y=(e.clientY-b.top)*(this.target.height/b.height)/this.resolution,!navigator.isCocoonJS||b.left||b.top||a.target.style.width||a.target.style.height||(f.global.x=e.clientX,f.global.y=e.clientY);for(var h=this.interactiveItems.length,i=0;h>i;i++){var j=this.interactiveItems[i];j.__touchData&&j.__touchData[e.identifier]&&(j.__hit=this.hitTest(j,j.__touchData[e.identifier]),f.originalEvent=a,(j.touchend||j.tap)&&(j.__hit&&!g?(j.touchend&&j.touchend(f),j.__isDown&&j.tap&&j.tap(f),j.interactiveChildren||(g=!0)):j.__isDown&&j.touchendoutside&&j.touchendoutside(f),j.__isDown=!1),j.__touchData[e.identifier]=null)}this.pool.push(f),this.touches[e.identifier]=null}},d.Stage=function(a){d.DisplayObjectContainer.call(this),this.worldTransform=new d.Matrix,this.interactive=!0,this.interactionManager=new d.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new d.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(a)},d.Stage.prototype=Object.create(d.DisplayObjectContainer.prototype),d.Stage.prototype.constructor=d.Stage,d.Stage.prototype.setInteractionDelegate=function(a){this.interactionManager.setTargetDomElement(a)},d.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},d.Stage.prototype.setBackgroundColor=function(a){this.backgroundColor=a||0,this.backgroundColorSplit=d.hex2rgb(this.backgroundColor);var b=this.backgroundColor.toString(16);b="000000".substr(0,6-b.length)+b,this.backgroundColorString="#"+b},d.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},function(a){for(var b=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!a.requestAnimationFrame;++d)a.requestAnimationFrame=a[c[d]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[c[d]+"CancelAnimationFrame"]||a[c[d]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(c){var d=(new Date).getTime(),e=Math.max(0,16-(d-b)),f=a.setTimeout(function(){c(d+e)},e);return b=d+e,f}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)}),a.requestAnimFrame=a.requestAnimationFrame}(this),d.hex2rgb=function(a){return[(a>>16&255)/255,(a>>8&255)/255,(255&a)/255]},d.rgb2hex=function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(a){function b(){for(var d=arguments.length,f=new Array(d);d--;)f[d]=arguments[d];return f=e.concat(f),c.apply(this instanceof b?this:a,f)}var c=this,d=arguments.length-1,e=[];if(d>0)for(e.length=d;d--;)e[d]=arguments[d+1];if("function"!=typeof c)throw new TypeError;return b.prototype=function f(a){return a&&(f.prototype=a),this instanceof f?void 0:new f}(c.prototype),b}}()),d.AjaxRequest=function(){var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var b=0;b<a.length;b++)try{return new window.ActiveXObject(a[b])}catch(c){}},d.canUseNewCanvasBlendModes=function(){if("undefined"==typeof document)return!1;var a=document.createElement("canvas");a.width=1,a.height=1;var b=a.getContext("2d");return b.fillStyle="#000",b.fillRect(0,0,1,1),b.globalCompositeOperation="multiply",b.fillStyle="#fff",b.fillRect(0,0,1,1),0===b.getImageData(0,0,1,1).data[0]},d.getNextPowerOfTwo=function(a){if(a>0&&0===(a&a-1))return a;for(var b=1;a>b;)b<<=1;return b},d.isPowerOfTwo=function(a,b){return a>0&&0===(a&a-1)&&b>0&&0===(b&b-1)},d.EventTarget={call:function(a){a&&(a=a.prototype||a,d.EventTarget.mixin(a))},mixin:function(a){a.listeners=function(a){return this._listeners=this._listeners||{},this._listeners[a]?this._listeners[a].slice():[]},a.emit=a.dispatchEvent=function(a,b){if(this._listeners=this._listeners||{},"object"==typeof a&&(b=a,a=a.type),b&&b.__isEventObject===!0||(b=new d.Event(this,a,b)),this._listeners&&this._listeners[a]){var c,e=this._listeners[a].slice(0),f=e.length,g=e[0];for(c=0;f>c;g=e[++c])if(g.call(this,b),b.stoppedImmediate)return this;if(b.stopped)return this}return this.parent&&this.parent.emit&&this.parent.emit.call(this.parent,a,b),this},a.on=a.addEventListener=function(a,b){return this._listeners=this._listeners||{},(this._listeners[a]=this._listeners[a]||[]).push(b),this},a.once=function(a,b){function c(){b.apply(d.off(a,c),arguments)}this._listeners=this._listeners||{};var d=this;return c._originalHandler=b,this.on(a,c)},a.off=a.removeEventListener=function(a,b){if(this._listeners=this._listeners||{},!this._listeners[a])return this;for(var c=this._listeners[a],d=b?c.length:0;d-->0;)(c[d]===b||c[d]._originalHandler===b)&&c.splice(d,1);return 0===c.length&&delete this._listeners[a],this},a.removeAllListeners=function(a){return this._listeners=this._listeners||{},this._listeners[a]?(delete this._listeners[a],this):this}}},d.Event=function(a,b,c){this.__isEventObject=!0,this.stopped=!1,this.stoppedImmediate=!1,this.target=a,this.type=b,this.data=c,this.content=c,this.timeStamp=Date.now()},d.Event.prototype.stopPropagation=function(){this.stopped=!0},d.Event.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0},d.autoDetectRenderer=function(a,b,c){a||(a=800),b||(b=600);var e=function(){try{var a=document.createElement("canvas");return!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}();return e?new d.WebGLRenderer(a,b,c):new d.CanvasRenderer(a,b,c)},d.autoDetectRecommendedRenderer=function(a,b,c){a||(a=800),b||(b=600);var e=function(){try{var a=document.createElement("canvas");return!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}(),f=/Android/i.test(navigator.userAgent);return e&&!f?new d.WebGLRenderer(a,b,c):new d.CanvasRenderer(a,b,c)},d.PolyK={},d.PolyK.Triangulate=function(a){var b=!0,c=a.length>>1;if(3>c)return[];for(var e=[],f=[],g=0;c>g;g++)f.push(g);g=0;for(var h=c;h>3;){var i=f[(g+0)%h],j=f[(g+1)%h],k=f[(g+2)%h],l=a[2*i],m=a[2*i+1],n=a[2*j],o=a[2*j+1],p=a[2*k],q=a[2*k+1],r=!1;if(d.PolyK._convex(l,m,n,o,p,q,b)){r=!0;for(var s=0;h>s;s++){var t=f[s];if(t!==i&&t!==j&&t!==k&&d.PolyK._PointInTriangle(a[2*t],a[2*t+1],l,m,n,o,p,q)){r=!1;break}}}if(r)e.push(i,j,k),f.splice((g+1)%h,1),h--,g=0;else if(g++>3*h){if(!b)return null;for(e=[],f=[],g=0;c>g;g++)f.push(g);g=0,h=c,b=!1}}return e.push(f[0],f[1],f[2]),e},d.PolyK._PointInTriangle=function(a,b,c,d,e,f,g,h){var i=g-c,j=h-d,k=e-c,l=f-d,m=a-c,n=b-d,o=i*i+j*j,p=i*k+j*l,q=i*m+j*n,r=k*k+l*l,s=k*m+l*n,t=1/(o*r-p*p),u=(r*q-p*s)*t,v=(o*s-p*q)*t;return u>=0&&v>=0&&1>u+v},d.PolyK._convex=function(a,b,c,d,e,f,g){return(b-d)*(e-c)+(c-a)*(f-d)>=0===g},d.initDefaultShaders=function(){},d.CompileVertexShader=function(a,b){return d._CompileShader(a,b,a.VERTEX_SHADER)},d.CompileFragmentShader=function(a,b){return d._CompileShader(a,b,a.FRAGMENT_SHADER)},d._CompileShader=function(a,b,c){var d=b.join("\n"),e=a.createShader(c);return a.shaderSource(e,d),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(window.console.log(a.getShaderInfoLog(e)),null)},d.compileProgram=function(a,b,c){var e=d.CompileFragmentShader(a,c),f=d.CompileVertexShader(a,b),g=a.createProgram();return a.attachShader(g,f),a.attachShader(g,e),a.linkProgram(g),a.getProgramParameter(g,a.LINK_STATUS)||window.console.log("Could not initialise shaders"),g},d.PixiShader=function(a){this._UID=d._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.firstRun=!0,this.dirty=!0,this.attributes=[],this.init()},d.PixiShader.prototype.constructor=d.PixiShader,d.PixiShader.prototype.init=function(){var a=this.gl,b=d.compileProgram(a,this.vertexSrc||d.PixiShader.defaultVertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.dimensions=a.getUniformLocation(b,"dimensions"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.colorAttribute=a.getAttribLocation(b,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var c in this.uniforms)this.uniforms[c].uniformLocation=a.getUniformLocation(b,c);this.initUniforms(),this.program=b},d.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var a,b=this.gl;for(var c in this.uniforms){a=this.uniforms[c];var d=a.type;"sampler2D"===d?(a._init=!1,null!==a.value&&this.initSampler2D(a)):"mat2"===d||"mat3"===d||"mat4"===d?(a.glMatrix=!0,a.glValueLength=1,"mat2"===d?a.glFunc=b.uniformMatrix2fv:"mat3"===d?a.glFunc=b.uniformMatrix3fv:"mat4"===d&&(a.glFunc=b.uniformMatrix4fv)):(a.glFunc=b["uniform"+d],a.glValueLength="2f"===d||"2i"===d?2:"3f"===d||"3i"===d?3:"4f"===d||"4i"===d?4:1)}},d.PixiShader.prototype.initSampler2D=function(a){if(a.value&&a.value.baseTexture&&a.value.baseTexture.hasLoaded){var b=this.gl;if(b.activeTexture(b["TEXTURE"+this.textureCount]),b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]),a.textureData){var c=a.textureData,d=c.magFilter?c.magFilter:b.LINEAR,e=c.minFilter?c.minFilter:b.LINEAR,f=c.wrapS?c.wrapS:b.CLAMP_TO_EDGE,g=c.wrapT?c.wrapT:b.CLAMP_TO_EDGE,h=c.luminance?b.LUMINANCE:b.RGBA;if(c.repeat&&(f=b.REPEAT,g=b.REPEAT),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!!c.flipY),c.width){var i=c.width?c.width:512,j=c.height?c.height:2,k=c.border?c.border:0;b.texImage2D(b.TEXTURE_2D,0,h,i,j,k,h,b.UNSIGNED_BYTE,null)}else b.texImage2D(b.TEXTURE_2D,0,h,b.RGBA,b.UNSIGNED_BYTE,a.value.baseTexture.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,f),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,g)}b.uniform1i(a.uniformLocation,this.textureCount),a._init=!0,this.textureCount++}},d.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var a,b=this.gl;for(var c in this.uniforms)a=this.uniforms[c],1===a.glValueLength?a.glMatrix===!0?a.glFunc.call(b,a.uniformLocation,a.transpose,a.value):a.glFunc.call(b,a.uniformLocation,a.value):2===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y):3===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z):4===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z,a.value.w):"sampler2D"===a.type&&(a._init?(b.activeTexture(b["TEXTURE"+this.textureCount]),a.value.baseTexture._dirty[b.id]?d.instances[b.id].updateTexture(a.value.baseTexture):b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]),b.uniform1i(a.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(a))},d.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},d.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"],d.PixiFastShader=function(a){this._UID=d._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},d.PixiFastShader.prototype.constructor=d.PixiFastShader,d.PixiFastShader.prototype.init=function(){var a=this.gl,b=d.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.dimensions=a.getUniformLocation(b,"dimensions"),this.uMatrix=a.getUniformLocation(b,"uMatrix"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aPositionCoord=a.getAttribLocation(b,"aPositionCoord"),this.aScale=a.getAttribLocation(b,"aScale"),this.aRotation=a.getAttribLocation(b,"aRotation"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.colorAttribute=a.getAttribLocation(b,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=b},d.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},d.StripShader=function(a){this._UID=d._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},d.StripShader.prototype.constructor=d.StripShader,d.StripShader.prototype.init=function(){var a=this.gl,b=d.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.colorAttribute=a.getAttribLocation(b,"aColor"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},d.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},d.PrimitiveShader=function(a){this._UID=d._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},d.PrimitiveShader.prototype.constructor=d.PrimitiveShader,d.PrimitiveShader.prototype.init=function(){var a=this.gl,b=d.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.tintColor=a.getUniformLocation(b,"tint"),this.flipY=a.getUniformLocation(b,"flipY"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.colorAttribute=a.getAttribLocation(b,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},d.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},d.ComplexPrimitiveShader=function(a){this._UID=d._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},d.ComplexPrimitiveShader.prototype.constructor=d.ComplexPrimitiveShader,d.ComplexPrimitiveShader.prototype.init=function(){var a=this.gl,b=d.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.tintColor=a.getUniformLocation(b,"tint"),this.color=a.getUniformLocation(b,"color"),this.flipY=a.getUniformLocation(b,"flipY"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},d.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},d.WebGLGraphics=function(){},d.WebGLGraphics.renderGraphics=function(a,b){var c,e=b.gl,f=b.projection,g=b.offset,h=b.shaderManager.primitiveShader;a.dirty&&d.WebGLGraphics.updateGraphics(a,e);for(var i=a._webGL[e.id],j=0;j<i.data.length;j++)1===i.data[j].mode?(c=i.data[j],b.stencilManager.pushStencil(a,c,b),e.drawElements(e.TRIANGLE_FAN,4,e.UNSIGNED_SHORT,2*(c.indices.length-4)),b.stencilManager.popStencil(a,c,b)):(c=i.data[j],b.shaderManager.setShader(h),h=b.shaderManager.primitiveShader,e.uniformMatrix3fv(h.translationMatrix,!1,a.worldTransform.toArray(!0)),e.uniform1f(h.flipY,1),e.uniform2f(h.projectionVector,f.x,-f.y),e.uniform2f(h.offsetVector,-g.x,-g.y),e.uniform3fv(h.tintColor,d.hex2rgb(a.tint)),e.uniform1f(h.alpha,a.worldAlpha),e.bindBuffer(e.ARRAY_BUFFER,c.buffer),e.vertexAttribPointer(h.aVertexPosition,2,e.FLOAT,!1,24,0),e.vertexAttribPointer(h.colorAttribute,4,e.FLOAT,!1,24,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c.indexBuffer),e.drawElements(e.TRIANGLE_STRIP,c.indices.length,e.UNSIGNED_SHORT,0))},d.WebGLGraphics.updateGraphics=function(a,b){var c=a._webGL[b.id];c||(c=a._webGL[b.id]={lastIndex:0,data:[],gl:b}),a.dirty=!1;var e;if(a.clearDirty){for(a.clearDirty=!1,e=0;e<c.data.length;e++){var f=c.data[e];f.reset(),d.WebGLGraphics.graphicsDataPool.push(f)}c.data=[],c.lastIndex=0}var g;for(e=c.lastIndex;e<a.graphicsData.length;e++){var h=a.graphicsData[e];if(h.type===d.Graphics.POLY){if(h.points=h.shape.points.slice(),h.shape.closed&&(h.points[0]!==h.points[h.points.length-2]||h.points[1]!==h.points[h.points.length-1])&&h.points.push(h.points[0],h.points[1]),h.fill&&h.points.length>=6)if(h.points.length<12){g=d.WebGLGraphics.switchMode(c,0);var i=d.WebGLGraphics.buildPoly(h,g);i||(g=d.WebGLGraphics.switchMode(c,1),d.WebGLGraphics.buildComplexPoly(h,g))}else g=d.WebGLGraphics.switchMode(c,1),d.WebGLGraphics.buildComplexPoly(h,g);h.lineWidth>0&&(g=d.WebGLGraphics.switchMode(c,0),d.WebGLGraphics.buildLine(h,g))}else g=d.WebGLGraphics.switchMode(c,0),h.type===d.Graphics.RECT?d.WebGLGraphics.buildRectangle(h,g):h.type===d.Graphics.CIRC||h.type===d.Graphics.ELIP?d.WebGLGraphics.buildCircle(h,g):h.type===d.Graphics.RREC&&d.WebGLGraphics.buildRoundedRectangle(h,g);c.lastIndex++}for(e=0;e<c.data.length;e++)g=c.data[e],g.dirty&&g.upload()},d.WebGLGraphics.switchMode=function(a,b){var c;return a.data.length?(c=a.data[a.data.length-1],(c.mode!==b||1===b)&&(c=d.WebGLGraphics.graphicsDataPool.pop()||new d.WebGLGraphicsData(a.gl),c.mode=b,a.data.push(c))):(c=d.WebGLGraphics.graphicsDataPool.pop()||new d.WebGLGraphicsData(a.gl),c.mode=b,a.data.push(c)),c.dirty=!0,c},d.WebGLGraphics.buildRectangle=function(a,b){var c=a.shape,e=c.x,f=c.y,g=c.width,h=c.height;if(a.fill){var i=d.hex2rgb(a.fillColor),j=a.fillAlpha,k=i[0]*j,l=i[1]*j,m=i[2]*j,n=b.points,o=b.indices,p=n.length/6;n.push(e,f),n.push(k,l,m,j),n.push(e+g,f),n.push(k,l,m,j),n.push(e,f+h),n.push(k,l,m,j),n.push(e+g,f+h),n.push(k,l,m,j),o.push(p,p,p+1,p+2,p+3,p+3)}if(a.lineWidth){var q=a.points;a.points=[e,f,e+g,f,e+g,f+h,e,f+h,e,f],d.WebGLGraphics.buildLine(a,b),a.points=q}},d.WebGLGraphics.buildRoundedRectangle=function(a,b){var c=a.shape,e=c.x,f=c.y,g=c.width,h=c.height,i=c.radius,j=[];if(j.push(e,f+i),j=j.concat(d.WebGLGraphics.quadraticBezierCurve(e,f+h-i,e,f+h,e+i,f+h)),j=j.concat(d.WebGLGraphics.quadraticBezierCurve(e+g-i,f+h,e+g,f+h,e+g,f+h-i)),j=j.concat(d.WebGLGraphics.quadraticBezierCurve(e+g,f+i,e+g,f,e+g-i,f)),j=j.concat(d.WebGLGraphics.quadraticBezierCurve(e+i,f,e,f,e,f+i)),a.fill){var k=d.hex2rgb(a.fillColor),l=a.fillAlpha,m=k[0]*l,n=k[1]*l,o=k[2]*l,p=b.points,q=b.indices,r=p.length/6,s=d.PolyK.Triangulate(j),t=0;for(t=0;t<s.length;t+=3)q.push(s[t]+r),q.push(s[t]+r),q.push(s[t+1]+r),q.push(s[t+2]+r),q.push(s[t+2]+r);for(t=0;t<j.length;t++)p.push(j[t],j[++t],m,n,o,l)}if(a.lineWidth){var u=a.points;a.points=j,d.WebGLGraphics.buildLine(a,b),a.points=u}},d.WebGLGraphics.quadraticBezierCurve=function(a,b,c,d,e,f){function g(a,b,c){var d=b-a;return a+d*c}for(var h,i,j,k,l,m,n=20,o=[],p=0,q=0;n>=q;q++)p=q/n,h=g(a,c,p),i=g(b,d,p),j=g(c,e,p),k=g(d,f,p),l=g(h,j,p),m=g(i,k,p),o.push(l,m);return o},d.WebGLGraphics.buildCircle=function(a,b){var c,e,f=a.shape,g=f.x,h=f.y;a.type===d.Graphics.CIRC?(c=f.radius,e=f.radius):(c=f.width,e=f.height);var i=40,j=2*Math.PI/i,k=0;if(a.fill){var l=d.hex2rgb(a.fillColor),m=a.fillAlpha,n=l[0]*m,o=l[1]*m,p=l[2]*m,q=b.points,r=b.indices,s=q.length/6;for(r.push(s),k=0;i+1>k;k++)q.push(g,h,n,o,p,m),q.push(g+Math.sin(j*k)*c,h+Math.cos(j*k)*e,n,o,p,m),r.push(s++,s++);r.push(s-1)}if(a.lineWidth){var t=a.points;for(a.points=[],k=0;i+1>k;k++)a.points.push(g+Math.sin(j*k)*c,h+Math.cos(j*k)*e);d.WebGLGraphics.buildLine(a,b),a.points=t}},d.WebGLGraphics.buildLine=function(a,b){var c=0,e=a.points;if(0!==e.length){if(a.lineWidth%2)for(c=0;c<e.length;c++)e[c]+=.5;var f=new d.Point(e[0],e[1]),g=new d.Point(e[e.length-2],e[e.length-1]);if(f.x===g.x&&f.y===g.y){e=e.slice(),e.pop(),e.pop(),g=new d.Point(e[e.length-2],e[e.length-1]);var h=g.x+.5*(f.x-g.x),i=g.y+.5*(f.y-g.y);e.unshift(h,i),e.push(h,i)}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=b.points,H=b.indices,I=e.length/2,J=e.length,K=G.length/6,L=a.lineWidth/2,M=d.hex2rgb(a.lineColor),N=a.lineAlpha,O=M[0]*N,P=M[1]*N,Q=M[2]*N;for(l=e[0],m=e[1],n=e[2],o=e[3],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,G.push(l-r,m-s,O,P,Q,N),G.push(l+r,m+s,O,P,Q,N),c=1;I-1>c;c++)l=e[2*(c-1)],m=e[2*(c-1)+1],n=e[2*c],o=e[2*c+1],p=e[2*(c+1)],q=e[2*(c+1)+1],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,t=-(o-q),u=n-p,F=Math.sqrt(t*t+u*u),t/=F,u/=F,t*=L,u*=L,x=-s+m-(-s+o),y=-r+n-(-r+l),z=(-r+l)*(-s+o)-(-r+n)*(-s+m),A=-u+q-(-u+o),B=-t+n-(-t+p),C=(-t+p)*(-u+o)-(-t+n)*(-u+q),D=x*B-A*y,Math.abs(D)<.1?(D+=10.1,G.push(n-r,o-s,O,P,Q,N),G.push(n+r,o+s,O,P,Q,N)):(j=(y*C-B*z)/D,k=(A*z-x*C)/D,E=(j-n)*(j-n)+(k-o)+(k-o),E>19600?(v=r-t,w=s-u,F=Math.sqrt(v*v+w*w),v/=F,w/=F,v*=L,w*=L,G.push(n-v,o-w),G.push(O,P,Q,N),G.push(n+v,o+w),G.push(O,P,Q,N),G.push(n-v,o-w),G.push(O,P,Q,N),J++):(G.push(j,k),G.push(O,P,Q,N),G.push(n-(j-n),o-(k-o)),G.push(O,P,Q,N)));for(l=e[2*(I-2)],m=e[2*(I-2)+1],n=e[2*(I-1)],o=e[2*(I-1)+1],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,G.push(n-r,o-s),G.push(O,P,Q,N),G.push(n+r,o+s),G.push(O,P,Q,N),H.push(K),c=0;J>c;c++)H.push(K++);H.push(K-1)}},d.WebGLGraphics.buildComplexPoly=function(a,b){var c=a.points.slice();if(!(c.length<6)){var e=b.indices;b.points=c,b.alpha=a.fillAlpha,b.color=d.hex2rgb(a.fillColor);for(var f,g,h=1/0,i=-1/0,j=1/0,k=-1/0,l=0;l<c.length;l+=2)f=c[l],g=c[l+1],h=h>f?f:h,i=f>i?f:i,j=j>g?g:j,k=g>k?g:k;c.push(h,j,i,j,i,k,h,k);var m=c.length/2;for(l=0;m>l;l++)e.push(l)}},d.WebGLGraphics.buildPoly=function(a,b){var c=a.points;if(!(c.length<6)){var e=b.points,f=b.indices,g=c.length/2,h=d.hex2rgb(a.fillColor),i=a.fillAlpha,j=h[0]*i,k=h[1]*i,l=h[2]*i,m=d.PolyK.Triangulate(c);if(!m)return!1;var n=e.length/6,o=0;for(o=0;o<m.length;o+=3)f.push(m[o]+n),f.push(m[o]+n),f.push(m[o+1]+n),f.push(m[o+2]+n),f.push(m[o+2]+n);for(o=0;g>o;o++)e.push(c[2*o],c[2*o+1],j,k,l,i);return!0}},d.WebGLGraphics.graphicsDataPool=[],d.WebGLGraphicsData=function(a){this.gl=a,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},d.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[]},d.WebGLGraphicsData.prototype.upload=function(){var a=this.gl;this.glPoints=new d.Float32Array(this.points),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW),this.glIndicies=new d.Uint16Array(this.indices),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndicies,a.STATIC_DRAW),this.dirty=!1},d.glContexts=[],d.instances=[],d.WebGLRenderer=function(a,b,c){if(c)for(var e in d.defaultRenderOptions)"undefined"==typeof c[e]&&(c[e]=d.defaultRenderOptions[e]);else c=d.defaultRenderOptions;d.defaultRenderer||(d.sayHello("webGL"),d.defaultRenderer=this),this.type=d.WEBGL_RENDERER,this.resolution=c.resolution,this.transparent=c.transparent,this.autoResize=c.autoResize||!1,this.preserveDrawingBuffer=c.preserveDrawingBuffer,this.clearBeforeRender=c.clearBeforeRender,this.width=a||800,this.height=b||600,this.view=c.view||document.createElement("canvas"),this.contextLostBound=this.handleContextLost.bind(this),this.contextRestoredBound=this.handleContextRestored.bind(this
),this.view.addEventListener("webglcontextlost",this.contextLostBound,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredBound,!1),this._contextOptions={alpha:this.transparent,antialias:c.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer},this.projection=new d.Point,this.offset=new d.Point(0,0),this.shaderManager=new d.WebGLShaderManager,this.spriteBatch=new d.WebGLSpriteBatch,this.maskManager=new d.WebGLMaskManager,this.filterManager=new d.WebGLFilterManager,this.stencilManager=new d.WebGLStencilManager,this.blendModeManager=new d.WebGLBlendModeManager,this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},d.WebGLRenderer.prototype.constructor=d.WebGLRenderer,d.WebGLRenderer.prototype.initContext=function(){var a=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=a,!a)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=a.id=d.WebGLRenderer.glContextId++,d.glContexts[this.glContextId]=a,d.instances[this.glContextId]=this,a.disable(a.DEPTH_TEST),a.disable(a.CULL_FACE),a.enable(a.BLEND),this.shaderManager.setContext(a),this.spriteBatch.setContext(a),this.maskManager.setContext(a),this.filterManager.setContext(a),this.blendModeManager.setContext(a),this.stencilManager.setContext(a),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},d.WebGLRenderer.prototype.render=function(a){if(!this.contextLost){this.__stage!==a&&(a.interactive&&a.interactionManager.removeEvents(),this.__stage=a),a.updateTransform();var b=this.gl;a._interactive?a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this)):a._interactiveEventsAdded&&(a._interactiveEventsAdded=!1,a.interactionManager.setTarget(this)),b.viewport(0,0,this.width,this.height),b.bindFramebuffer(b.FRAMEBUFFER,null),this.clearBeforeRender&&(this.transparent?b.clearColor(0,0,0,0):b.clearColor(a.backgroundColorSplit[0],a.backgroundColorSplit[1],a.backgroundColorSplit[2],1),b.clear(b.COLOR_BUFFER_BIT)),this.renderDisplayObject(a,this.projection)}},d.WebGLRenderer.prototype.renderDisplayObject=function(a,b,c){this.renderSession.blendModeManager.setBlendMode(d.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.flipY=c?-1:1,this.renderSession.projection=b,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,c),a._renderWebGL(this.renderSession),this.spriteBatch.end()},d.WebGLRenderer.prototype.resize=function(a,b){this.width=a*this.resolution,this.height=b*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},d.WebGLRenderer.prototype.updateTexture=function(a){if(a.hasLoaded){var b=this.gl;return a._glTextures[b.id]||(a._glTextures[b.id]=b.createTexture()),b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===d.scaleModes.LINEAR?b.LINEAR:b.NEAREST),a.mipmap&&d.isPowerOfTwo(a.width,a.height)?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===d.scaleModes.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST),b.generateMipmap(b.TEXTURE_2D)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===d.scaleModes.LINEAR?b.LINEAR:b.NEAREST),a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),a._dirty[b.id]=!1,a._glTextures[b.id]}},d.WebGLRenderer.prototype.handleContextLost=function(a){a.preventDefault(),this.contextLost=!0},d.WebGLRenderer.prototype.handleContextRestored=function(){this.initContext();for(var a in d.TextureCache){var b=d.TextureCache[a].baseTexture;b._glTextures=[]}this.contextLost=!1},d.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLostBound),this.view.removeEventListener("webglcontextrestored",this.contextRestoredBound),d.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},d.WebGLRenderer.prototype.mapBlendModes=function(){var a=this.gl;d.blendModesWebGL||(d.blendModesWebGL=[],d.blendModesWebGL[d.blendModes.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.ADD]=[a.SRC_ALPHA,a.DST_ALPHA],d.blendModesWebGL[d.blendModes.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.SCREEN]=[a.SRC_ALPHA,a.ONE],d.blendModesWebGL[d.blendModes.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],d.blendModesWebGL[d.blendModes.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA])},d.WebGLRenderer.glContextId=0,d.WebGLBlendModeManager=function(){this.currentBlendMode=99999},d.WebGLBlendModeManager.prototype.constructor=d.WebGLBlendModeManager,d.WebGLBlendModeManager.prototype.setContext=function(a){this.gl=a},d.WebGLBlendModeManager.prototype.setBlendMode=function(a){if(this.currentBlendMode===a)return!1;this.currentBlendMode=a;var b=d.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(b[0],b[1]),!0},d.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},d.WebGLMaskManager=function(){},d.WebGLMaskManager.prototype.constructor=d.WebGLMaskManager,d.WebGLMaskManager.prototype.setContext=function(a){this.gl=a},d.WebGLMaskManager.prototype.pushMask=function(a,b){var c=b.gl;a.dirty&&d.WebGLGraphics.updateGraphics(a,c),a._webGL[c.id].data.length&&b.stencilManager.pushStencil(a,a._webGL[c.id].data[0],b)},d.WebGLMaskManager.prototype.popMask=function(a,b){var c=this.gl;b.stencilManager.popStencil(a,a._webGL[c.id].data[0],b)},d.WebGLMaskManager.prototype.destroy=function(){this.gl=null},d.WebGLStencilManager=function(){this.stencilStack=[],this.reverse=!0,this.count=0},d.WebGLStencilManager.prototype.setContext=function(a){this.gl=a},d.WebGLStencilManager.prototype.pushStencil=function(a,b,c){var d=this.gl;this.bindGraphics(a,b,c),0===this.stencilStack.length&&(d.enable(d.STENCIL_TEST),d.clear(d.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(b);var e=this.count;d.colorMask(!1,!1,!1,!1),d.stencilFunc(d.ALWAYS,0,255),d.stencilOp(d.KEEP,d.KEEP,d.INVERT),1===b.mode?(d.drawElements(d.TRIANGLE_FAN,b.indices.length-4,d.UNSIGNED_SHORT,0),this.reverse?(d.stencilFunc(d.EQUAL,255-e,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)):(d.stencilFunc(d.EQUAL,e,255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),this.reverse?d.stencilFunc(d.EQUAL,255-(e+1),255):d.stencilFunc(d.EQUAL,e+1,255),this.reverse=!this.reverse):(this.reverse?(d.stencilFunc(d.EQUAL,e,255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)):(d.stencilFunc(d.EQUAL,255-e,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,e+1,255):d.stencilFunc(d.EQUAL,255-(e+1),255)),d.colorMask(!0,!0,!0,!0),d.stencilOp(d.KEEP,d.KEEP,d.KEEP),this.count++},d.WebGLStencilManager.prototype.bindGraphics=function(a,b,c){this._currentGraphics=a;var e,f=this.gl,g=c.projection,h=c.offset;1===b.mode?(e=c.shaderManager.complexPrimitiveShader,c.shaderManager.setShader(e),f.uniform1f(e.flipY,c.flipY),f.uniformMatrix3fv(e.translationMatrix,!1,a.worldTransform.toArray(!0)),f.uniform2f(e.projectionVector,g.x,-g.y),f.uniform2f(e.offsetVector,-h.x,-h.y),f.uniform3fv(e.tintColor,d.hex2rgb(a.tint)),f.uniform3fv(e.color,b.color),f.uniform1f(e.alpha,a.worldAlpha*b.alpha),f.bindBuffer(f.ARRAY_BUFFER,b.buffer),f.vertexAttribPointer(e.aVertexPosition,2,f.FLOAT,!1,8,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,b.indexBuffer)):(e=c.shaderManager.primitiveShader,c.shaderManager.setShader(e),f.uniformMatrix3fv(e.translationMatrix,!1,a.worldTransform.toArray(!0)),f.uniform1f(e.flipY,c.flipY),f.uniform2f(e.projectionVector,g.x,-g.y),f.uniform2f(e.offsetVector,-h.x,-h.y),f.uniform3fv(e.tintColor,d.hex2rgb(a.tint)),f.uniform1f(e.alpha,a.worldAlpha),f.bindBuffer(f.ARRAY_BUFFER,b.buffer),f.vertexAttribPointer(e.aVertexPosition,2,f.FLOAT,!1,24,0),f.vertexAttribPointer(e.colorAttribute,4,f.FLOAT,!1,24,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,b.indexBuffer))},d.WebGLStencilManager.prototype.popStencil=function(a,b,c){var d=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)d.disable(d.STENCIL_TEST);else{var e=this.count;this.bindGraphics(a,b,c),d.colorMask(!1,!1,!1,!1),1===b.mode?(this.reverse=!this.reverse,this.reverse?(d.stencilFunc(d.EQUAL,255-(e+1),255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)):(d.stencilFunc(d.EQUAL,e+1,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),d.stencilFunc(d.ALWAYS,0,255),d.stencilOp(d.KEEP,d.KEEP,d.INVERT),d.drawElements(d.TRIANGLE_FAN,b.indices.length-4,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,e,255):d.stencilFunc(d.EQUAL,255-e,255)):(this.reverse?(d.stencilFunc(d.EQUAL,e+1,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)):(d.stencilFunc(d.EQUAL,255-(e+1),255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,e,255):d.stencilFunc(d.EQUAL,255-e,255)),d.colorMask(!0,!0,!0,!0),d.stencilOp(d.KEEP,d.KEEP,d.KEEP)}},d.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},d.WebGLShaderManager=function(){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var a=0;a<this.maxAttibs;a++)this.attribState[a]=!1;this.stack=[]},d.WebGLShaderManager.prototype.constructor=d.WebGLShaderManager,d.WebGLShaderManager.prototype.setContext=function(a){this.gl=a,this.primitiveShader=new d.PrimitiveShader(a),this.complexPrimitiveShader=new d.ComplexPrimitiveShader(a),this.defaultShader=new d.PixiShader(a),this.fastShader=new d.PixiFastShader(a),this.stripShader=new d.StripShader(a),this.setShader(this.defaultShader)},d.WebGLShaderManager.prototype.setAttribs=function(a){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(b=0;b<a.length;b++){var c=a[b];this.tempAttribState[c]=!0}var d=this.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.tempAttribState[b]?d.enableVertexAttribArray(b):d.disableVertexAttribArray(b))},d.WebGLShaderManager.prototype.setShader=function(a){return this._currentId===a._UID?!1:(this._currentId=a._UID,this.currentShader=a,this.gl.useProgram(a.program),this.setAttribs(a.attributes),!0)},d.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},d.WebGLSpriteBatch=function(){this.vertSize=5,this.size=2e3;var a=4*this.size*4*this.vertSize,b=6*this.size;this.vertices=new d.ArrayBuffer(a),this.positions=new d.Float32Array(this.vertices),this.colors=new d.Uint32Array(this.vertices),this.indices=new d.Uint16Array(b),this.lastIndexCount=0;for(var c=0,e=0;b>c;c+=6,e+=4)this.indices[c+0]=e+0,this.indices[c+1]=e+1,this.indices[c+2]=e+2,this.indices[c+3]=e+0,this.indices[c+4]=e+2,this.indices[c+5]=e+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.dirty=!0,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.defaultShader=new d.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])},d.WebGLSpriteBatch.prototype.setContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW),this.currentBlendMode=99999;var b=new d.PixiShader(a);b.fragmentSrc=this.defaultShader.fragmentSrc,b.uniforms={},b.init(),this.defaultShader.shaders[a.id]=b},d.WebGLSpriteBatch.prototype.begin=function(a){this.renderSession=a,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},d.WebGLSpriteBatch.prototype.end=function(){this.flush()},d.WebGLSpriteBatch.prototype.render=function(a){var b=a.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture);var c=b._uvs;if(c){var d,e,f,g,h=a.anchor.x,i=a.anchor.y;if(b.trim){var j=b.trim;e=j.x-h*j.width,d=e+b.crop.width,g=j.y-i*j.height,f=g+b.crop.height}else d=b.frame.width*(1-h),e=b.frame.width*-h,f=b.frame.height*(1-i),g=b.frame.height*-i;var k=4*this.currentBatchSize*this.vertSize,l=b.baseTexture.resolution,m=a.worldTransform,n=m.a/l,o=m.b/l,p=m.c/l,q=m.d/l,r=m.tx,s=m.ty,t=this.colors,u=this.positions;this.renderSession.roundPixels?(u[k]=n*e+p*g+r|0,u[k+1]=q*g+o*e+s|0,u[k+5]=n*d+p*g+r|0,u[k+6]=q*g+o*d+s|0,u[k+10]=n*d+p*f+r|0,u[k+11]=q*f+o*d+s|0,u[k+15]=n*e+p*f+r|0,u[k+16]=q*f+o*e+s|0):(u[k]=n*e+p*g+r,u[k+1]=q*g+o*e+s,u[k+5]=n*d+p*g+r,u[k+6]=q*g+o*d+s,u[k+10]=n*d+p*f+r,u[k+11]=q*f+o*d+s,u[k+15]=n*e+p*f+r,u[k+16]=q*f+o*e+s),u[k+2]=c.x0,u[k+3]=c.y0,u[k+7]=c.x1,u[k+8]=c.y1,u[k+12]=c.x2,u[k+13]=c.y2,u[k+17]=c.x3,u[k+18]=c.y3;var v=a.tint;t[k+4]=t[k+9]=t[k+14]=t[k+19]=(v>>16)+(65280&v)+((255&v)<<16)+(255*a.worldAlpha<<24),this.sprites[this.currentBatchSize++]=a}},d.WebGLSpriteBatch.prototype.renderTilingSprite=function(a){var b=a.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture),a._uvs||(a._uvs=new d.TextureUvs);var c=a._uvs;a.tilePosition.x%=b.baseTexture.width*a.tileScaleOffset.x,a.tilePosition.y%=b.baseTexture.height*a.tileScaleOffset.y;var e=a.tilePosition.x/(b.baseTexture.width*a.tileScaleOffset.x),f=a.tilePosition.y/(b.baseTexture.height*a.tileScaleOffset.y),g=a.width/b.baseTexture.width/(a.tileScale.x*a.tileScaleOffset.x),h=a.height/b.baseTexture.height/(a.tileScale.y*a.tileScaleOffset.y);c.x0=0-e,c.y0=0-f,c.x1=1*g-e,c.y1=0-f,c.x2=1*g-e,c.y2=1*h-f,c.x3=0-e,c.y3=1*h-f;var i=a.tint,j=(i>>16)+(65280&i)+((255&i)<<16)+(255*a.alpha<<24),k=this.positions,l=this.colors,m=a.width,n=a.height,o=a.anchor.x,p=a.anchor.y,q=m*(1-o),r=m*-o,s=n*(1-p),t=n*-p,u=4*this.currentBatchSize*this.vertSize,v=b.baseTexture.resolution,w=a.worldTransform,x=w.a/v,y=w.b/v,z=w.c/v,A=w.d/v,B=w.tx,C=w.ty;k[u++]=x*r+z*t+B,k[u++]=A*t+y*r+C,k[u++]=c.x0,k[u++]=c.y0,l[u++]=j,k[u++]=x*q+z*t+B,k[u++]=A*t+y*q+C,k[u++]=c.x1,k[u++]=c.y1,l[u++]=j,k[u++]=x*q+z*s+B,k[u++]=A*s+y*q+C,k[u++]=c.x2,k[u++]=c.y2,l[u++]=j,k[u++]=x*r+z*s+B,k[u++]=A*s+y*r+C,k[u++]=c.x3,k[u++]=c.y3,l[u++]=j,this.sprites[this.currentBatchSize++]=a},d.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a,b=this.gl;if(this.dirty){this.dirty=!1,b.activeTexture(b.TEXTURE0),b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a=this.defaultShader.shaders[b.id];var c=4*this.vertSize;b.vertexAttribPointer(a.aVertexPosition,2,b.FLOAT,!1,c,0),b.vertexAttribPointer(a.aTextureCoord,2,b.FLOAT,!1,c,8),b.vertexAttribPointer(a.colorAttribute,4,b.UNSIGNED_BYTE,!0,c,16)}if(this.currentBatchSize>.5*this.size)b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices);else{var e=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize);b.bufferSubData(b.ARRAY_BUFFER,0,e)}for(var f,g,h,i,j=0,k=0,l=null,m=this.renderSession.blendModeManager.currentBlendMode,n=null,o=!1,p=!1,q=0,r=this.currentBatchSize;r>q;q++){if(i=this.sprites[q],f=i.texture.baseTexture,g=i.blendMode,h=i.shader||this.defaultShader,o=m!==g,p=n!==h,(l!==f||o||p)&&(this.renderBatch(l,j,k),k=q,j=0,l=f,o&&(m=g,this.renderSession.blendModeManager.setBlendMode(m)),p)){n=h,a=n.shaders[b.id],a||(a=new d.PixiShader(b),a.fragmentSrc=n.fragmentSrc,a.uniforms=n.uniforms,a.init(),n.shaders[b.id]=a),this.renderSession.shaderManager.setShader(a),a.dirty&&a.syncUniforms();var s=this.renderSession.projection;b.uniform2f(a.projectionVector,s.x,s.y);var t=this.renderSession.offset;b.uniform2f(a.offsetVector,t.x,t.y)}j++}this.renderBatch(l,j,k),this.currentBatchSize=0}},d.WebGLSpriteBatch.prototype.renderBatch=function(a,b,c){if(0!==b){var d=this.gl;a._dirty[d.id]?this.renderSession.renderer.updateTexture(a):d.bindTexture(d.TEXTURE_2D,a._glTextures[d.id]),d.drawElements(d.TRIANGLES,6*b,d.UNSIGNED_SHORT,6*c*2),this.renderSession.drawCount++}},d.WebGLSpriteBatch.prototype.stop=function(){this.flush(),this.dirty=!0},d.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},d.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},d.WebGLFastSpriteBatch=function(a){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var b=4*this.size*this.vertSize,c=6*this.maxSize;this.vertices=new d.Float32Array(b),this.indices=new d.Uint16Array(c),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var e=0,f=0;c>e;e+=6,f+=4)this.indices[e+0]=f+0,this.indices[e+1]=f+1,this.indices[e+2]=f+2,this.indices[e+3]=f+0,this.indices[e+4]=f+2,this.indices[e+5]=f+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(a)},d.WebGLFastSpriteBatch.prototype.constructor=d.WebGLFastSpriteBatch,d.WebGLFastSpriteBatch.prototype.setContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW)},d.WebGLFastSpriteBatch.prototype.begin=function(a,b){this.renderSession=b,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=a.worldTransform.toArray(!0),this.start()},d.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},d.WebGLFastSpriteBatch.prototype.render=function(a){var b=a.children,c=b[0];if(c.texture._uvs){this.currentBaseTexture=c.texture.baseTexture,c.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(c.blendMode));for(var d=0,e=b.length;e>d;d++)this.renderSprite(b[d]);this.flush()}},d.WebGLFastSpriteBatch.prototype.renderSprite=function(a){if(a.visible&&(a.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=a.texture.baseTexture,a.texture._uvs))){var b,c,d,e,f,g,h,i,j=this.vertices;if(b=a.texture._uvs,c=a.texture.frame.width,d=a.texture.frame.height,a.texture.trim){var k=a.texture.trim;f=k.x-a.anchor.x*k.width,e=f+a.texture.crop.width,h=k.y-a.anchor.y*k.height,g=h+a.texture.crop.height}else e=a.texture.frame.width*(1-a.anchor.x),f=a.texture.frame.width*-a.anchor.x,g=a.texture.frame.height*(1-a.anchor.y),h=a.texture.frame.height*-a.anchor.y;i=4*this.currentBatchSize*this.vertSize,j[i++]=f,j[i++]=h,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x0,j[i++]=b.y1,j[i++]=a.alpha,j[i++]=e,j[i++]=h,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x1,j[i++]=b.y1,j[i++]=a.alpha,j[i++]=e,j[i++]=g,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x2,j[i++]=b.y2,j[i++]=a.alpha,j[i++]=f,j[i++]=g,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x3,j[i++]=b.y3,j[i++]=a.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},d.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl;if(this.currentBaseTexture._glTextures[a.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,a),a.bindTexture(a.TEXTURE_2D,this.currentBaseTexture._glTextures[a.id]),this.currentBatchSize>.5*this.size)a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices);else{var b=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);a.bufferSubData(a.ARRAY_BUFFER,0,b)}a.drawElements(a.TRIANGLES,6*this.currentBatchSize,a.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},d.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},d.WebGLFastSpriteBatch.prototype.start=function(){var a=this.gl;a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;a.uniform2f(this.shader.projectionVector,b.x,b.y),a.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var c=4*this.vertSize;a.vertexAttribPointer(this.shader.aVertexPosition,2,a.FLOAT,!1,c,0),a.vertexAttribPointer(this.shader.aPositionCoord,2,a.FLOAT,!1,c,8),a.vertexAttribPointer(this.shader.aScale,2,a.FLOAT,!1,c,16),a.vertexAttribPointer(this.shader.aRotation,1,a.FLOAT,!1,c,24),a.vertexAttribPointer(this.shader.aTextureCoord,2,a.FLOAT,!1,c,28),a.vertexAttribPointer(this.shader.colorAttribute,1,a.FLOAT,!1,c,36)},d.WebGLFilterManager=function(){this.filterStack=[],this.offsetX=0,this.offsetY=0},d.WebGLFilterManager.prototype.constructor=d.WebGLFilterManager,d.WebGLFilterManager.prototype.setContext=function(a){this.gl=a,this.texturePool=[],this.initShaderBuffers()},d.WebGLFilterManager.prototype.begin=function(a,b){this.renderSession=a,this.defaultShader=a.shaderManager.defaultShader;var c=this.renderSession.projection;this.width=2*c.x,this.height=2*-c.y,this.buffer=b},d.WebGLFilterManager.prototype.pushFilter=function(a){var b=this.gl,c=this.renderSession.projection,e=this.renderSession.offset;a._filterArea=a.target.filterArea||a.target.getBounds(),this.filterStack.push(a);var f=a.filterPasses[0];this.offsetX+=a._filterArea.x,this.offsetY+=a._filterArea.y;var g=this.texturePool.pop();g?g.resize(this.width,this.height):g=new d.FilterTexture(this.gl,this.width,this.height),b.bindTexture(b.TEXTURE_2D,g.texture);var h=a._filterArea,i=f.padding;h.x-=i,h.y-=i,h.width+=2*i,h.height+=2*i,h.x<0&&(h.x=0),h.width>this.width&&(h.width=this.width),h.y<0&&(h.y=0),h.height>this.height&&(h.height=this.height),b.bindFramebuffer(b.FRAMEBUFFER,g.frameBuffer),b.viewport(0,0,h.width,h.height),c.x=h.width/2,c.y=-h.height/2,e.x=-h.x,e.y=-h.y,b.colorMask(!0,!0,!0,!0),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),a._glFilterTexture=g},d.WebGLFilterManager.prototype.popFilter=function(){var a=this.gl,b=this.filterStack.pop(),c=b._filterArea,e=b._glFilterTexture,f=this.renderSession.projection,g=this.renderSession.offset;if(b.filterPasses.length>1){a.viewport(0,0,c.width,c.height),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=c.height,this.vertexArray[2]=c.width,this.vertexArray[3]=c.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=c.width,this.vertexArray[7]=0,a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=c.width/this.width,this.uvArray[5]=c.height/this.height,this.uvArray[6]=c.width/this.width,this.uvArray[7]=c.height/this.height,a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray);var h=e,i=this.texturePool.pop();i||(i=new d.FilterTexture(this.gl,this.width,this.height)),i.resize(this.width,this.height),a.bindFramebuffer(a.FRAMEBUFFER,i.frameBuffer),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.BLEND);for(var j=0;j<b.filterPasses.length-1;j++){var k=b.filterPasses[j];a.bindFramebuffer(a.FRAMEBUFFER,i.frameBuffer),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,h.texture),this.applyFilterPass(k,c,c.width,c.height);var l=h;h=i,i=l}a.enable(a.BLEND),e=h,this.texturePool.push(i)}var m=b.filterPasses[b.filterPasses.length-1];this.offsetX-=c.x,this.offsetY-=c.y;var n=this.width,o=this.height,p=0,q=0,r=this.buffer;if(0===this.filterStack.length)a.colorMask(!0,!0,!0,!0);else{var s=this.filterStack[this.filterStack.length-1];c=s._filterArea,n=c.width,o=c.height,p=c.x,q=c.y,r=s._glFilterTexture.frameBuffer}f.x=n/2,f.y=-o/2,g.x=p,g.y=q,c=b._filterArea;var t=c.x-p,u=c.y-q;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=t,this.vertexArray[1]=u+c.height,this.vertexArray[2]=t+c.width,this.vertexArray[3]=u+c.height,this.vertexArray[4]=t,this.vertexArray[5]=u,this.vertexArray[6]=t+c.width,this.vertexArray[7]=u,a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=c.width/this.width,this.uvArray[5]=c.height/this.height,this.uvArray[6]=c.width/this.width,this.uvArray[7]=c.height/this.height,a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray),a.viewport(0,0,n,o),a.bindFramebuffer(a.FRAMEBUFFER,r),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,e.texture),this.applyFilterPass(m,c,n,o),this.texturePool.push(e),b._glFilterTexture=null},d.WebGLFilterManager.prototype.applyFilterPass=function(a,b,c,e){var f=this.gl,g=a.shaders[f.id];g||(g=new d.PixiShader(f),g.fragmentSrc=a.fragmentSrc,g.uniforms=a.uniforms,g.init(),a.shaders[f.id]=g),this.renderSession.shaderManager.setShader(g),f.uniform2f(g.projectionVector,c/2,-e/2),f.uniform2f(g.offsetVector,0,0),a.uniforms.dimensions&&(a.uniforms.dimensions.value[0]=this.width,a.uniforms.dimensions.value[1]=this.height,a.uniforms.dimensions.value[2]=this.vertexArray[0],a.uniforms.dimensions.value[3]=this.vertexArray[5]),g.syncUniforms(),f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer),f.vertexAttribPointer(g.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer),f.vertexAttribPointer(g.aTextureCoord,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.vertexAttribPointer(g.colorAttribute,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),this.renderSession.drawCount++},d.WebGLFilterManager.prototype.initShaderBuffers=function(){var a=this.gl;this.vertexBuffer=a.createBuffer(),this.uvBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.vertexArray=new d.Float32Array([0,0,1,0,0,1,1,1]),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertexArray,a.STATIC_DRAW),this.uvArray=new d.Float32Array([0,0,1,0,0,1,1,1]),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),a.bufferData(a.ARRAY_BUFFER,this.uvArray,a.STATIC_DRAW),this.colorArray=new d.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer),a.bufferData(a.ARRAY_BUFFER,this.colorArray,a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),a.STATIC_DRAW)},d.WebGLFilterManager.prototype.destroy=function(){var a=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var b=0;b<this.texturePool.length;b++)this.texturePool[b].destroy();this.texturePool=null,a.deleteBuffer(this.vertexBuffer),a.deleteBuffer(this.uvBuffer),a.deleteBuffer(this.colorBuffer),a.deleteBuffer(this.indexBuffer)},d.FilterTexture=function(a,b,c,e){this.gl=a,this.frameBuffer=a.createFramebuffer(),this.texture=a.createTexture(),e=e||d.scaleModes.DEFAULT,a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e===d.scaleModes.LINEAR?a.LINEAR:a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,e===d.scaleModes.LINEAR?a.LINEAR:a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0),this.renderBuffer=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,this.renderBuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.renderBuffer),this.resize(b,c)},d.FilterTexture.prototype.constructor=d.FilterTexture,d.FilterTexture.prototype.clear=function(){var a=this.gl;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},d.FilterTexture.prototype.resize=function(a,b){if(this.width!==a||this.height!==b){this.width=a,this.height=b;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a,b,0,c.RGBA,c.UNSIGNED_BYTE,null),c.bindRenderbuffer(c.RENDERBUFFER,this.renderBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,a,b)}},d.FilterTexture.prototype.destroy=function(){var a=this.gl;a.deleteFramebuffer(this.frameBuffer),a.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},d.CanvasBuffer=function(a,b){this.width=a,this.height=b,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=a,this.canvas.height=b},d.CanvasBuffer.prototype.constructor=d.CanvasBuffer,d.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},d.CanvasBuffer.prototype.resize=function(a,b){this.width=this.canvas.width=a,this.height=this.canvas.height=b},d.CanvasMaskManager=function(){},d.CanvasMaskManager.prototype.constructor=d.CanvasMaskManager,d.CanvasMaskManager.prototype.pushMask=function(a,b){var c=b.context;c.save();var e=a.alpha,f=a.worldTransform,g=b.resolution;c.setTransform(f.a*g,f.b*g,f.c*g,f.d*g,f.tx*g,f.ty*g),d.CanvasGraphics.renderGraphicsMask(a,c),c.clip(),a.worldAlpha=e},d.CanvasMaskManager.prototype.popMask=function(a){a.context.restore()},d.CanvasTinter=function(){},d.CanvasTinter.getTintedTexture=function(a,b){var c=a.texture;b=d.CanvasTinter.roundColor(b);var e="#"+("00000"+(0|b).toString(16)).substr(-6);if(c.tintCache=c.tintCache||{},c.tintCache[e])return c.tintCache[e];var f=d.CanvasTinter.canvas||document.createElement("canvas");if(d.CanvasTinter.tintMethod(c,b,f),d.CanvasTinter.convertTintToImage){var g=new Image;g.src=f.toDataURL(),c.tintCache[e]=g}else c.tintCache[e]=f,d.CanvasTinter.canvas=null;return f},d.CanvasTinter.tintWithMultiply=function(a,b,c){var d=c.getContext("2d"),e=a.crop;c.width=e.width,c.height=e.height,d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="multiply",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},d.CanvasTinter.tintWithOverlay=function(a,b,c){var d=c.getContext("2d"),e=a.crop;c.width=e.width,c.height=e.height,d.globalCompositeOperation="copy",d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage
(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},d.CanvasTinter.tintWithPerPixel=function(a,b,c){var e=c.getContext("2d"),f=a.crop;c.width=f.width,c.height=f.height,e.globalCompositeOperation="copy",e.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height);for(var g=d.hex2rgb(b),h=g[0],i=g[1],j=g[2],k=e.getImageData(0,0,f.width,f.height),l=k.data,m=0;m<l.length;m+=4)l[m+0]*=h,l[m+1]*=i,l[m+2]*=j;e.putImageData(k,0,0)},d.CanvasTinter.roundColor=function(a){var b=d.CanvasTinter.cacheStepsPerColorChannel,c=d.hex2rgb(a);return c[0]=Math.min(255,c[0]/b*b),c[1]=Math.min(255,c[1]/b*b),c[2]=Math.min(255,c[2]/b*b),d.rgb2hex(c)},d.CanvasTinter.cacheStepsPerColorChannel=8,d.CanvasTinter.convertTintToImage=!1,d.CanvasTinter.canUseMultiply=d.canUseNewCanvasBlendModes(),d.CanvasTinter.tintMethod=d.CanvasTinter.canUseMultiply?d.CanvasTinter.tintWithMultiply:d.CanvasTinter.tintWithPerPixel,d.CanvasRenderer=function(a,b,c){if(c)for(var e in d.defaultRenderOptions)"undefined"==typeof c[e]&&(c[e]=d.defaultRenderOptions[e]);else c=d.defaultRenderOptions;d.defaultRenderer||(d.sayHello("Canvas"),d.defaultRenderer=this),this.type=d.CANVAS_RENDERER,this.resolution=c.resolution,this.clearBeforeRender=c.clearBeforeRender,this.transparent=c.transparent,this.autoResize=c.autoResize||!1,this.width=a||800,this.height=b||600,this.width*=this.resolution,this.height*=this.resolution,this.view=c.view||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width*this.resolution,this.view.height=this.height*this.resolution,this.count=0,this.maskManager=new d.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},this.mapBlendModes(),this.resize(a,b),"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")},d.CanvasRenderer.prototype.constructor=d.CanvasRenderer,d.CanvasRenderer.prototype.render=function(a){a.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=d.blendModes.NORMAL,this.context.globalCompositeOperation=d.blendModesCanvas[d.blendModes.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=a.backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(a),a.interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this)))},d.CanvasRenderer.prototype.destroy=function(a){"undefined"==typeof a&&(a=!0),a&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},d.CanvasRenderer.prototype.resize=function(a,b){this.width=a*this.resolution,this.height=b*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},d.CanvasRenderer.prototype.renderDisplayObject=function(a,b){this.renderSession.context=b||this.context,this.renderSession.resolution=this.resolution,a._renderCanvas(this.renderSession)},d.CanvasRenderer.prototype.mapBlendModes=function(){d.blendModesCanvas||(d.blendModesCanvas=[],d.canUseNewCanvasBlendModes()?(d.blendModesCanvas[d.blendModes.NORMAL]="source-over",d.blendModesCanvas[d.blendModes.ADD]="lighter",d.blendModesCanvas[d.blendModes.MULTIPLY]="multiply",d.blendModesCanvas[d.blendModes.SCREEN]="screen",d.blendModesCanvas[d.blendModes.OVERLAY]="overlay",d.blendModesCanvas[d.blendModes.DARKEN]="darken",d.blendModesCanvas[d.blendModes.LIGHTEN]="lighten",d.blendModesCanvas[d.blendModes.COLOR_DODGE]="color-dodge",d.blendModesCanvas[d.blendModes.COLOR_BURN]="color-burn",d.blendModesCanvas[d.blendModes.HARD_LIGHT]="hard-light",d.blendModesCanvas[d.blendModes.SOFT_LIGHT]="soft-light",d.blendModesCanvas[d.blendModes.DIFFERENCE]="difference",d.blendModesCanvas[d.blendModes.EXCLUSION]="exclusion",d.blendModesCanvas[d.blendModes.HUE]="hue",d.blendModesCanvas[d.blendModes.SATURATION]="saturation",d.blendModesCanvas[d.blendModes.COLOR]="color",d.blendModesCanvas[d.blendModes.LUMINOSITY]="luminosity"):(d.blendModesCanvas[d.blendModes.NORMAL]="source-over",d.blendModesCanvas[d.blendModes.ADD]="lighter",d.blendModesCanvas[d.blendModes.MULTIPLY]="source-over",d.blendModesCanvas[d.blendModes.SCREEN]="source-over",d.blendModesCanvas[d.blendModes.OVERLAY]="source-over",d.blendModesCanvas[d.blendModes.DARKEN]="source-over",d.blendModesCanvas[d.blendModes.LIGHTEN]="source-over",d.blendModesCanvas[d.blendModes.COLOR_DODGE]="source-over",d.blendModesCanvas[d.blendModes.COLOR_BURN]="source-over",d.blendModesCanvas[d.blendModes.HARD_LIGHT]="source-over",d.blendModesCanvas[d.blendModes.SOFT_LIGHT]="source-over",d.blendModesCanvas[d.blendModes.DIFFERENCE]="source-over",d.blendModesCanvas[d.blendModes.EXCLUSION]="source-over",d.blendModesCanvas[d.blendModes.HUE]="source-over",d.blendModesCanvas[d.blendModes.SATURATION]="source-over",d.blendModesCanvas[d.blendModes.COLOR]="source-over",d.blendModesCanvas[d.blendModes.LUMINOSITY]="source-over"))},d.CanvasGraphics=function(){},d.CanvasGraphics.renderGraphics=function(a,b){var c=a.worldAlpha;a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);for(var e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=f.shape,h=f._fillTint,i=f._lineTint;if(b.lineWidth=f.lineWidth,f.type===d.Graphics.POLY){b.beginPath();var j=g.points;b.moveTo(j[0],j[1]);for(var k=1;k<j.length/2;k++)b.lineTo(j[2*k],j[2*k+1]);g.closed&&b.lineTo(j[0],j[1]),j[0]===j[j.length-2]&&j[1]===j[j.length-1]&&b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}else if(f.type===d.Graphics.RECT)(f.fillColor||0===f.fillColor)&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fillRect(g.x,g.y,g.width,g.height)),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.strokeRect(g.x,g.y,g.width,g.height));else if(f.type===d.Graphics.CIRC)b.beginPath(),b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke());else if(f.type===d.Graphics.ELIP){var l=2*g.width,m=2*g.height,n=g.x-l/2,o=g.y-m/2;b.beginPath();var p=.5522848,q=l/2*p,r=m/2*p,s=n+l,t=o+m,u=n+l/2,v=o+m/2;b.moveTo(n,v),b.bezierCurveTo(n,v-r,u-q,o,u,o),b.bezierCurveTo(u+q,o,s,v-r,s,v),b.bezierCurveTo(s,v+r,u+q,t,u,t),b.bezierCurveTo(u-q,t,n,v+r,n,v),b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}else if(f.type===d.Graphics.RREC){var w=g.x,x=g.y,y=g.width,z=g.height,A=g.radius,B=Math.min(y,z)/2|0;A=A>B?B:A,b.beginPath(),b.moveTo(w,x+A),b.lineTo(w,x+z-A),b.quadraticCurveTo(w,x+z,w+A,x+z),b.lineTo(w+y-A,x+z),b.quadraticCurveTo(w+y,x+z,w+y,x+z-A),b.lineTo(w+y,x+A),b.quadraticCurveTo(w+y,x,w+y-A,x),b.lineTo(w+A,x),b.quadraticCurveTo(w,x,w,x+A),b.closePath(),(f.fillColor||0===f.fillColor)&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}}},d.CanvasGraphics.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){c>1&&(c=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var e=0;1>e;e++){var f=a.graphicsData[e],g=f.shape;if(f.type===d.Graphics.POLY){b.beginPath();var h=g.points;b.moveTo(h[0],h[1]);for(var i=1;i<h.length/2;i++)b.lineTo(h[2*i],h[2*i+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&b.closePath()}else if(f.type===d.Graphics.RECT)b.beginPath(),b.rect(g.x,g.y,g.width,g.height),b.closePath();else if(f.type===d.Graphics.CIRC)b.beginPath(),b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath();else if(f.type===d.Graphics.ELIP){var j=2*g.width,k=2*g.height,l=g.x-j/2,m=g.y-k/2;b.beginPath();var n=.5522848,o=j/2*n,p=k/2*n,q=l+j,r=m+k,s=l+j/2,t=m+k/2;b.moveTo(l,t),b.bezierCurveTo(l,t-p,s-o,m,s,m),b.bezierCurveTo(s+o,m,q,t-p,q,t),b.bezierCurveTo(q,t+p,s+o,r,s,r),b.bezierCurveTo(s-o,r,l,t+p,l,t),b.closePath()}else if(f.type===d.Graphics.RREC){var u=g.points,v=u[0],w=u[1],x=u[2],y=u[3],z=u[4],A=Math.min(x,y)/2|0;z=z>A?A:z,b.beginPath(),b.moveTo(v,w+z),b.lineTo(v,w+y-z),b.quadraticCurveTo(v,w+y,v+z,w+y),b.lineTo(v+x-z,w+y),b.quadraticCurveTo(v+x,w+y,v+x,w+y-z),b.lineTo(v+x,w+z),b.quadraticCurveTo(v+x,w,v+x-z,w),b.lineTo(v+z,w),b.quadraticCurveTo(v,w,v,w+z),b.closePath()}}}},d.CanvasGraphics.updateGraphicsTint=function(a){if(16777215!==a.tint)for(var b=(a.tint>>16&255)/255,c=(a.tint>>8&255)/255,d=(255&a.tint)/255,e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=0|f.fillColor,h=0|f.lineColor;f._fillTint=((g>>16&255)/255*b*255<<16)+((g>>8&255)/255*c*255<<8)+(255&g)/255*d*255,f._lineTint=((h>>16&255)/255*b*255<<16)+((h>>8&255)/255*c*255<<8)+(255&h)/255*d*255}},d.Graphics=function(){d.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=d.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new d.Rectangle(0,0,1,1),this.dirty=!0,this.webGLDirty=!1,this.cachedSpriteDirty=!1},d.Graphics.prototype=Object.create(d.DisplayObjectContainer.prototype),d.Graphics.prototype.constructor=d.Graphics,Object.defineProperty(d.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap=a,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),d.Graphics.prototype.lineStyle=function(a,b,c){if(this.lineWidth=a||0,this.lineColor=b||0,this.lineAlpha=arguments.length<3?1:c,this.currentPath){if(this.currentPath.shape.points.length)return this.drawShape(new d.Polygon(this.currentPath.shape.points.slice(-2))),this;this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha}return this},d.Graphics.prototype.moveTo=function(a,b){return this.drawShape(new d.Polygon([a,b])),this},d.Graphics.prototype.lineTo=function(a,b){return this.currentPath.shape.points.push(a,b),this.dirty=!0,this},d.Graphics.prototype.quadraticCurveTo=function(a,b,c,d){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var e,f,g=20,h=this.currentPath.shape.points;0===h.length&&this.moveTo(0,0);for(var i=h[h.length-2],j=h[h.length-1],k=0,l=1;g>=l;l++)k=l/g,e=i+(a-i)*k,f=j+(b-j)*k,h.push(e+(a+(c-a)*k-e)*k,f+(b+(d-b)*k-f)*k);return this.dirty=!0,this},d.Graphics.prototype.bezierCurveTo=function(a,b,c,d,e,f){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var g,h,i,j,k,l=20,m=this.currentPath.shape.points,n=m[m.length-2],o=m[m.length-1],p=0,q=1;l>=q;q++)p=q/l,g=1-p,h=g*g,i=h*g,j=p*p,k=j*p,m.push(i*n+3*h*p*a+3*g*j*c+k*e,i*o+3*h*p*b+3*g*j*d+k*f);return this.dirty=!0,this},d.Graphics.prototype.arcTo=function(a,b,c,d,e){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,b):this.moveTo(a,b);var f=this.currentPath.shape.points,g=f[f.length-2],h=f[f.length-1],i=h-b,j=g-a,k=d-b,l=c-a,m=Math.abs(i*l-j*k);if(1e-8>m||0===e)(f[f.length-2]!==a||f[f.length-1]!==b)&&f.push(a,b);else{var n=i*i+j*j,o=k*k+l*l,p=i*k+j*l,q=e*Math.sqrt(n)/m,r=e*Math.sqrt(o)/m,s=q*p/n,t=r*p/o,u=q*l+r*j,v=q*k+r*i,w=j*(r+s),x=i*(r+s),y=l*(q+t),z=k*(q+t),A=Math.atan2(x-v,w-u),B=Math.atan2(z-v,y-u);this.arc(u+a,v+b,e,A,B,j*k>l*i)}return this.dirty=!0,this},d.Graphics.prototype.arc=function(a,b,c,d,e,f){var g,h=a+Math.cos(d)*c,i=b+Math.sin(d)*c;if(this.currentPath?(g=this.currentPath.shape.points,0===g.length?g.push(h,i):(g[g.length-2]!==h||g[g.length-1]!==i)&&g.push(h,i)):(this.moveTo(h,i),g=this.currentPath.shape.points),d===e)return this;!f&&d>=e?e+=2*Math.PI:f&&e>=d&&(d+=2*Math.PI);var j=f?-1*(d-e):e-d,k=Math.abs(j)/(2*Math.PI)*40;if(0===j)return this;for(var l=j/(2*k),m=2*l,n=Math.cos(l),o=Math.sin(l),p=k-1,q=p%1/p,r=0;p>=r;r++){var s=r+q*r,t=l+d+m*s,u=Math.cos(t),v=-Math.sin(t);g.push((n*u+o*v)*c+a,(n*-v+o*u)*c+b)}return this.dirty=!0,this},d.Graphics.prototype.beginFill=function(a,b){return this.filling=!0,this.fillColor=a||0,this.fillAlpha=void 0===b?1:b,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},d.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},d.Graphics.prototype.drawRect=function(a,b,c,e){return this.drawShape(new d.Rectangle(a,b,c,e)),this},d.Graphics.prototype.drawRoundedRect=function(a,b,c,e,f){return this.drawShape(new d.RoundedRectangle(a,b,c,e,f)),this},d.Graphics.prototype.drawCircle=function(a,b,c){return this.drawShape(new d.Circle(a,b,c)),this},d.Graphics.prototype.drawEllipse=function(a,b,c,e){return this.drawShape(new d.Ellipse(a,b,c,e)),this},d.Graphics.prototype.drawPolygon=function(a){return a instanceof Array||(a=Array.prototype.slice.call(arguments)),this.drawShape(new d.Polygon(a)),this},d.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},d.Graphics.prototype.generateTexture=function(a,b){a=a||1;var c=this.getBounds(),e=new d.CanvasBuffer(c.width*a,c.height*a),f=d.Texture.fromCanvas(e.canvas,b);return f.baseTexture.resolution=a,e.context.scale(a,a),e.context.translate(-c.x,-c.y),d.CanvasGraphics.renderGraphics(this,e.context),f},d.Graphics.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,void d.Sprite.prototype._renderWebGL.call(this._cachedSprite,a);if(a.spriteBatch.stop(),a.blendModeManager.setBlendMode(this.blendMode),this._mask&&a.maskManager.pushMask(this._mask,a),this._filters&&a.filterManager.pushFilter(this._filterBlock),this.blendMode!==a.spriteBatch.currentBlendMode){a.spriteBatch.currentBlendMode=this.blendMode;var b=d.blendModesWebGL[a.spriteBatch.currentBlendMode];a.spriteBatch.gl.blendFunc(b[0],b[1])}if(this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),d.WebGLGraphics.renderGraphics(this,a),this.children.length){a.spriteBatch.start();for(var c=0,e=this.children.length;e>c;c++)this.children[c]._renderWebGL(a);a.spriteBatch.stop()}this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(this.mask,a),a.drawCount++,a.spriteBatch.start()}},d.Graphics.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void d.Sprite.prototype._renderCanvas.call(this._cachedSprite,a);var b=a.context,c=this.worldTransform;this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=d.blendModesCanvas[a.currentBlendMode]),this._mask&&a.maskManager.pushMask(this._mask,a);var e=a.resolution;b.setTransform(c.a*e,c.b*e,c.c*e,c.d*e,c.tx*e,c.ty*e),d.CanvasGraphics.renderGraphics(this,b);for(var f=0,g=this.children.length;g>f;f++)this.children[f]._renderCanvas(a);this._mask&&a.maskManager.popMask(a)}},d.Graphics.prototype.getBounds=function(a){if(this.isMask)return d.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var b=this._localBounds,c=b.x,e=b.width+b.x,f=b.y,g=b.height+b.y,h=a||this.worldTransform,i=h.a,j=h.b,k=h.c,l=h.d,m=h.tx,n=h.ty,o=i*e+k*g+m,p=l*g+j*e+n,q=i*c+k*g+m,r=l*g+j*c+n,s=i*c+k*f+m,t=l*f+j*c+n,u=i*e+k*f+m,v=l*f+j*e+n,w=o,x=p,y=o,z=p;return y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,z=z>r?r:z,z=z>t?t:z,z=z>v?v:z,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w,x=r>x?r:x,x=t>x?t:x,x=v>x?v:x,this._bounds.x=y,this._bounds.width=w-y,this._bounds.y=z,this._bounds.height=x-z,this._bounds},d.Graphics.prototype.updateLocalBounds=function(){var a=1/0,b=-1/0,c=1/0,e=-1/0;if(this.graphicsData.length)for(var f,g,h,i,j,k,l=0;l<this.graphicsData.length;l++){var m=this.graphicsData[l],n=m.type,o=m.lineWidth;if(f=m.shape,n===d.Graphics.RECT||n===d.Graphics.RREC)h=f.x-o/2,i=f.y-o/2,j=f.width+o,k=f.height+o,a=a>h?h:a,b=h+j>b?h+j:b,c=c>i?i:c,e=i+k>e?i+k:e;else if(n===d.Graphics.CIRC)h=f.x,i=f.y,j=f.radius+o/2,k=f.radius+o/2,a=a>h-j?h-j:a,b=h+j>b?h+j:b,c=c>i-k?i-k:c,e=i+k>e?i+k:e;else if(n===d.Graphics.ELIP)h=f.x,i=f.y,j=f.width+o/2,k=f.height+o/2,a=a>h-j?h-j:a,b=h+j>b?h+j:b,c=c>i-k?i-k:c,e=i+k>e?i+k:e;else{g=f.points;for(var p=0;p<g.length;p+=2)h=g[p],i=g[p+1],a=a>h-o?h-o:a,b=h+o>b?h+o:b,c=c>i-o?i-o:c,e=i+o>e?i+o:e}}else a=0,b=0,c=0,e=0;var q=this.boundsPadding;this._localBounds.x=a-q,this._localBounds.width=b-a+2*q,this._localBounds.y=c-q,this._localBounds.height=e-c+2*q},d.Graphics.prototype._generateCachedSprite=function(){var a=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(a.width,a.height);else{var b=new d.CanvasBuffer(a.width,a.height),c=d.Texture.fromCanvas(b.canvas);this._cachedSprite=new d.Sprite(c),this._cachedSprite.buffer=b,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(a.x/a.width),this._cachedSprite.anchor.y=-(a.y/a.height),this._cachedSprite.buffer.context.translate(-a.x,-a.y),this.worldAlpha=1,d.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},d.Graphics.prototype.updateCachedSpriteTexture=function(){var a=this._cachedSprite,b=a.texture,c=a.buffer.canvas;b.baseTexture.width=c.width,b.baseTexture.height=c.height,b.crop.width=b.frame.width=c.width,b.crop.height=b.frame.height=c.height,a._width=c.width,a._height=c.height,b.baseTexture.dirty()},d.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},d.Graphics.prototype.drawShape=function(a){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var b=new d.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);return this.graphicsData.push(b),b.type===d.Graphics.POLY&&(b.shape.closed=this.filling,this.currentPath=b),this.dirty=!0,b},d.GraphicsData=function(a,b,c,d,e,f,g){this.lineWidth=a,this.lineColor=b,this.lineAlpha=c,this._lineTint=b,this.fillColor=d,this.fillAlpha=e,this._fillTint=d,this.fill=f,this.shape=g,this.type=g.type},d.Graphics.POLY=0,d.Graphics.RECT=1,d.Graphics.CIRC=2,d.Graphics.ELIP=3,d.Graphics.RREC=4,d.Polygon.prototype.type=d.Graphics.POLY,d.Rectangle.prototype.type=d.Graphics.RECT,d.Circle.prototype.type=d.Graphics.CIRC,d.Ellipse.prototype.type=d.Graphics.ELIP,d.RoundedRectangle.prototype.type=d.Graphics.RREC,d.Strip=function(a){d.DisplayObjectContainer.call(this),this.texture=a,this.uvs=new d.Float32Array([0,1,1,1,1,0,0,1]),this.vertices=new d.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new d.Float32Array([1,1,1,1]),this.indices=new d.Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=d.blendModes.NORMAL,this.canvasPadding=0,this.drawMode=d.Strip.DrawModes.TRIANGLE_STRIP},d.Strip.prototype=Object.create(d.DisplayObjectContainer.prototype),d.Strip.prototype.constructor=d.Strip,d.Strip.prototype._renderWebGL=function(a){!this.visible||this.alpha<=0||(a.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(a),a.shaderManager.setShader(a.shaderManager.stripShader),this._renderStrip(a),a.spriteBatch.start())},d.Strip.prototype._initWebGL=function(a){var b=a.gl;this._vertexBuffer=b.createBuffer(),this._indexBuffer=b.createBuffer(),this._uvBuffer=b.createBuffer(),this._colorBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.vertices,b.DYNAMIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,this._colorBuffer),b.bufferData(b.ARRAY_BUFFER,this.colors,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW)},d.Strip.prototype._renderStrip=function(a){var b=a.gl,c=a.projection,e=a.offset,f=a.shaderManager.stripShader,g=this.drawMode===d.Strip.DrawModes.TRIANGLE_STRIP?b.TRIANGLE_STRIP:b.TRIANGLES;a.blendModeManager.setBlendMode(this.blendMode),b.uniformMatrix3fv(f.translationMatrix,!1,this.worldTransform.toArray(!0)),b.uniform2f(f.projectionVector,c.x,-c.y),b.uniform2f(f.offsetVector,-e.x,-e.y),b.uniform1f(f.alpha,this.worldAlpha),this.dirty?(this.dirty=!1,b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.vertices,b.STATIC_DRAW),b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW),b.vertexAttribPointer(f.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),this.texture.baseTexture._dirty[b.id]?a.renderer.updateTexture(this.texture.baseTexture):b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW)):(b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices),b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.vertexAttribPointer(f.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),this.texture.baseTexture._dirty[b.id]?a.renderer.updateTexture(this.texture.baseTexture):b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),b.drawElements(g,this.indices.length,b.UNSIGNED_SHORT,0)},d.Strip.prototype._renderCanvas=function(a){var b=a.context,c=this.worldTransform;a.roundPixels?b.setTransform(c.a,c.b,c.c,c.d,0|c.tx,0|c.ty):b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),this.drawMode===d.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(b):this._renderCanvasTriangles(b)},d.Strip.prototype._renderCanvasTriangleStrip=function(a){var b=this.vertices,c=this.uvs,d=b.length/2;this.count++;for(var e=0;d-2>e;e++){var f=2*e;this._renderCanvasDrawTriangle(a,b,c,f,f+2,f+4)}},d.Strip.prototype._renderCanvasTriangles=function(a){var b=this.vertices,c=this.uvs,d=this.indices,e=d.length;this.count++;for(var f=0;e>f;f+=3){var g=2*d[f],h=2*d[f+1],i=2*d[f+2];this._renderCanvasDrawTriangle(a,b,c,g,h,i)}},d.Strip.prototype._renderCanvasDrawTriangle=function(a,b,c,d,e,f){var g=this.texture.baseTexture.source,h=this.texture.width,i=this.texture.height,j=b[d],k=b[e],l=b[f],m=b[d+1],n=b[e+1],o=b[f+1],p=c[d]*h,q=c[e]*h,r=c[f]*h,s=c[d+1]*i,t=c[e+1]*i,u=c[f+1]*i;if(this.canvasPadding>0){var v=this.canvasPadding/this.worldTransform.a,w=this.canvasPadding/this.worldTransform.d,x=(j+k+l)/3,y=(m+n+o)/3,z=j-x,A=m-y,B=Math.sqrt(z*z+A*A);j=x+z/B*(B+v),m=y+A/B*(B+w),z=k-x,A=n-y,B=Math.sqrt(z*z+A*A),k=x+z/B*(B+v),n=y+A/B*(B+w),z=l-x,A=o-y,B=Math.sqrt(z*z+A*A),l=x+z/B*(B+v),o=y+A/B*(B+w)}a.save(),a.beginPath(),a.moveTo(j,m),a.lineTo(k,n),a.lineTo(l,o),a.closePath(),a.clip();var C=p*t+s*r+q*u-t*r-s*q-p*u,D=j*t+s*l+k*u-t*l-s*k-j*u,E=p*k+j*r+q*l-k*r-j*q-p*l,F=p*t*l+s*k*r+j*q*u-j*t*r-s*q*l-p*k*u,G=m*t+s*o+n*u-t*o-s*n-m*u,H=p*n+m*r+q*o-n*r-m*q-p*o,I=p*t*o+s*n*r+m*q*u-m*t*r-s*q*o-p*n*u;a.transform(D/C,G/C,E/C,H/C,F/C,I/C),a.drawImage(g,0,0),a.restore()},d.Strip.prototype.renderStripFlat=function(a){var b=this.context,c=a.vertices,d=c.length/2;this.count++,b.beginPath();for(var e=1;d-2>e;e++){var f=2*e,g=c[f],h=c[f+2],i=c[f+4],j=c[f+1],k=c[f+3],l=c[f+5];b.moveTo(g,j),b.lineTo(h,k),b.lineTo(i,l)}b.fillStyle="#FF0000",b.fill(),b.closePath()},d.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},d.Strip.prototype.getBounds=function(a){for(var b=a||this.worldTransform,c=b.a,e=b.b,f=b.c,g=b.d,h=b.tx,i=b.ty,j=-1/0,k=-1/0,l=1/0,m=1/0,n=this.vertices,o=0,p=n.length;p>o;o+=2){var q=n[o],r=n[o+1],s=c*q+f*r+h,t=g*r+e*q+i;l=l>s?s:l,m=m>t?t:m,j=s>j?s:j,k=t>k?t:k}if(l===-1/0||1/0===k)return d.EmptyRectangle;var u=this._bounds;return u.x=l,u.width=j-l,u.y=m,u.height=k-m,this._currentBounds=u,u},d.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1},d.Rope=function(a,b){d.Strip.call(this,a),this.points=b,this.vertices=new d.Float32Array(4*b.length),this.uvs=new d.Float32Array(4*b.length),this.colors=new d.Float32Array(2*b.length),this.indices=new d.Uint16Array(2*b.length),this.refresh()},d.Rope.prototype=Object.create(d.Strip.prototype),d.Rope.prototype.constructor=d.Rope,d.Rope.prototype.refresh=function(){var a=this.points;if(!(a.length<1)){var b=this.uvs,c=a[0],d=this.indices,e=this.colors;this.count-=.2,b[0]=0,b[1]=0,b[2]=0,b[3]=1,e[0]=1,e[1]=1,d[0]=0,d[1]=1;for(var f,g,h,i=a.length,j=1;i>j;j++)f=a[j],g=4*j,h=j/(i-1),j%2?(b[g]=h,b[g+1]=0,b[g+2]=h,b[g+3]=1):(b[g]=h,b[g+1]=0,b[g+2]=h,b[g+3]=1),g=2*j,e[g]=1,e[g+1]=1,g=2*j,d[g]=g,d[g+1]=g+1,c=f}},d.Rope.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){var b,c=a[0],e={x:0,y:0};this.count-=.2;for(var f,g,h,i,j,k=this.vertices,l=a.length,m=0;l>m;m++)f=a[m],g=4*m,b=m<a.length-1?a[m+1]:f,e.y=-(b.x-c.x),e.x=b.y-c.y,h=10*(1-m/(l-1)),h>1&&(h=1),i=Math.sqrt(e.x*e.x+e.y*e.y),j=this.texture.height/2,e.x/=i,e.y/=i,e.x*=j,e.y*=j,k[g]=f.x+e.x,k[g+1]=f.y+e.y,k[g+2]=f.x-e.x,k[g+3]=f.y-e.y,c=f;d.DisplayObjectContainer.prototype.updateTransform.call(this)}},d.Rope.prototype.setTexture=function(a){this.texture=a},d.TilingSprite=function(a,b,c){d.Sprite.call(this,a),this._width=b||100,this._height=c||100,this.tileScale=new d.Point(1,1),this.tileScaleOffset=new d.Point(1,1),this.tilePosition=new d.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=d.blendModes.NORMAL},d.TilingSprite.prototype=Object.create(d.Sprite.prototype),d.TilingSprite.prototype.constructor=d.TilingSprite,Object.defineProperty(d.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(a){this._width=a}}),Object.defineProperty(d.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(a){this._height=a}}),d.TilingSprite.prototype.setTexture=function(a){this.texture!==a&&(this.texture=a,this.refreshTexture=!0,this.cachedTint=16777215)},d.TilingSprite.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha){var b,c;for(this._mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start()),this._filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(a.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1)):a.spriteBatch.renderTilingSprite(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop(),this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(this._mask,a),a.spriteBatch.start()}},d.TilingSprite.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){var b=a.context;this._mask&&a.maskManager.pushMask(this._mask,b),b.globalAlpha=this.worldAlpha;var c,e,f=this.worldTransform,g=a.resolution;if(b.setTransform(f.a*g,f.b*g,f.c*g,f.d*g,f.tx*g,f.ty*g),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=b.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=d.blendModesCanvas[a.currentBlendMode]);var h=this.tilePosition,i=this.tileScale;for(h.x%=this.tilingTexture.baseTexture.width,h.y%=this.tilingTexture.baseTexture.height,b.scale(i.x,i.y),b.translate(h.x+this.anchor.x*-this._width,h.y+this.anchor.y*-this._height),b.fillStyle=this.__tilePattern,b.fillRect(-h.x,-h.y,this._width/i.x,this._height/i.y),b.scale(1/i.x,1/i.y),b.translate(-h.x+this.anchor.x*this._width,-h.y+this.anchor.y*this._height),this._mask&&a.maskManager.popMask(a.context),c=0,e=this.children.length;e>c;c++)this.children[c]._renderCanvas(a)}},d.TilingSprite.prototype.getBounds=function(){var a=this._width,b=this._height,c=a*(1-this.anchor.x),d=a*-this.anchor.x,e=b*(1-this.anchor.y),f=b*-this.anchor.y,g=this.worldTransform,h=g.a,i=g.b,j=g.c,k=g.d,l=g.tx,m=g.ty,n=h*d+j*f+l,o=k*f+i*d+m,p=h*c+j*f+l,q=k*f+i*c+m,r=h*c+j*e+l,s=k*e+i*c+m,t=h*d+j*e+l,u=k*e+i*d+m,v=-1/0,w=-1/0,x=1/0,y=1/0;x=x>n?n:x,x=x>p?p:x,x=x>r?r:x,x=x>t?t:x,y=y>o?o:y,y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,v=n>v?n:v,v=p>v?p:v,v=r>v?r:v,v=t>v?t:v,w=o>w?o:w,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w;var z=this._bounds;return z.x=x,z.width=v-x,z.y=y,z.height=w-y,this._currentBounds=z,z},d.TilingSprite.prototype.onTextureUpdate=function(){},d.TilingSprite.prototype.generateTilingTexture=function(a){if(this.texture.baseTexture.hasLoaded){var b,c,e=this.originalTexture||this.texture,f=e.frame,g=f.width!==e.baseTexture.width||f.height!==e.baseTexture.height,h=!1;if(a?(b=d.getNextPowerOfTwo(f.width),c=d.getNextPowerOfTwo(f.height),(f.width!==b||f.height!==c||e.baseTexture.width!==b||e.baseTexture.height||c)&&(h=!0)):g&&(b=f.width,c=f.height,h=!0),h){var i;this.tilingTexture&&this.tilingTexture.isTiling?(i=this.tilingTexture.canvasBuffer,i.resize(b,c),this.tilingTexture.baseTexture.width=b,this.tilingTexture.baseTexture.height=c,this.tilingTexture.needsUpdate=!0):(i=new d.CanvasBuffer(b,c),this.tilingTexture=d.Texture.fromCanvas(i.canvas),this.tilingTexture.canvasBuffer=i,this.tilingTexture.isTiling=!0),i.context.drawImage(e.baseTexture.source,e.crop.x,e.crop.y,e.crop.width,e.crop.height,0,0,b,c),this.tileScaleOffset.x=f.width/b,this.tileScaleOffset.y=f.height/c}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=e;this.refreshTexture=!1,this.originalTexture=this.texture,this.texture=this.tilingTexture,this.tilingTexture.baseTexture._powerOf2=!0}};var e={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};e.BoneData=function(a,b){this.name=a,this.parent=b},e.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1},e.SlotData=function(a,b){this.name=a,this.boneData=b},e.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:!1},e.IkConstraintData=function(a){this.name=a,this.bones=[]},e.IkConstraintData.prototype={target:null,bendDirection:1,mix:1},e.Bone=function(a,b,c){this.data=a,this.skeleton=b,this.parent=c,this.setToSetupPose()},e.Bone.yDown=!1,e.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var a=this.parent;if(a)this.worldX=this.x*a.m00+this.y*a.m01+a.worldX,this.worldY=this.x*a.m10+this.y*a.m11+a.worldY,this.data.inheritScale?(this.worldScaleX=a.worldScaleX*this.scaleX,this.worldScaleY=a.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?a.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=a.worldFlipX!=this.flipX,this.worldFlipY=a.worldFlipY!=this
.flipY;else{var b=this.skeleton.flipX,c=this.skeleton.flipY;this.worldX=b?-this.x:this.x,this.worldY=c!=e.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotationIK,this.worldFlipX=b!=this.flipX,this.worldFlipY=c!=this.flipY}var d=this.worldRotation*e.degRad,f=Math.cos(d),g=Math.sin(d);this.worldFlipX?(this.m00=-f*this.worldScaleX,this.m01=g*this.worldScaleY):(this.m00=f*this.worldScaleX,this.m01=-g*this.worldScaleY),this.worldFlipY!=e.Bone.yDown?(this.m10=-g*this.worldScaleX,this.m11=-f*this.worldScaleY):(this.m10=g*this.worldScaleX,this.m11=f*this.worldScaleY)},setToSetupPose:function(){var a=this.data;this.x=a.x,this.y=a.y,this.rotation=a.rotation,this.rotationIK=this.rotation,this.scaleX=a.scaleX,this.scaleY=a.scaleY,this.flipX=a.flipX,this.flipY=a.flipY},worldToLocal:function(a){var b=a[0]-this.worldX,c=a[1]-this.worldY,d=this.m00,f=this.m10,g=this.m01,h=this.m11;this.worldFlipX!=(this.worldFlipY!=e.Bone.yDown)&&(d=-d,h=-h);var i=1/(d*h-g*f);a[0]=b*d*i-c*g*i,a[1]=c*h*i-b*f*i},localToWorld:function(a){var b=a[0],c=a[1];a[0]=b*this.m00+c*this.m01+this.worldX,a[1]=b*this.m10+c*this.m11+this.worldY}},e.Slot=function(a,b){this.data=a,this.bone=b,this.setToSetupPose()},e.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(a){this.attachment=a,this._attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0},setAttachmentTime:function(a){this._attachmentTime=this.bone.skeleton.time-a},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;for(var b=this.bone.skeleton.data.slots,c=0,d=b.length;d>c;c++)if(b[c]==a){this.setAttachment(a.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(c,a.attachmentName):null);break}}},e.IkConstraint=function(a,b){this.data=a,this.mix=a.mix,this.bendDirection=a.bendDirection,this.bones=[];for(var c=0,d=a.bones.length;d>c;c++)this.bones.push(b.findBone(a.bones[c].name));this.target=b.findBone(a.target.name)},e.IkConstraint.prototype={apply:function(){var a=this.target,b=this.bones;switch(b.length){case 1:e.IkConstraint.apply1(b[0],a.worldX,a.worldY,this.mix);break;case 2:e.IkConstraint.apply2(b[0],b[1],a.worldX,a.worldY,this.bendDirection,this.mix)}}},e.IkConstraint.apply1=function(a,b,c,d){var f=a.data.inheritRotation&&a.parent?a.parent.worldRotation:0,g=a.rotation,h=Math.atan2(c-a.worldY,b-a.worldX)*e.radDeg-f;a.rotationIK=g+(h-g)*d},e.IkConstraint.apply2=function(a,b,c,d,f,g){var h=b.rotation,i=a.rotation;if(!g)return b.rotationIK=h,void (a.rotationIK=i);var j,k,l=e.temp,m=a.parent;m?(l[0]=c,l[1]=d,m.worldToLocal(l),c=(l[0]-a.x)*m.worldScaleX,d=(l[1]-a.y)*m.worldScaleY):(c-=a.x,d-=a.y),b.parent==a?(j=b.x,k=b.y):(l[0]=b.x,l[1]=b.y,b.parent.localToWorld(l),a.worldToLocal(l),j=l[0],k=l[1]);var n=j*a.worldScaleX,o=k*a.worldScaleY,p=Math.atan2(o,n),q=Math.sqrt(n*n+o*o),r=b.data.length*b.worldScaleX,s=2*q*r;if(1e-4>s)return void (b.rotationIK=h+(Math.atan2(d,c)*e.radDeg-i-h)*g);var t=(c*c+d*d-q*q-r*r)/s;-1>t?t=-1:t>1&&(t=1);var u=Math.acos(t)*f,v=q+r*t,w=r*Math.sin(u),x=Math.atan2(d*v-c*w,c*v+d*w),y=(x-p)*e.radDeg-i;y>180?y-=360:-180>y&&(y+=360),a.rotationIK=i+y*g,y=(u+p)*e.radDeg-h,y>180?y-=360:-180>y&&(y+=360),b.rotationIK=h+(y+a.worldRotation-b.parent.worldRotation)*g},e.Skin=function(a){this.name=a,this.attachments={}},e.Skin.prototype={addAttachment:function(a,b,c){this.attachments[a+":"+b]=c},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var c in b.attachments){var d=c.indexOf(":"),e=parseInt(c.substring(0,d)),f=c.substring(d+1),g=a.slots[e];if(g.attachment&&g.attachment.name==f){var h=this.getAttachment(e,f);h&&g.setAttachment(h)}}}},e.Animation=function(a,b,c){this.name=a,this.timelines=b,this.duration=c},e.Animation.prototype={apply:function(a,b,c,d,e){d&&0!=this.duration&&(c%=this.duration,b%=this.duration);for(var f=this.timelines,g=0,h=f.length;h>g;g++)f[g].apply(a,b,c,e,1)},mix:function(a,b,c,d,e,f){d&&0!=this.duration&&(c%=this.duration,b%=this.duration);for(var g=this.timelines,h=0,i=g.length;i>h;h++)g[h].apply(a,b,c,e,f)}},e.Animation.binarySearch=function(a,b,c){var d=0,e=Math.floor(a.length/c)-2;if(!e)return c;for(var f=e>>>1;;){if(a[(f+1)*c]<=b?d=f+1:e=f,d==e)return(d+1)*c;f=d+e>>>1}},e.Animation.binarySearch1=function(a,b){var c=0,d=a.length-2;if(!d)return 1;for(var e=d>>>1;;){if(a[e+1]<=b?c=e+1:d=e,c==d)return c+1;e=c+d>>>1}},e.Animation.linearSearch=function(a,b,c){for(var d=0,e=a.length-c;e>=d;d+=c)if(a[d]>b)return d;return-1},e.Curves=function(){this.curves=[]},e.Curves.prototype={setLinear:function(a){this.curves[19*a]=0},setStepped:function(a){this.curves[19*a]=1},setCurve:function(a,b,c,d,e){var f=.1,g=f*f,h=g*f,i=3*f,j=3*g,k=6*g,l=6*h,m=2*-b+d,n=2*-c+e,o=3*(b-d)+1,p=3*(c-e)+1,q=b*i+m*j+o*h,r=c*i+n*j+p*h,s=m*k+o*l,t=n*k+p*l,u=o*l,v=p*l,w=19*a,x=this.curves;x[w++]=2;for(var y=q,z=r,A=w+19-1;A>w;w+=2)x[w]=y,x[w+1]=z,q+=s,r+=t,s+=u,t+=v,y+=q,z+=r},getCurvePercent:function(a,b){b=0>b?0:b>1?1:b;var c=this.curves,d=19*a,e=c[d];if(0===e)return b;if(1==e)return 0;d++;for(var f=0,g=d,h=d+19-1;h>d;d+=2)if(f=c[d],f>=b){var i,j;return d==g?(i=0,j=0):(i=c[d-2],j=c[d-1]),j+(c[d+1]-j)*(b-i)/(f-i)}var k=c[d-1];return k+(1-k)*(b-f)/(1-f)}},e.RotateTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=2*a},e.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.bones[this.boneIndex];if(c>=g[g.length-2]){for(var i=h.data.rotation+g[g.length-1]-h.rotation;i>180;)i-=360;for(;-180>i;)i+=360;return void (h.rotation+=i*f)}var j=e.Animation.binarySearch(g,c,2),k=g[j-1],l=g[j],m=1-(c-l)/(g[j-2]-l);m=this.curves.getCurvePercent(j/2-1,m);for(var i=g[j+1]-k;i>180;)i-=360;for(;-180>i;)i+=360;for(i=h.data.rotation+(k+i*m)-h.rotation;i>180;)i-=360;for(;-180>i;)i+=360;h.rotation+=i*f}}},e.TranslateTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=3*a},e.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.bones[this.boneIndex];if(c>=g[g.length-3])return h.x+=(h.data.x+g[g.length-2]-h.x)*f,void (h.y+=(h.data.y+g[g.length-1]-h.y)*f);var i=e.Animation.binarySearch(g,c,3),j=g[i-2],k=g[i-1],l=g[i],m=1-(c-l)/(g[i+ -3]-l);m=this.curves.getCurvePercent(i/3-1,m),h.x+=(h.data.x+j+(g[i+1]-j)*m-h.x)*f,h.y+=(h.data.y+k+(g[i+2]-k)*m-h.y)*f}}},e.ScaleTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=3*a},e.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.bones[this.boneIndex];if(c>=g[g.length-3])return h.scaleX+=(h.data.scaleX*g[g.length-2]-h.scaleX)*f,void (h.scaleY+=(h.data.scaleY*g[g.length-1]-h.scaleY)*f);var i=e.Animation.binarySearch(g,c,3),j=g[i-2],k=g[i-1],l=g[i],m=1-(c-l)/(g[i+ -3]-l);m=this.curves.getCurvePercent(i/3-1,m),h.scaleX+=(h.data.scaleX*(j+(g[i+1]-j)*m)-h.scaleX)*f,h.scaleY+=(h.data.scaleY*(k+(g[i+2]-k)*m)-h.scaleY)*f}}},e.ColorTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=5*a},e.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(a,b,c,d,e,f){a*=5,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d,this.frames[a+3]=e,this.frames[a+4]=f},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h,i,j,k;if(c>=g[g.length-5]){var l=g.length-1;h=g[l-3],i=g[l-2],j=g[l-1],k=g[l]}else{var m=e.Animation.binarySearch(g,c,5),n=g[m-4],o=g[m-3],p=g[m-2],q=g[m-1],r=g[m],s=1-(c-r)/(g[m-5]-r);s=this.curves.getCurvePercent(m/5-1,s),h=n+(g[m+1]-n)*s,i=o+(g[m+2]-o)*s,j=p+(g[m+3]-p)*s,k=q+(g[m+4]-q)*s}var t=a.slots[this.slotIndex];1>f?(t.r+=(h-t.r)*f,t.g+=(i-t.g)*f,t.b+=(j-t.b)*f,t.a+=(k-t.a)*f):(t.r=h,t.g=i,t.b=j,t.a=k)}}},e.AttachmentTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=a,this.attachmentNames=[],this.attachmentNames.length=a},e.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.attachmentNames[a]=c},apply:function(a,b,c){var d=this.frames;if(c<d[0])return void (b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var f=c>=d[d.length-1]?d.length-1:e.Animation.binarySearch1(d,c)-1;if(!(d[f]<b)){var g=this.attachmentNames[f];a.slots[this.slotIndex].setAttachment(g?a.getAttachmentBySlotIndex(this.slotIndex,g):null)}}},e.EventTimeline=function(a){this.frames=[],this.frames.length=a,this.events=[],this.events.length=a},e.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.events[a]=c},apply:function(a,b,c,d,f){if(d){var g=this.frames,h=g.length;if(b>c)this.apply(a,b,Number.MAX_VALUE,d,f),b=-1;else if(b>=g[h-1])return;if(!(c<g[0])){var i;if(b<g[0])i=0;else{i=e.Animation.binarySearch1(g,b);for(var j=g[i];i>0&&g[i-1]==j;)i--}for(var k=this.events;h>i&&c>=g[i];i++)d.push(k[i])}}}},e.DrawOrderTimeline=function(a){this.frames=[],this.frames.length=a,this.drawOrders=[],this.drawOrders.length=a},e.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.drawOrders[a]=c},apply:function(a,b,c){var d=this.frames;if(!(c<d[0])){var f;f=c>=d[d.length-1]?d.length-1:e.Animation.binarySearch1(d,c)-1;var g=a.drawOrder,h=a.slots,i=this.drawOrders[f];if(i)for(var j=0,k=i.length;k>j;j++)g[j]=a.slots[i[j]];else for(var j=0,k=h.length;k>j;j++)g[j]=h[j]}}},e.FfdTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=a,this.frameVertices=[],this.frameVertices.length=a},e.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.frameVertices[a]=c},apply:function(a,b,c,d,f){var g=a.slots[this.slotIndex];if(g.attachment==this.attachment){var h=this.frames;if(!(c<h[0])){var i=this.frameVertices,j=i[0].length,k=g.attachmentVertices;if(k.length!=j&&(f=1),k.length=j,c>=h[h.length-1]){var l=i[h.length-1];if(1>f)for(var m=0;j>m;m++)k[m]+=(l[m]-k[m])*f;else for(var m=0;j>m;m++)k[m]=l[m]}else{var n=e.Animation.binarySearch1(h,c),o=h[n],p=1-(c-o)/(h[n-1]-o);p=this.curves.getCurvePercent(n-1,0>p?0:p>1?1:p);var q=i[n-1],r=i[n];if(1>f)for(var m=0;j>m;m++){var s=q[m];k[m]+=(s+(r[m]-s)*p-k[m])*f}else for(var m=0;j>m;m++){var s=q[m];k[m]=s+(r[m]-s)*p}}}}}},e.IkConstraintTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=3*a},e.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.ikConstraints[this.ikConstraintIndex];if(c>=g[g.length-3])return h.mix+=(g[g.length-2]-h.mix)*f,void (h.bendDirection=g[g.length-1]);var i=e.Animation.binarySearch(g,c,3),j=g[i+ -2],k=g[i],l=1-(c-k)/(g[i+ -3]-k);l=this.curves.getCurvePercent(i/3-1,l);var m=j+(g[i+1]-j)*l;h.mix+=(m-h.mix)*f,h.bendDirection=g[i+ -1]}}},e.FlipXTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=2*a},e.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c?1:0},apply:function(a,b,c){var d=this.frames;if(c<d[0])return void (b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var f=(c>=d[d.length-2]?d.length:e.Animation.binarySearch(d,c,2))-2;d[f]<b||(a.bones[boneIndex].flipX=0!=d[f+1])}},e.FlipYTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=2*a},e.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c?1:0},apply:function(a,b,c){var d=this.frames;if(c<d[0])return void (b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var f=(c>=d[d.length-2]?d.length:e.Animation.binarySearch(d,c,2))-2;d[f]<b||(a.bones[boneIndex].flipY=0!=d[f+1])}},e.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[]},e.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return slot[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSkin:function(a){for(var b=this.skins,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findEvent:function(a){for(var b=this.events,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findAnimation:function(a){for(var b=this.animations,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findIkConstraint:function(a){for(var b=this.ikConstraints,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null}},e.Skeleton=function(a){this.data=a,this.bones=[];for(var b=0,c=a.bones.length;c>b;b++){var d=a.bones[b],f=d.parent?this.bones[a.bones.indexOf(d.parent)]:null;this.bones.push(new e.Bone(d,this,f))}this.slots=[],this.drawOrder=[];for(var b=0,c=a.slots.length;c>b;b++){var g=a.slots[b],h=this.bones[a.bones.indexOf(g.boneData)],i=new e.Slot(g,h);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=[];for(var b=0,c=a.ikConstraints.length;c>b;b++)this.ikConstraints.push(new e.IkConstraint(a.ikConstraints[b],this));this.boneCache=[],this.updateCache()},e.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var a=this.ikConstraints,b=a.length,c=b+1,d=this.boneCache;d.length>c&&(d.length=c);for(var e=0,f=d.length;f>e;e++)d[e].length=0;for(;d.length<c;)d[d.length]=[];var g=d[0],h=this.bones;a:for(var e=0,f=h.length;f>e;e++){var i=h[e],j=i;do{for(var k=0;b>k;k++)for(var l=a[k],m=l.bones[0],n=l.bones[l.bones.length-1];;){if(j==n){d[k].push(i),d[k+1].push(i);continue a}if(n==m)break;n=n.parent}j=j.parent}while(j);g[g.length]=i}},updateWorldTransform:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++){var d=a[b];d.rotationIK=d.rotation}for(var b=0,e=this.boneCache.length-1;;){for(var f=this.boneCache[b],g=0,h=f.length;h>g;g++)f[g].updateWorldTransform();if(b==e)break;this.ikConstraints[b].apply(),b++}},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++)a[b].setToSetupPose();for(var d=this.ikConstraints,b=0,c=d.length;c>b;b++){var e=d[b];e.bendDirection=e.data.bendDirection,e.mix=e.data.mix}},setSlotsToSetupPose:function(){for(var a=this.slots,b=this.drawOrder,c=0,d=a.length;d>c;c++)b[c]=a[c],a[c].setToSetupPose(c)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw"Skin not found: "+a;this.setSkin(b)},setSkin:function(a){if(a)if(this.skin)a._attachAll(this,this.skin);else for(var b=this.slots,c=0,d=b.length;d>c;c++){var e=b[c],f=e.data.attachmentName;if(f){var g=a.getAttachment(c,f);g&&e.setAttachment(g)}}this.skin=a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var c=this.skin.getAttachment(a,b);if(c)return c}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var c=this.slots,d=0,e=c.length;e>d;d++){var f=c[d];if(f.data.name==a){var g=null;if(b&&(g=this.getAttachmentBySlotIndex(d,b),!g))throw"Attachment not found: "+b+", for slot: "+a;return void f.setAttachment(g)}}throw"Slot not found: "+a},findIkConstraint:function(a){for(var b=this.ikConstraints,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},update:function(a){this.time+=a}},e.EventData=function(a){this.name=a},e.EventData.prototype={intValue:0,floatValue:0,stringValue:null},e.Event=function(a){this.data=a},e.Event.prototype={intValue:0,floatValue:0,stringValue:null},e.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3},e.RegionAttachment=function(a){this.name=a,this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},e.RegionAttachment.prototype={type:e.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,c,d,e){var f=this.uvs;e?(f[2]=a,f[3]=d,f[4]=a,f[5]=b,f[6]=c,f[7]=b,f[0]=c,f[1]=d):(f[0]=a,f[1]=d,f[2]=a,f[3]=b,f[4]=c,f[5]=b,f[6]=c,f[7]=d)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,b=this.height/this.regionOriginalHeight*this.scaleY,c=-this.width/2*this.scaleX+this.regionOffsetX*a,d=-this.height/2*this.scaleY+this.regionOffsetY*b,f=c+this.regionWidth*a,g=d+this.regionHeight*b,h=this.rotation*e.degRad,i=Math.cos(h),j=Math.sin(h),k=c*i+this.x,l=c*j,m=d*i+this.y,n=d*j,o=f*i+this.x,p=f*j,q=g*i+this.y,r=g*j,s=this.offset;s[0]=k-n,s[1]=m+l,s[2]=k-r,s[3]=q+l,s[4]=o-r,s[5]=q+p,s[6]=o-n,s[7]=m+p},computeVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.offset;d[0]=i[0]*e+i[1]*f+a,d[1]=i[0]*g+i[1]*h+b,d[2]=i[2]*e+i[3]*f+a,d[3]=i[2]*g+i[3]*h+b,d[4]=i[4]*e+i[5]*f+a,d[5]=i[4]*g+i[5]*h+b,d[6]=i[6]*e+i[7]*f+a,d[7]=i[6]*g+i[7]*h+b}},e.MeshAttachment=function(a){this.name=a},e.MeshAttachment.prototype={type:e.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var a=this.regionU2-this.regionU,b=this.regionV2-this.regionV,c=this.regionUVs.length;if(this.uvs&&this.uvs.length==c||(this.uvs=new e.Float32Array(c)),this.regionRotate)for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d+1]*a,this.uvs[d+1]=this.regionV+b-this.regionUVs[d]*b;else for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d]*a,this.uvs[d+1]=this.regionV+this.regionUVs[d+1]*b},computeWorldVertices:function(a,b,c,d){var e=c.bone;a+=e.worldX,b+=e.worldY;var f=e.m00,g=e.m01,h=e.m10,i=e.m11,j=this.vertices,k=j.length;c.attachmentVertices.length==k&&(j=c.attachmentVertices);for(var l=0;k>l;l+=2){var m=j[l],n=j[l+1];d[l]=m*f+n*g+a,d[l+1]=m*h+n*i+b}}},e.SkinnedMeshAttachment=function(a){this.name=a},e.SkinnedMeshAttachment.prototype={type:e.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var a=this.regionU2-this.regionU,b=this.regionV2-this.regionV,c=this.regionUVs.length;if(this.uvs&&this.uvs.length==c||(this.uvs=new e.Float32Array(c)),this.regionRotate)for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d+1]*a,this.uvs[d+1]=this.regionV+b-this.regionUVs[d]*b;else for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d]*a,this.uvs[d+1]=this.regionV+this.regionUVs[d+1]*b},computeWorldVertices:function(a,b,c,d){var e,f,g,h,i,j,k,l=c.bone.skeleton.bones,m=this.weights,n=this.bones,o=0,p=0,q=0,r=0,s=n.length;if(c.attachmentVertices.length)for(var t=c.attachmentVertices;s>p;o+=2){for(f=0,g=0,e=n[p++]+p;e>p;p++,q+=3,r+=2)h=l[n[p]],i=m[q]+t[r],j=m[q+1]+t[r+1],k=m[q+2],f+=(i*h.m00+j*h.m01+h.worldX)*k,g+=(i*h.m10+j*h.m11+h.worldY)*k;d[o]=f+a,d[o+1]=g+b}else for(;s>p;o+=2){for(f=0,g=0,e=n[p++]+p;e>p;p++,q+=3)h=l[n[p]],i=m[q],j=m[q+1],k=m[q+2],f+=(i*h.m00+j*h.m01+h.worldX)*k,g+=(i*h.m10+j*h.m11+h.worldY)*k;d[o]=f+a,d[o+1]=g+b}}},e.BoundingBoxAttachment=function(a){this.name=a,this.vertices=[]},e.BoundingBoxAttachment.prototype={type:e.AttachmentType.boundingbox,computeWorldVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;for(var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.vertices,j=0,k=i.length;k>j;j+=2){var l=i[j],m=i[j+1];d[j]=l*e+m*f+a,d[j+1]=l*g+m*h+b}}},e.AnimationStateData=function(a){this.skeletonData=a,this.animationToMixTime={}},e.AnimationStateData.prototype={defaultMix:0,setMixByName:function(a,b,c){var d=this.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;var e=this.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;this.setMix(d,e,c)},setMix:function(a,b,c){this.animationToMixTime[a.name+":"+b.name]=c},getMix:function(a,b){var c=a.name+":"+b.name;return this.animationToMixTime.hasOwnProperty(c)?this.animationToMixTime[c]:this.defaultMix}},e.TrackEntry=function(){},e.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null},e.AnimationState=function(a){this.data=a,this.tracks=[],this.events=[]},e.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(a){a*=this.timeScale;for(var b=0;b<this.tracks.length;b++){var c=this.tracks[b];if(c){if(c.time+=a*c.timeScale,c.previous){var d=a*c.previous.timeScale;c.previous.time+=d,c.mixTime+=d}var e=c.next;e?(e.time=c.lastTime-e.delay,e.time>=0&&this.setCurrent(b,e)):!c.loop&&c.lastTime>=c.endTime&&this.clearTrack(b)}}},apply:function(a){for(var b=0;b<this.tracks.length;b++){var c=this.tracks[b];if(c){this.events.length=0;var d=c.time,e=c.lastTime,f=c.endTime,g=c.loop;!g&&d>f&&(d=f);var h=c.previous;if(h){var i=h.time;!h.loop&&i>h.endTime&&(i=h.endTime),h.animation.apply(a,i,i,h.loop,null);var j=c.mixTime/c.mixDuration*c.mix;j>=1&&(j=1,c.previous=null),c.animation.mix(a,c.lastTime,d,g,this.events,j)}else 1==c.mix?c.animation.apply(a,c.lastTime,d,g,this.events):c.animation.mix(a,c.lastTime,d,g,this.events,c.mix);for(var k=0,l=this.events.length;l>k;k++){var m=this.events[k];c.onEvent&&c.onEvent(b,m),this.onEvent&&this.onEvent(b,m)}if(g?e%f>d%f:f>e&&d>=f){var n=Math.floor(d/f);c.onComplete&&c.onComplete(b,n),this.onComplete&&this.onComplete(b,n)}c.lastTime=c.time}}},clearTracks:function(){for(var a=0,b=this.tracks.length;b>a;a++)this.clearTrack(a);this.tracks.length=0},clearTrack:function(a){if(!(a>=this.tracks.length)){var b=this.tracks[a];b&&(b.onEnd&&b.onEnd(a),this.onEnd&&this.onEnd(a),this.tracks[a]=null)}},_expandToIndex:function(a){if(a<this.tracks.length)return this.tracks[a];for(;a>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(a,b){var c=this._expandToIndex(a);if(c){var d=c.previous;c.previous=null,c.onEnd&&c.onEnd(a),this.onEnd&&this.onEnd(a),b.mixDuration=this.data.getMix(c.animation,b.animation),b.mixDuration>0&&(b.mixTime=0,b.previous=d&&c.mixTime/c.mixDuration<.5?d:c)}this.tracks[a]=b,b.onStart&&b.onStart(a),this.onStart&&this.onStart(a)},setAnimationByName:function(a,b,c){var d=this.data.skeletonData.findAnimation(b);if(!d)throw"Animation not found: "+b;return this.setAnimation(a,d,c)},setAnimation:function(a,b,c){var d=new e.TrackEntry;return d.animation=b,d.loop=c,d.endTime=b.duration,this.setCurrent(a,d),d},addAnimationByName:function(a,b,c,d){var e=this.data.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;return this.addAnimation(a,e,c,d)},addAnimation:function(a,b,c,d){var f=new e.TrackEntry;f.animation=b,f.loop=c,f.endTime=b.duration;var g=this._expandToIndex(a);if(g){for(;g.next;)g=g.next;g.next=f}else this.tracks[a]=f;return 0>=d&&(g?d+=g.endTime-this.data.getMix(g.animation,b):d=0),f.delay=d,f},getCurrent:function(a){return a>=this.tracks.length?null:this.tracks[a]}},e.SkeletonJson=function(a){this.attachmentLoader=a},e.SkeletonJson.prototype={scale:1,readSkeletonData:function(a,b){var c=new e.SkeletonData;c.name=b;var d=a.skeleton;d&&(c.hash=d.hash,c.version=d.spine,c.width=d.width||0,c.height=d.height||0);for(var f=a.bones,g=0,h=f.length;h>g;g++){var i=f[g],j=null;if(i.parent&&(j=c.findBone(i.parent),!j))throw"Parent bone not found: "+i.parent;var k=new e.BoneData(i.name,j);k.length=(i.length||0)*this.scale,k.x=(i.x||0)*this.scale,k.y=(i.y||0)*this.scale,k.rotation=i.rotation||0,k.scaleX=i.hasOwnProperty("scaleX")?i.scaleX:1,k.scaleY=i.hasOwnProperty("scaleY")?i.scaleY:1,k.inheritScale=i.hasOwnProperty("inheritScale")?i.inheritScale:!0,k.inheritRotation=i.hasOwnProperty("inheritRotation")?i.inheritRotation:!0,c.bones.push(k)}var l=a.ik;if(l)for(var g=0,h=l.length;h>g;g++){for(var m=l[g],n=new e.IkConstraintData(m.name),f=m.bones,o=0,p=f.length;p>o;o++){var q=c.findBone(f[o]);if(!q)throw"IK bone not found: "+f[o];n.bones.push(q)}if(n.target=c.findBone(m.target),!n.target)throw"Target bone not found: "+m.target;n.bendDirection=!m.hasOwnProperty("bendPositive")||m.bendPositive?1:-1,n.mix=m.hasOwnProperty("mix")?m.mix:1,c.ikConstraints.push(n)}for(var r=a.slots,g=0,h=r.length;h>g;g++){var s=r[g],k=c.findBone(s.bone);if(!k)throw"Slot bone not found: "+s.bone;var t=new e.SlotData(s.name,k),u=s.color;u&&(t.r=this.toColor(u,0),t.g=this.toColor(u,1),t.b=this.toColor(u,2),t.a=this.toColor(u,3)),t.attachmentName=s.attachment,t.additiveBlending=s.additive&&"true"==s.additive,c.slots.push(t)}var v=a.skins;for(var w in v)if(v.hasOwnProperty(w)){var x=v[w],y=new e.Skin(w);for(var z in x)if(x.hasOwnProperty(z)){var A=c.findSlotIndex(z),B=x[z];for(var C in B)if(B.hasOwnProperty(C)){var D=this.readAttachment(y,C,B[C]);D&&y.addAttachment(A,C,D)}}c.skins.push(y),"default"==y.name&&(c.defaultSkin=y)}var E=a.events;for(var F in E)if(E.hasOwnProperty(F)){var G=E[F],H=new e.EventData(F);H.intValue=G["int"]||0,H.floatValue=G["float"]||0,H.stringValue=G.string||null,c.events.push(H)}var I=a.animations;for(var J in I)I.hasOwnProperty(J)&&this.readAnimation(J,I[J],c);return c},readAttachment:function(a,b,c){b=c.name||b;var d=e.AttachmentType[c.type||"region"],f=c.path||b,g=this.scale;if(d==e.AttachmentType.region){var h=this.attachmentLoader.newRegionAttachment(a,b,f);if(!h)return null;h.path=f,h.x=(c.x||0)*g,h.y=(c.y||0)*g,h.scaleX=c.hasOwnProperty("scaleX")?c.scaleX:1,h.scaleY=c.hasOwnProperty("scaleY")?c.scaleY:1,h.rotation=c.rotation||0,h.width=(c.width||0)*g,h.height=(c.height||0)*g;var i=c.color;return i&&(h.r=this.toColor(i,0),h.g=this.toColor(i,1),h.b=this.toColor(i,2),h.a=this.toColor(i,3)),h.updateOffset(),h}if(d==e.AttachmentType.mesh){var j=this.attachmentLoader.newMeshAttachment(a,b,f);return j?(j.path=f,j.vertices=this.getFloatArray(c,"vertices",g),j.triangles=this.getIntArray(c,"triangles"),j.regionUVs=this.getFloatArray(c,"uvs",1),j.updateUVs(),i=c.color,i&&(j.r=this.toColor(i,0),j.g=this.toColor(i,1),j.b=this.toColor(i,2),j.a=this.toColor(i,3)),j.hullLength=2*(c.hull||0),c.edges&&(j.edges=this.getIntArray(c,"edges")),j.width=(c.width||0)*g,j.height=(c.height||0)*g,j):null}if(d==e.AttachmentType.skinnedmesh){var j=this.attachmentLoader.newSkinnedMeshAttachment(a,b,f);if(!j)return null;j.path=f;for(var k=this.getFloatArray(c,"uvs",1),l=this.getFloatArray(c,"vertices",1),m=[],n=[],o=0,p=l.length;p>o;){var q=0|l[o++];n[n.length]=q;for(var r=o+4*q;r>o;)n[n.length]=l[o],m[m.length]=l[o+1]*g,m[m.length]=l[o+2]*g,m[m.length]=l[o+3],o+=4}return j.bones=n,j.weights=m,j.triangles=this.getIntArray(c,"triangles"),j.regionUVs=k,j.updateUVs(),i=c.color,i&&(j.r=this.toColor(i,0),j.g=this.toColor(i,1),j.b=this.toColor(i,2),j.a=this.toColor(i,3)),j.hullLength=2*(c.hull||0),c.edges&&(j.edges=this.getIntArray(c,"edges")),j.width=(c.width||0)*g,j.height=(c.height||0)*g,j}if(d==e.AttachmentType.boundingbox){for(var s=this.attachmentLoader.newBoundingBoxAttachment(a,b),l=c.vertices,o=0,p=l.length;p>o;o++)s.vertices.push(l[o]*g);return s}throw"Unknown attachment type: "+d},readAnimation:function(a,b,c){var d=[],f=0,g=b.slots;for(var h in g)if(g.hasOwnProperty(h)){var i=g[h],j=c.findSlotIndex(h);for(var k in i)if(i.hasOwnProperty(k)){var l=i[k];if("color"==k){var m=new e.ColorTimeline(l.length);m.slotIndex=j;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],r=q.color,s=this.toColor(r,0),t=this.toColor(r,1),u=this.toColor(r,2),v=this.toColor(r,3);m.setFrame(n,q.time,s,t,u,v),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[5*m.getFrameCount()-5])}else{if("attachment"!=k)throw"Invalid timeline type for a slot: "+k+" ("+h+")";var m=new e.AttachmentTimeline(l.length);m.slotIndex=j;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n++,q.time,q.name)}d.push(m),f=Math.max(f,m.frames[m.getFrameCount()-1])}}}var w=b.bones;for(var x in w)if(w.hasOwnProperty(x)){var y=c.findBoneIndex(x);if(-1==y)throw"Bone not found: "+x;var z=w[x];for(var k in z)if(z.hasOwnProperty(k)){var l=z[k];if("rotate"==k){var m=new e.RotateTimeline(l.length);m.boneIndex=y;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n,q.time,q.angle),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[2*m.getFrameCount()-2])}else if("translate"==k||"scale"==k){var m,A=1;"scale"==k?m=new e.ScaleTimeline(l.length):(m=new e.TranslateTimeline(l.length),A=this.scale),m.boneIndex=y;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],B=(q.x||0)*A,C=(q.y||0)*A;m.setFrame(n,q.time,B,C),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[3*m.getFrameCount()-3])}else{if("flipX"!=k&&"flipY"!=k)throw"Invalid timeline type for a bone: "+k+" ("+x+")";var B="flipX"==k,m=B?new e.FlipXTimeline(l.length):new e.FlipYTimeline(l.length);m.boneIndex=y;for(var D=B?"x":"y",n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n,q.time,q[D]||!1),n++}d.push(m),f=Math.max(f,m.frames[2*m.getFrameCount()-2])}}}var E=b.ik;for(var F in E)if(E.hasOwnProperty(F)){var G=c.findIkConstraint(F),l=E[F],m=new e.IkConstraintTimeline(l.length);m.ikConstraintIndex=c.ikConstraints.indexOf(G);for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],H=q.hasOwnProperty("mix")?q.mix:1,I=!q.hasOwnProperty("bendPositive")||q.bendPositive?1:-1;m.setFrame(n,q.time,H,I),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[3*m.frameCount-3])}var J=b.ffd;for(var K in J){var L=c.findSkin(K),i=J[K];for(h in i){var j=c.findSlotIndex(h),M=i[h];for(var N in M){var l=M[N],m=new e.FfdTimeline(l.length),O=L.getAttachment(j,N);if(!O)throw"FFD attachment not found: "+N;m.slotIndex=j,m.attachment=O;var P,Q=O.type==e.AttachmentType.mesh;P=Q?O.vertices.length:O.weights.length/3*2;for(var n=0,o=0,p=l.length;p>o;o++){var R,q=l[o];if(q.vertices){var S=q.vertices,R=[];R.length=P;var T=q.offset||0,U=S.length;if(1==this.scale)for(var V=0;U>V;V++)R[V+T]=S[V];else for(var V=0;U>V;V++)R[V+T]=S[V]*this.scale;if(Q)for(var W=O.vertices,V=0,U=R.length;U>V;V++)R[V]+=W[V]}else Q?R=O.vertices:(R=[],R.length=P);m.setFrame(n,q.time,R),this.readCurve(m,n,q),n++}d[d.length]=m,f=Math.max(f,m.frames[m.frameCount-1])}}}var X=b.drawOrder;if(X||(X=b.draworder),X){for(var m=new e.DrawOrderTimeline(X.length),Y=c.slots.length,n=0,o=0,p=X.length;p>o;o++){var Z=X[o],$=null;if(Z.offsets){$=[],$.length=Y;for(var V=Y-1;V>=0;V--)$[V]=-1;var _=Z.offsets,ba=[];ba.length=Y-_.length;for(var bb=0,bc=0,V=0,U=_.length;U>V;V++){var bd=_[V],j=c.findSlotIndex(bd.slot);if(-1==j)throw"Slot not found: "+bd.slot;for(;bb!=j;)ba[bc++]=bb++;$[bb+bd.offset]=bb++}for(;Y>bb;)ba[bc++]=bb++;for(var V=Y-1;V>=0;V--)-1==$[V]&&($[V]=ba[--bc])}m.setFrame(n++,Z.time,$)}d.push(m),f=Math.max(f,m.frames[m.getFrameCount()-1])}var be=b.events;if(be){for(var m=new e.EventTimeline(be.length),n=0,o=0,p=be.length;p>o;o++){var bf=be[o],bg=c.findEvent(bf.name);if(!bg)throw"Event not found: "+
bf.name;var bh=new e.Event(bg);bh.intValue=bf.hasOwnProperty("int")?bf["int"]:bg.intValue,bh.floatValue=bf.hasOwnProperty("float")?bf["float"]:bg.floatValue,bh.stringValue=bf.hasOwnProperty("string")?bf.string:bg.stringValue,m.setFrame(n++,bf.time,bh)}d.push(m),f=Math.max(f,m.frames[m.getFrameCount()-1])}c.animations.push(new e.Animation(a,d,f))},readCurve:function(a,b,c){var d=c.curve;d?"stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]):a.curves.setLinear(b)},toColor:function(a,b){if(8!=a.length)throw"Color hexidecimal length must be 8, recieved: "+a;return parseInt(a.substring(2*b,2*b+2),16)/255},getFloatArray:function(a,b,c){var d=a[b],f=new e.Float32Array(d.length),g=0,h=d.length;if(1==c)for(;h>g;g++)f[g]=d[g];else for(;h>g;g++)f[g]=d[g]*c;return f},getIntArray:function(a,b){for(var c=a[b],d=new e.Uint16Array(c.length),f=0,g=c.length;g>f;f++)d[f]=0|c[f];return d}},e.Atlas=function(a,b){this.textureLoader=b,this.pages=[],this.regions=[];var c=new e.AtlasReader(a),d=[];d.length=4;for(var f=null;;){var g=c.readLine();if(null===g)break;if(g=c.trim(g),g.length)if(f){var h=new e.AtlasRegion;h.name=g,h.page=f,h.rotate="true"==c.readValue(),c.readTuple(d);var i=parseInt(d[0]),j=parseInt(d[1]);c.readTuple(d);var k=parseInt(d[0]),l=parseInt(d[1]);h.u=i/f.width,h.v=j/f.height,h.rotate?(h.u2=(i+l)/f.width,h.v2=(j+k)/f.height):(h.u2=(i+k)/f.width,h.v2=(j+l)/f.height),h.x=i,h.y=j,h.width=Math.abs(k),h.height=Math.abs(l),4==c.readTuple(d)&&(h.splits=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])],4==c.readTuple(d)&&(h.pads=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])],c.readTuple(d))),h.originalWidth=parseInt(d[0]),h.originalHeight=parseInt(d[1]),c.readTuple(d),h.offsetX=parseInt(d[0]),h.offsetY=parseInt(d[1]),h.index=parseInt(c.readValue()),this.regions.push(h)}else{f=new e.AtlasPage,f.name=g,2==c.readTuple(d)&&(f.width=parseInt(d[0]),f.height=parseInt(d[1]),c.readTuple(d)),f.format=e.Atlas.Format[d[0]],c.readTuple(d),f.minFilter=e.Atlas.TextureFilter[d[0]],f.magFilter=e.Atlas.TextureFilter[d[1]];var m=c.readValue();f.uWrap=e.Atlas.TextureWrap.clampToEdge,f.vWrap=e.Atlas.TextureWrap.clampToEdge,"x"==m?f.uWrap=e.Atlas.TextureWrap.repeat:"y"==m?f.vWrap=e.Atlas.TextureWrap.repeat:"xy"==m&&(f.uWrap=f.vWrap=e.Atlas.TextureWrap.repeat),b.load(f,g,this),this.pages.push(f)}else f=null}},e.Atlas.prototype={findRegion:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},dispose:function(){for(var a=this.pages,b=0,c=a.length;c>b;b++)this.textureLoader.unload(a[b].rendererObject)},updateUVs:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++){var e=b[c];e.page==a&&(e.u=e.x/a.width,e.v=e.y/a.height,e.rotate?(e.u2=(e.x+e.height)/a.width,e.v2=(e.y+e.width)/a.height):(e.u2=(e.x+e.width)/a.width,e.v2=(e.y+e.height)/a.height))}}},e.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},e.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},e.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},e.AtlasPage=function(){},e.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},e.AtlasRegion=function(){},e.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},e.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)},e.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw"Invalid line: "+a;return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw"Invalid line: "+b;for(var d=0,e=c+1;3>d;d++){var f=b.indexOf(",",e);if(-1==f)break;a[d]=this.trim(b.substr(e,f-e)),e=f+1}return a[d]=this.trim(b.substring(e)),d+1}},e.AtlasAttachmentLoader=function(a){this.atlas=a},e.AtlasAttachmentLoader.prototype={newRegionAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" (region attachment: "+b+")";var f=new e.RegionAttachment(b);return f.rendererObject=d,f.setUVs(d.u,d.v,d.u2,d.v2,d.rotate),f.regionOffsetX=d.offsetX,f.regionOffsetY=d.offsetY,f.regionWidth=d.width,f.regionHeight=d.height,f.regionOriginalWidth=d.originalWidth,f.regionOriginalHeight=d.originalHeight,f},newMeshAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" (mesh attachment: "+b+")";var f=new e.MeshAttachment(b);return f.rendererObject=d,f.regionU=d.u,f.regionV=d.v,f.regionU2=d.u2,f.regionV2=d.v2,f.regionRotate=d.rotate,f.regionOffsetX=d.offsetX,f.regionOffsetY=d.offsetY,f.regionWidth=d.width,f.regionHeight=d.height,f.regionOriginalWidth=d.originalWidth,f.regionOriginalHeight=d.originalHeight,f},newSkinnedMeshAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" (skinned mesh attachment: "+b+")";var f=new e.SkinnedMeshAttachment(b);return f.rendererObject=d,f.regionU=d.u,f.regionV=d.v,f.regionU2=d.u2,f.regionV2=d.v2,f.regionRotate=d.rotate,f.regionOffsetX=d.offsetX,f.regionOffsetY=d.offsetY,f.regionWidth=d.width,f.regionHeight=d.height,f.regionOriginalWidth=d.originalWidth,f.regionOriginalHeight=d.originalHeight,f},newBoundingBoxAttachment:function(a,b){return new e.BoundingBoxAttachment(b)}},e.SkeletonBounds=function(){this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},e.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(a,b){var c=a.slots,d=c.length,f=a.x,g=a.y,h=this.boundingBoxes,i=this.polygonPool,j=this.polygons;h.length=0;for(var k=0,l=j.length;l>k;k++)i.push(j[k]);j.length=0;for(var k=0;d>k;k++){var m=c[k],n=m.attachment;if(n.type==e.AttachmentType.boundingbox){h.push(n);var o,p=i.length;p>0?(o=i[p-1],i.splice(p-1,1)):o=[],j.push(o),o.length=n.vertices.length,n.computeWorldVertices(f,g,m.bone,o)}}b&&this.aabbCompute()},aabbCompute:function(){for(var a=this.polygons,b=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=Number.MIN_VALUE,f=0,g=a.length;g>f;f++)for(var h=a[f],i=0,j=h.length;j>i;i+=2){var k=h[i],l=h[i+1];b=Math.min(b,k),c=Math.min(c,l),d=Math.max(d,k),e=Math.max(e,l)}this.minX=b,this.minY=c,this.maxX=d,this.maxY=e},aabbContainsPoint:function(a,b){return a>=this.minX&&a<=this.maxX&&b>=this.minY&&b<=this.maxY},aabbIntersectsSegment:function(a,b,c,d){var e=this.minX,f=this.minY,g=this.maxX,h=this.maxY;if(e>=a&&e>=c||f>=b&&f>=d||a>=g&&c>=g||b>=h&&d>=h)return!1;var i=(d-b)/(c-a),j=i*(e-a)+b;if(j>f&&h>j)return!0;if(j=i*(g-a)+b,j>f&&h>j)return!0;var k=(f-b)/i+a;return k>e&&g>k?!0:(k=(h-b)/i+a,k>e&&g>k?!0:!1)},aabbIntersectsSkeleton:function(a){return this.minX<a.maxX&&this.maxX>a.minX&&this.minY<a.maxY&&this.maxY>a.minY},containsPoint:function(a,b){for(var c=this.polygons,d=0,e=c.length;e>d;d++)if(this.polygonContainsPoint(c[d],a,b))return this.boundingBoxes[d];return null},intersectsSegment:function(a,b,c,d){for(var e=this.polygons,f=0,g=e.length;g>f;f++)if(e[f].intersectsSegment(a,b,c,d))return this.boundingBoxes[f];return null},polygonContainsPoint:function(a,b,c){for(var d=a.length,e=d-2,f=!1,g=0;d>g;g+=2){var h=a[g+1],i=a[e+1];if(c>h&&i>=c||c>i&&h>=c){var j=a[g];j+(c-h)/(i-h)*(a[e]-j)<b&&(f=!f)}e=g}return f},polygonIntersectsSegment:function(a,b,c,d,e){for(var f=a.length,g=b-d,h=c-e,i=b*e-c*d,j=a[f-2],k=a[f-1],l=0;f>l;l+=2){var m=a[l],n=a[l+1],o=j*n-k*m,p=j-m,q=k-n,r=g*q-h*p,s=(i*p-g*o)/r;if((s>=j&&m>=s||s>=m&&j>=s)&&(s>=b&&d>=s||s>=d&&b>=s)){var t=(i*q-h*o)/r;if((t>=k&&n>=t||t>=n&&k>=t)&&(t>=c&&e>=t||t>=e&&c>=t))return!0}j=m,k=n}return!1},getPolygon:function(a){var b=this.boundingBoxes.indexOf(a);return-1==b?null:this.polygons[b]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}},e.Bone.yDown=!0,d.AnimCache={},d.SpineTextureLoader=function(a,b){d.EventTarget.call(this),this.basePath=a,this.crossorigin=b,this.loadingCount=0},d.SpineTextureLoader.prototype=d.SpineTextureLoader,d.SpineTextureLoader.prototype.load=function(a,b){if(a.rendererObject=d.BaseTexture.fromImage(this.basePath+"/"+b,this.crossorigin),!a.rendererObject.hasLoaded){var c=this;++c.loadingCount,a.rendererObject.addEventListener("loaded",function(){--c.loadingCount,c.dispatchEvent({type:"loadedBaseTexture",content:c})})}},d.SpineTextureLoader.prototype.unload=function(a){a.destroy(!0)},d.Spine=function(a){if(d.DisplayObjectContainer.call(this),this.spineData=d.AnimCache[a],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+a);this.skeleton=new e.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new e.AnimationStateData(this.spineData),this.state=new e.AnimationState(this.stateData),this.slotContainers=[];for(var b=0,c=this.skeleton.drawOrder.length;c>b;b++){var f=this.skeleton.drawOrder[b],g=f.attachment,h=new d.DisplayObjectContainer;if(this.slotContainers.push(h),this.addChild(h),g instanceof e.RegionAttachment){var i=g.rendererObject.name,j=this.createSprite(f,g);f.currentSprite=j,f.currentSpriteName=i,h.addChild(j)}else{if(!(g instanceof e.MeshAttachment))continue;var k=this.createMesh(f,g);f.currentMesh=k,f.currentMeshName=g.name,h.addChild(k)}}this.autoUpdate=!0},d.Spine.prototype=Object.create(d.DisplayObjectContainer.prototype),d.Spine.prototype.constructor=d.Spine,Object.defineProperty(d.Spine.prototype,"autoUpdate",{get:function(){return this.updateTransform===d.Spine.prototype.autoUpdateTransform},set:function(a){this.updateTransform=a?d.Spine.prototype.autoUpdateTransform:d.DisplayObjectContainer.prototype.updateTransform}}),d.Spine.prototype.update=function(a){this.state.update(a),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var b=this.skeleton.drawOrder,c=0,f=b.length;f>c;c++){var g=b[c],h=g.attachment,i=this.slotContainers[c];if(h){var j=h.type;if(j===e.AttachmentType.region){if(h.rendererObject&&(!g.currentSpriteName||g.currentSpriteName!==h.name)){var k=h.rendererObject.name;if(void 0!==g.currentSprite&&(g.currentSprite.visible=!1),g.sprites=g.sprites||{},void 0!==g.sprites[k])g.sprites[k].visible=!0;else{var l=this.createSprite(g,h);i.addChild(l)}g.currentSprite=g.sprites[k],g.currentSpriteName=k}var m=g.bone;i.position.x=m.worldX+h.x*m.m00+h.y*m.m01,i.position.y=m.worldY+h.x*m.m10+h.y*m.m11,i.scale.x=m.worldScaleX,i.scale.y=m.worldScaleY,i.rotation=-(g.bone.worldRotation*e.degRad),g.currentSprite.tint=d.rgb2hex([g.r,g.g,g.b])}else{if(j!==e.AttachmentType.skinnedmesh){i.visible=!1;continue}if(!g.currentMeshName||g.currentMeshName!==h.name){var n=h.name;if(void 0!==g.currentMesh&&(g.currentMesh.visible=!1),g.meshes=g.meshes||{},void 0!==g.meshes[n])g.meshes[n].visible=!0;else{var o=this.createMesh(g,h);i.addChild(o)}g.currentMesh=g.meshes[n],g.currentMeshName=n}h.computeWorldVertices(g.bone.skeleton.x,g.bone.skeleton.y,g,g.currentMesh.vertices)}i.visible=!0,i.alpha=g.a}else i.visible=!1}},d.Spine.prototype.autoUpdateTransform=function(){this.lastTime=this.lastTime||Date.now();var a=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(a),d.DisplayObjectContainer.prototype.updateTransform.call(this)},d.Spine.prototype.createSprite=function(a,b){var c=b.rendererObject,f=c.page.rendererObject,g=new d.Rectangle(c.x,c.y,c.rotate?c.height:c.width,c.rotate?c.width:c.height),h=new d.Texture(f,g),i=new d.Sprite(h),j=c.rotate?.5*Math.PI:0;return i.scale.set(c.width/c.originalWidth,c.height/c.originalHeight),i.rotation=j-b.rotation*e.degRad,i.anchor.x=i.anchor.y=.5,a.sprites=a.sprites||{},a.sprites[c.name]=i,i},d.Spine.prototype.createMesh=function(a,b){var c=b.rendererObject,e=c.page.rendererObject,f=new d.Texture(e),g=new d.Strip(f);return g.drawMode=d.Strip.DrawModes.TRIANGLES,g.canvasPadding=1.5,g.vertices=new d.Float32Array(b.uvs.length),g.uvs=b.uvs,g.indices=b.triangles,a.meshes=a.meshes||{},a.meshes[b.name]=g,g},d.BaseTextureCache={},d.BaseTextureCacheIdGenerator=0,d.BaseTexture=function(a,b){if(this.resolution=1,this.width=100,this.height=100,this.scaleMode=b||d.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=a,this._UID=d._UID++,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],a){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty();else{var c=this;this.source.onload=function(){c.hasLoaded=!0,c.width=c.source.naturalWidth||c.source.width,c.height=c.source.naturalHeight||c.source.height,c.dirty(),c.dispatchEvent({type:"loaded",content:c})},this.source.onerror=function(){c.dispatchEvent({type:"error",content:c})}}this.imageUrl=null,this._powerOf2=!1}},d.BaseTexture.prototype.constructor=d.BaseTexture,d.EventTarget.mixin(d.BaseTexture.prototype),d.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete d.BaseTextureCache[this.imageUrl],delete d.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete d.BaseTextureCache[this.source._pixiId],this.source=null,this.unloadFromGPU()},d.BaseTexture.prototype.updateSourceImage=function(a){this.hasLoaded=!1,this.source.src=null,this.source.src=a},d.BaseTexture.prototype.dirty=function(){for(var a=0;a<this._glTextures.length;a++)this._dirty[a]=!0},d.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var a=this._glTextures.length-1;a>=0;a--){var b=this._glTextures[a],c=d.glContexts[a];c&&b&&c.deleteTexture(b)}this._glTextures.length=0,this.dirty()},d.BaseTexture.fromImage=function(a,b,c){var e=d.BaseTextureCache[a];if(void 0===b&&-1===a.indexOf("data:")&&(b=!0),!e){var f=new Image;b&&(f.crossOrigin=""),f.src=a,e=new d.BaseTexture(f,c),e.imageUrl=a,d.BaseTextureCache[a]=e,-1!==a.indexOf(d.RETINA_PREFIX+".")&&(e.resolution=2)}return e},d.BaseTexture.fromCanvas=function(a,b){a._pixiId||(a._pixiId="canvas_"+d.TextureCacheIdGenerator++);var c=d.BaseTextureCache[a._pixiId];return c||(c=new d.BaseTexture(a,b),d.BaseTextureCache[a._pixiId]=c),c},d.TextureCache={},d.FrameCache={},d.TextureCacheIdGenerator=0,d.Texture=function(a,b,c,e){this.noFrame=!1,b||(this.noFrame=!0,b=new d.Rectangle(0,0,1,1)),a instanceof d.Texture&&(a=a.baseTexture),this.baseTexture=a,this.frame=b,this.trim=e,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=c||new d.Rectangle(0,0,1,1),a.hasLoaded?(this.noFrame&&(b=new d.Rectangle(0,0,a.width,a.height)),this.setFrame(b)):a.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))},d.Texture.prototype.constructor=d.Texture,d.EventTarget.mixin(d.Texture.prototype),d.Texture.prototype.onBaseTextureLoaded=function(){var a=this.baseTexture;a.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new d.Rectangle(0,0,a.width,a.height)),this.setFrame(this.frame),this.dispatchEvent({type:"update",content:this})},d.Texture.prototype.destroy=function(a){a&&this.baseTexture.destroy(),this.valid=!1},d.Texture.prototype.setFrame=function(a){if(this.noFrame=!1,this.frame=a,this.width=a.width,this.height=a.height,this.crop.x=a.x,this.crop.y=a.y,this.crop.width=a.width,this.crop.height=a.height,!this.trim&&(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=a&&a.width&&a.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()},d.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new d.TextureUvs);var a=this.crop,b=this.baseTexture.width,c=this.baseTexture.height;this._uvs.x0=a.x/b,this._uvs.y0=a.y/c,this._uvs.x1=(a.x+a.width)/b,this._uvs.y1=a.y/c,this._uvs.x2=(a.x+a.width)/b,this._uvs.y2=(a.y+a.height)/c,this._uvs.x3=a.x/b,this._uvs.y3=(a.y+a.height)/c},d.Texture.fromImage=function(a,b,c){var e=d.TextureCache[a];return e||(e=new d.Texture(d.BaseTexture.fromImage(a,b,c)),d.TextureCache[a]=e),e},d.Texture.fromFrame=function(a){var b=d.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache ');return b},d.Texture.fromCanvas=function(a,b){var c=d.BaseTexture.fromCanvas(a,b);return new d.Texture(c)},d.Texture.addTextureToCache=function(a,b){d.TextureCache[b]=a},d.Texture.removeTextureFromCache=function(a){var b=d.TextureCache[a];return delete d.TextureCache[a],delete d.BaseTextureCache[a],b},d.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},d.Texture.emptyTexture=new d.Texture(new d.BaseTexture),d.RenderTexture=function(a,b,c,e,f){if(this.width=a||100,this.height=b||100,this.resolution=f||1,this.frame=new d.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new d.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new d.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=e||d.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,d.Texture.call(this,this.baseTexture,new d.Rectangle(0,0,this.width,this.height)),this.renderer=c||d.defaultRenderer,this.renderer.type===d.WEBGL_RENDERER){var g=this.renderer.gl;this.baseTexture._dirty[g.id]=!1,this.textureBuffer=new d.FilterTexture(g,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode),this.baseTexture._glTextures[g.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new d.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new d.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()},d.RenderTexture.prototype=Object.create(d.Texture.prototype),d.RenderTexture.prototype.constructor=d.RenderTexture,d.RenderTexture.prototype.resize=function(a,b,c){(a!==this.width||b!==this.height)&&(this.valid=a>0&&b>0,this.width=this.frame.width=this.crop.width=a,this.height=this.frame.height=this.crop.height=b,c&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===d.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution))},d.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===d.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},d.RenderTexture.prototype.renderWebGL=function(a,b,c){if(this.valid){var d=a.worldTransform;d.identity(),d.translate(0,2*this.projection.y),b&&d.append(b),d.scale(1,-1),a.worldAlpha=1;for(var e=a.children,f=0,g=e.length;g>f;f++)e[f].updateTransform();var h=this.renderer.gl;h.viewport(0,0,this.width*this.resolution,this.height*this.resolution),h.bindFramebuffer(h.FRAMEBUFFER,this.textureBuffer.frameBuffer),c&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(a,this.projection,this.textureBuffer.frameBuffer),this.renderer.spriteBatch.dirty=!0}},d.RenderTexture.prototype.renderCanvas=function(a,b,c){if(this.valid){var d=a.worldTransform;d.identity(),b&&d.append(b),a.worldAlpha=1;for(var e=a.children,f=0,g=e.length;g>f;f++)e[f].updateTransform();c&&this.textureBuffer.clear();var h=this.textureBuffer.context,i=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(a,h),this.renderer.resolution=i}},d.RenderTexture.prototype.getImage=function(){var a=new Image;return a.src=this.getBase64(),a},d.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},d.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===d.WEBGL_RENDERER){var a=this.renderer.gl,b=this.textureBuffer.width,c=this.textureBuffer.height,e=new Uint8Array(4*b*c);a.bindFramebuffer(a.FRAMEBUFFER,this.textureBuffer.frameBuffer),a.readPixels(0,0,b,c,a.RGBA,a.UNSIGNED_BYTE,e),a.bindFramebuffer(a.FRAMEBUFFER,null);var f=new d.CanvasBuffer(b,c),g=f.context.getImageData(0,0,b,c);return g.data.set(e),f.context.putImageData(g,0,0),f.canvas}return this.textureBuffer.canvas},d.RenderTexture.tempMatrix=new d.Matrix,d.VideoTexture=function(a,b){if(!a)throw new Error("No video source element specified.");(a.readyState===a.HAVE_ENOUGH_DATA||a.readyState===a.HAVE_FUTURE_DATA)&&a.width&&a.height&&(a.complete=!0),d.BaseTexture.call(this,a,b),this.autoUpdate=!1,this.updateBound=this._onUpdate.bind(this),a.complete||(this._onCanPlay=this.onCanPlay.bind(this),a.addEventListener("canplay",this._onCanPlay),a.addEventListener("canplaythrough",this._onCanPlay),a.addEventListener("play",this.onPlayStart.bind(this)),a.addEventListener("pause",this.onPlayStop.bind(this)))},d.VideoTexture.prototype=Object.create(d.BaseTexture.prototype),d.VideoTexture.constructor=d.VideoTexture,d.VideoTexture.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this.updateBound),this.dirty())},d.VideoTexture.prototype.onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this.updateBound),this.autoUpdate=!0)},d.VideoTexture.prototype.onPlayStop=function(){this.autoUpdate=!1},d.VideoTexture.prototype.onCanPlay=function(){"canplaythrough"===event.type&&(this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.dispatchEvent({type:"loaded",content:this}))))},d.VideoTexture.prototype.destroy=function(){this.source&&this.source._pixiId&&(d.BaseTextureCache[this.source._pixiId]=null,delete d.BaseTextureCache[this.source._pixiId],this.source._pixiId=null,delete this.source._pixiId),d.BaseTexture.prototype.destroy.call(this)},d.VideoTexture.baseTextureFromVideo=function(a,b){a._pixiId||(a._pixiId="video_"+d.TextureCacheIdGenerator++);var c=d.BaseTextureCache[a._pixiId];return c||(c=new d.VideoTexture(a,b),d.BaseTextureCache[a._pixiId]=c),c},d.VideoTexture.textureFromVideo=function(a,b){var c=d.VideoTexture.baseTextureFromVideo(a,b);return new d.Texture(c)},d.VideoTexture.fromUrl=function(a,b){var c=document.createElement("video");return c.src=a,c.autoPlay=!0,c.play(),d.VideoTexture.textureFromVideo(c,b)},d.AssetLoader=function(a,b){this.assetURLs=a,this.crossorigin=b,this.loadersByType={jpg:d.ImageLoader,jpeg:d.ImageLoader,png:d.ImageLoader,gif:d.ImageLoader,webp:d.ImageLoader,json:d.JsonLoader,atlas:d.AtlasLoader,anim:d.SpineLoader,xml:d.BitmapFontLoader,fnt:d.BitmapFontLoader}},d.EventTarget.mixin(d.AssetLoader.prototype),d.AssetLoader.prototype.constructor=d.AssetLoader,d.AssetLoader.prototype._getDataType=function(a){var b="data:",c=a.slice(0,b.length).toLowerCase();if(c===b){var d=a.slice(b.length),e=d.indexOf(",");if(-1===e)return null;var f=d.slice(0,e).split(";")[0];return f&&"text/plain"!==f.toLowerCase()?f.split("/").pop().toLowerCase():"txt"}return null},d.AssetLoader.prototype.load=function(){function a(a){b.onAssetLoaded(a.data.content)}var b=this;this.loadCount=this.assetURLs.length;for(var c=0;c<this.assetURLs.length;c++){var d=this.assetURLs[c],e=this._getDataType(d);e||(e=d.split("?").shift().split(".").pop().toLowerCase());var f=this.loadersByType[e];if(!f)throw new Error(e+" is an unsupported file type");var g=new f(d,this.crossorigin);g.on("loaded",a),g.load()}},d.AssetLoader.prototype.onAssetLoaded=function(a){this.loadCount--,this.emit("onProgress",{content:this,loader:a}),this.onProgress&&this.onProgress(a),this.loadCount||(this.emit("onComplete",{content:this}),this.onComplete&&this.onComplete())},d.JsonLoader=function(a,b){this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.loaded=!1},d.JsonLoader.prototype.constructor=d.JsonLoader,d.EventTarget.mixin(d.JsonLoader.prototype),d.JsonLoader.prototype.load=function(){window.XDomainRequest&&this.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=this.onError.bind(this),this.ajaxRequest.ontimeout=this.onError.bind(this),this.ajaxRequest.onprogress=function(){},this.ajaxRequest.onload=this.onJSONLoaded.bind(this)):(this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onreadystatechange=this.onReadyStateChanged.bind(this)),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},d.JsonLoader.prototype.onReadyStateChanged=function(){4!==this.ajaxRequest.readyState||200!==this.ajaxRequest.status&&-1!==window.location.href.indexOf("http")||this.onJSONLoaded()},d.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames&&this.json.meta&&this.json.meta.image){var a=this.baseUrl+this.json.meta.image,b=new d.ImageLoader(a,this.crossorigin),c=this.json.frames;this.texture=b.texture.baseTexture,b.addEventListener("loaded",this.onLoaded.bind(this));for(var f in c){var g=c[f].frame;if(g){var h=new d.Rectangle(g.x,g.y,g.w,g.h),i=h.clone(),j=null;if(c[f].trimmed){var k=c[f].sourceSize,l=c[f].spriteSourceSize;j=new d.Rectangle(l.x,l.y,k.w,k.h)}d.TextureCache[f]=new d.Texture(this.texture,h,i,j)}}b.load()}else if(this.json.bones)if(d.AnimCache[this.url])this.onLoaded();else{var m=this.url.substr(0,this.url.lastIndexOf("."))+".atlas",n=new d.JsonLoader(m,this.crossorigin),o=this;n.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();var a=new d.SpineTextureLoader(this.url.substring(0,this.url.lastIndexOf("/"))),b=new e.Atlas(this.ajaxRequest.responseText,a),c=new e.AtlasAttachmentLoader(b),f=new e.SkeletonJson(c),g=f.readSkeletonData(o.json);d.AnimCache[o.url]=g,o.spine=g,o.spineAtlas=b,o.spineAtlasLoader=n,a.loadingCount>0?a.addEventListener("loadedBaseTexture",function(a){a.content.content.loadingCount<=0&&o.onLoaded()}):o.onLoaded()},n.load()}else this.onLoaded()},d.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},d.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},d.AtlasLoader=function(a,b){this.url=a,this.baseUrl=a.replace(/[^\/]*$/,""),this.crossorigin=b,this.loaded=!1},d.AtlasLoader.constructor=d.AtlasLoader,d.EventTarget.mixin(d.AtlasLoader.prototype),d.AtlasLoader.prototype.load=function(){this.ajaxRequest=new d.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},d.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var a=this.ajaxRequest.responseText.split(/\r?\n/),b=-3,c=0,e=null,f=!1,g=0,h=0,i=this.onLoaded.bind(this);for(g=0;g<a.length;g++)if(a[g]=a[g].replace(/^\s+|\s+$/g,""),""===a[g]&&(f=g+1),a[g].length>0){if(f===g)this.atlas.meta.image.push(a[g]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),b=-3;else if(b>0)if(b%7===1)null!=e&&(this.atlas.frames[c][e.name]=e),e={name:a[g],frame:{}};else{var j=a[g].split(" ");if(b%7===3)e.frame.x=Number(j[1].replace(",","")),e.frame.y=Number(j[2]);else if(b%7===4)e.frame.w=Number(j[1].replace(",","")),e.frame.h=Number(j[2]);else if(b%7===5){var k={x:0,y:0,w:Number(j[1].replace(",","")),h:Number(j[2])};k.w>e.frame.w||k.h>e.frame.h?(e.trimmed=!0,e.realSize=k):e.trimmed=!1}}b++}if(null!=e&&(this.atlas.frames[c][e.name]=e),this.atlas.meta.image.length>0){for(this.images=[],h=0;h<this.atlas.meta.image.length;h++){var l=this.baseUrl+this.atlas.meta.image[h],m=this.atlas.frames[h];this.images.push(new d.ImageLoader(l,this.crossorigin));for(g in m){var n=m[g].frame;n&&(d.TextureCache[g]=new d.Texture(this.images[h].texture.baseTexture,{x:n.x,y:n.y,width:n.w,height:n.h}),m[g].trimmed&&(d.TextureCache[g].realSize=m[g].realSize,d.TextureCache[g].trim.x=0,d.TextureCache[g].trim.y=0))}}for(this.currentImageId=0,h=0;h<this.images.length;h++)this.images[h].on("loaded",i);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},d.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.emit("loaded",{content:this}))},d.AtlasLoader.prototype.onError=function(){this.emit("error",{content:this})},d.SpriteSheetLoader=function(a,b){this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},d.SpriteSheetLoader.prototype.constructor=d.SpriteSheetLoader,d.EventTarget.mixin(d.SpriteSheetLoader.prototype),d.SpriteSheetLoader.prototype.load=function(){var a=this,b=new d.JsonLoader(this.url,this.crossorigin);b.on("loaded",function(b){a.json=b.data.content.json,a.onLoaded()}),b.load()},d.SpriteSheetLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},d.ImageLoader=function(a,b){this.texture=d.Texture.fromImage(a,b),this.frames=[]},d.ImageLoader.prototype.constructor=d.ImageLoader,d.EventTarget.mixin(d.ImageLoader.prototype),d.ImageLoader.prototype.load=function(){this.texture.baseTexture.hasLoaded?this.onLoaded():this.texture.baseTexture.on("loaded",this.onLoaded.bind(this))},d.ImageLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},d.ImageLoader.prototype.loadFramedSpriteSheet=function(a,b,c){this.frames=[];for(var e=Math.floor(this.texture.width/a),f=Math.floor(this.texture.height/b),g=0,h=0;f>h;h++)for(var i=0;e>i;i++,g++){var j=new d.Texture(this.texture.baseTexture,{x:i*a,y:h*b,width:a,height:b});this.frames.push(j),c&&(d.TextureCache[c+"-"+g]=j)}this.load()},d.BitmapFontLoader=function(a,b){this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null},d.BitmapFontLoader.prototype.constructor=d.BitmapFontLoader,d.EventTarget.mixin(d.BitmapFontLoader.prototype),d.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new d.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},d.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var a=this.ajaxRequest.responseXML;if(!a||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var b=new DOMParser;a=b.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var c=document.createElement("div");c.innerHTML=this.ajaxRequest.responseText,a=c}var e=this.baseUrl+a.getElementsByTagName("page")[0].getAttribute("file"),f=new d.ImageLoader(e,this.crossorigin);this.texture=f.texture.baseTexture;var g={},h=a.getElementsByTagName("info")[0],i=a.getElementsByTagName("common")[0];g.font=h.getAttribute("face"),g.size=parseInt(h.getAttribute("size"),10),g.lineHeight=parseInt(i.getAttribute("lineHeight"),10),g.chars={};for(var j=a.getElementsByTagName("char"),k=0;k<j.length;k++){var l=parseInt(j[k].getAttribute("id"),10),m=new d.Rectangle(parseInt(j[k].getAttribute("x"),10),parseInt(j[k].getAttribute("y"),10),parseInt(j[k].getAttribute("width"),10),parseInt(j[k].getAttribute("height"),10));g.chars[l]={xOffset:parseInt(j[k].getAttribute("xoffset"),10),yOffset:parseInt(j[k].getAttribute("yoffset"),10),xAdvance:parseInt(j[k].getAttribute("xadvance"),10),kerning:{},texture:d.TextureCache[l]=new d.Texture(this.texture,m)}}var n=a.getElementsByTagName("kerning");for(k=0;k<n.length;k++){var o=parseInt(n[k].getAttribute("first"),10),p=parseInt(n[k].getAttribute("second"),10),q=parseInt(n[k].getAttribute("amount"),10);g.chars[p].kerning[o]=q}d.BitmapText.fonts[g.font]=g,f.addEventListener("loaded",this.onLoaded.bind(this)),f.load()}},d.BitmapFontLoader.prototype.onLoaded=
function(){this.emit("loaded",{content:this})},d.SpineLoader=function(a,b){this.url=a,this.crossorigin=b,this.loaded=!1},d.SpineLoader.prototype.constructor=d.SpineLoader,d.EventTarget.mixin(d.SpineLoader.prototype),d.SpineLoader.prototype.load=function(){var a=this,b=new d.JsonLoader(this.url,this.crossorigin);b.on("loaded",function(b){a.json=b.data.content.json,a.onLoaded()}),b.load()},d.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.emit("loaded",{content:this})},d.AbstractFilter=function(a,b){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=b||{},this.fragmentSrc=a||[]},d.AbstractFilter.prototype.constructor=d.AbstractFilter,d.AbstractFilter.prototype.syncUniforms=function(){for(var a=0,b=this.shaders.length;b>a;a++)this.shaders[a].dirty=!0},d.AlphaMaskFilter=function(a){d.AbstractFilter.call(this),this.passes=[this],a.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:a},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},a.baseTexture.hasLoaded?(this.uniforms.mask.value.x=a.width,this.uniforms.mask.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},d.AlphaMaskFilter.prototype=Object.create(d.AbstractFilter.prototype),d.AlphaMaskFilter.prototype.constructor=d.AlphaMaskFilter,d.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(d.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(a){this.uniforms.mask.value=a}}),d.ColorMatrixFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},d.ColorMatrixFilter.prototype=Object.create(d.AbstractFilter.prototype),d.ColorMatrixFilter.prototype.constructor=d.ColorMatrixFilter,Object.defineProperty(d.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(a){this.uniforms.matrix.value=a}}),d.GrayFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},d.GrayFilter.prototype=Object.create(d.AbstractFilter.prototype),d.GrayFilter.prototype.constructor=d.GrayFilter,Object.defineProperty(d.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(a){this.uniforms.gray.value=a}}),d.DisplacementFilter=function(a){d.AbstractFilter.call(this),this.passes=[this],a.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:a},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},a.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=a.width,this.uniforms.mapDimensions.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},d.DisplacementFilter.prototype=Object.create(d.AbstractFilter.prototype),d.DisplacementFilter.prototype.constructor=d.DisplacementFilter,d.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(d.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(a){this.uniforms.displacementMap.value=a}}),Object.defineProperty(d.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}}),Object.defineProperty(d.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}),d.PixelateFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new d.Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},d.PixelateFilter.prototype=Object.create(d.AbstractFilter.prototype),d.PixelateFilter.prototype.constructor=d.PixelateFilter,Object.defineProperty(d.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.dirty=!0,this.uniforms.pixelSize.value=a}}),d.BlurXFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},d.BlurXFilter.prototype=Object.create(d.AbstractFilter.prototype),d.BlurXFilter.prototype.constructor=d.BlurXFilter,Object.defineProperty(d.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.dirty=!0,this.uniforms.blur.value=1/7e3*a}}),d.BlurYFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},d.BlurYFilter.prototype=Object.create(d.AbstractFilter.prototype),d.BlurYFilter.prototype.constructor=d.BlurYFilter,Object.defineProperty(d.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),d.BlurFilter=function(){this.blurXFilter=new d.BlurXFilter,this.blurYFilter=new d.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},d.BlurFilter.prototype=Object.create(d.AbstractFilter.prototype),d.BlurFilter.prototype.constructor=d.BlurFilter,Object.defineProperty(d.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a}}),Object.defineProperty(d.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}}),Object.defineProperty(d.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}),d.InvertFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},d.InvertFilter.prototype=Object.create(d.AbstractFilter.prototype),d.InvertFilter.prototype.constructor=d.InvertFilter,Object.defineProperty(d.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(a){this.uniforms.invert.value=a}}),d.SepiaFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},d.SepiaFilter.prototype=Object.create(d.AbstractFilter.prototype),d.SepiaFilter.prototype.constructor=d.SepiaFilter,Object.defineProperty(d.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(a){this.uniforms.sepia.value=a}}),d.TwistFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},d.TwistFilter.prototype=Object.create(d.AbstractFilter.prototype),d.TwistFilter.prototype.constructor=d.TwistFilter,Object.defineProperty(d.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.dirty=!0,this.uniforms.offset.value=a}}),Object.defineProperty(d.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(a){this.dirty=!0,this.uniforms.radius.value=a}}),Object.defineProperty(d.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),d.ColorStepFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},d.ColorStepFilter.prototype=Object.create(d.AbstractFilter.prototype),d.ColorStepFilter.prototype.constructor=d.ColorStepFilter,Object.defineProperty(d.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(a){this.uniforms.step.value=a}}),d.DotScreenFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},d.DotScreenFilter.prototype=Object.create(d.AbstractFilter.prototype),d.DotScreenFilter.prototype.constructor=d.DotScreenFilter,Object.defineProperty(d.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.dirty=!0,this.uniforms.scale.value=a}}),Object.defineProperty(d.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),d.CrossHatchFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},d.CrossHatchFilter.prototype=Object.create(d.AbstractFilter.prototype),d.CrossHatchFilter.prototype.constructor=d.CrossHatchFilter,Object.defineProperty(d.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),d.RGBSplitFilter=function(){d.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},d.RGBSplitFilter.prototype=Object.create(d.AbstractFilter.prototype),d.RGBSplitFilter.prototype.constructor=d.RGBSplitFilter,Object.defineProperty(d.RGBSplitFilter.prototype,"red",{get:function(){return this.uniforms.red.value},set:function(a){this.uniforms.red.value=a}}),Object.defineProperty(d.RGBSplitFilter.prototype,"green",{get:function(){return this.uniforms.green.value},set:function(a){this.uniforms.green.value=a}}),Object.defineProperty(d.RGBSplitFilter.prototype,"blue",{get:function(){return this.uniforms.blue.value},set:function(a){this.uniforms.blue.value=a}}),"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=d),c.PIXI=d):"undefined"!=typeof define&&define.amd?define(d):a.PIXI=d})).call(this)},{}],118:[function(a,b,c){((function(a){(function(a){"use strict";if(typeof bootstrap=="function")bootstrap("promise",a);else if(typeof c=="object"&&typeof b=="object")b.exports=a();else if(typeof define=="function"&&define.amd)define(a);else if(typeof ses!="undefined"){if(!ses.ok())return;ses.makeQ=a}else{if(typeof window=="undefined"&&typeof self=="undefined")throw new Error("This environment was not anticipated by Q. Please file a bug.");var d=typeof window!="undefined"?window:self,e=d.Q;d.Q=a(),d.Q.noConflict=function(){return d.Q=e,this}}})(function(){function i(a){return function(){return h.apply(a,arguments)}}function s(a){return a===Object(a)}function t(a){return r(a)==="[object StopIteration]"||a instanceof u}function w(a,c){if(b&&c.stack&&typeof a=="object"&&a!==null&&a.stack){var d=[];for(var e=c;!!e;e=e.source)e.stack&&(!a.__minimumStackCounter__||a.__minimumStackCounter__>e.stackCounter)&&(o(a,"__minimumStackCounter__",{value:e.stackCounter,configurable:!0}),d.unshift(e.stack));d.unshift(a.stack);var f=d.join("\n"+v+"\n"),g=x(f);o(a,"stack",{value:g,configurable:!0})}}function x(a){var b=a.split("\n"),c=[];for(var d=0;d<b.length;++d){var e=b[d];!A(e)&&!y(e)&&e&&c.push(e)}return c.join("\n")}function y(a){return a.indexOf("(module.js:")!==-1||a.indexOf("(node.js:")!==-1}function z(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);if(d)return[d[1],Number(d[2])]}function A(a){var b=z(a);if(!b)return!1;var c=b[0],f=b[1];return c===e&&f>=d&&f<=bl}function B(){if(!b)return;try{throw new Error}catch(a){var c=a.stack.split("\n"),d=c[0].indexOf("@")>0?c[1]:c[2],f=z(d);if(!f)return;return e=f[0],f[1]}}function C(a,b,c){return function(){return typeof console!="undefined"&&typeof console.warn=="function"&&console.warn(b+" is deprecated, use "+c+" instead.",(new Error("")).stack),a.apply(a,arguments)}}function D(a){return a instanceof I?a:M(a)?Z(a):Y(a)}function F(){function h(e){d=e,D.longStackSupport&&b&&(f.source=e),k(a,function(a,b){D.nextTick(function(){e.promiseDispatch.apply(e,b)})},void 0),a=void 0,c=void 0}var a=[],c=[],d,e=n(F.prototype),f=n(I.prototype);f.promiseDispatch=function(b,e,f){var g=j(arguments);a?(a.push(g),e==="when"&&f[1]&&c.push(f[1])):D.nextTick(function(){d.promiseDispatch.apply(d,g)})},f.valueOf=function(){if(a)return f;var b=K(d);return L(b)&&(d=b),b},f.inspect=function(){return d?d.inspect():{state:"pending"}};if(D.longStackSupport&&b)try{throw new Error}catch(g){f.stack=g.stack.substring(g.stack.indexOf("\n")+1),f.stackCounter=E++}return e.promise=f,e.resolve=function(a){if(d)return;h(D(a))},e.fulfill=function(a){if(d)return;h(Y(a))},e.reject=function(a){if(d)return;h(X(a))},e.notify=function(a){if(d)return;k(c,function(b,c){D.nextTick(function(){c(a)})},void 0)},e}function G(a){if(typeof a!="function")throw new TypeError("resolver must be a function.");var b=F();try{a(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}return b.promise}function H(a){return G(function(b,c){for(var d=0,e=a.length;d<e;d++)D(a[d]).then(b,c)})}function I(a,b,c){b===void 0&&(b=function(a){return X(new Error("Promise does not support operation: "+a))}),c===void 0&&(c=function(){return{state:"unknown"}});var d=n(I.prototype);d.promiseDispatch=function(c,e,f){var g;try{a[e]?g=a[e].apply(d,f):g=b.call(d,e,f)}catch(h){g=X(h)}c&&c(g)},d.inspect=c;if(c){var e=c();e.state==="rejected"&&(d.exception=e.reason),d.valueOf=function(){var a=c();return a.state==="pending"||a.state==="rejected"?d:a.value}}return d}function J(a,b,c,d){return D(a).then(b,c,d)}function K(a){if(L(a)){var b=a.inspect();if(b.state==="fulfilled")return b.value}return a}function L(a){return a instanceof I}function M(a){return s(a)&&typeof a.then=="function"}function N(a){return L(a)&&a.inspect().state==="pending"}function O(a){return!L(a)||a.inspect().state==="fulfilled"}function P(a){return L(a)&&a.inspect().state==="rejected"}function U(){Q.length=0,R.length=0,T||(T=!0)}function V(b,c){if(!T)return;typeof a=="object"&&typeof a.emit=="function"&&D.nextTick.runAfter(function(){l(R,b)!==-1&&(a.emit("unhandledRejection",c,b),S.push(b))}),R.push(b),c&&typeof c.stack!="undefined"?Q.push(c.stack):Q.push("(no stack) "+c)}function W(b){if(!T)return;var c=l(R,b);c!==-1&&(typeof a=="object"&&typeof a.emit=="function"&&D.nextTick.runAfter(function(){var d=l(S,b);d!==-1&&(a.emit("rejectionHandled",Q[c],b),S.splice(d,1))}),R.splice(c,1),Q.splice(c,1))}function X(a){var b=I({when:function(b){return b&&W(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return V(b,a),b}function Y(a){return I({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return b===null||b===void 0?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return q(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function Z(a){var b=F();return D.nextTick(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}}),b.promise}function $(a){return I({isDef:function(){}},function(c,d){return be(a,c,d)},function(){return D(a).inspect()})}function _(a,b,c){return D(a).spread(b,c)}function ba(a){return function(){function b(a,b){var f;if(typeof StopIteration=="undefined"){try{f=c[a](b)}catch(g){return X(g)}return f.done?D(f.value):J(f.value,d,e)}try{f=c[a](b)}catch(g){return t(g)?D(g.value):X(g)}return J(f,d,e)}var c=a.apply(this,arguments),d=b.bind(b,"next"),e=b.bind(b,"throw");return d()}}function bb(a){D.done(D.async(a)())}function bc(a){throw new u(a)}function bd(a){return function(){return _([this,bf(arguments)],function(b,c){return a.apply(b,c)})}}function be(a,b,c){return D(a).dispatch(b,c)}function bf(a){return J(a,function(a){var b=0,c=F();return k(a,function(d,e,f){var g;L(e)&&(g=e.inspect()).state==="fulfilled"?a[f]=g.value:(++b,J(e,function(d){a[f]=d,--b===0&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),b===0&&c.resolve(a),c.promise})}function bg(a){if(a.length===0)return D.resolve();var b=D.defer(),c=0;return k(a,function(d,e,f){function h(a){b.resolve(a)}function i(a){c--,c===0&&(a.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+a.message,b.reject(a))}function j(a){b.notify({index:f,value:a})}var g=a[f];c++,J(g,h,i,j)},undefined),b.promise}function bh(a){return J(a,function(a){return a=m(a,D),J(bf(m(a,function(a){return J(a,f,f)})),function(){return a})})}function bi(a){return D(a).allSettled()}function bj(a,b){return D(a).then(void 0,void 0,b)}function bk(a,b){return D(a).nodeify(b)}"use strict";var b=!1;try{throw new Error}catch(c){b=!!c.stack}var d=B(),e,f=function(){},g=function(){function i(){var a,c;while(b.next)b=b.next,a=b.task,b.task=void 0,c=b.domain,c&&(b.domain=void 0,c.enter()),j(a,c);while(h.length)a=h.pop(),j(a);d=!1}function j(a,b){try{a()}catch(c){if(f)throw b&&b.exit(),setTimeout(i,0),b&&b.enter(),c;setTimeout(function(){throw c},0)}b&&b.exit()}var b={task:void 0,next:null},c=b,d=!1,e=void 0,f=!1,h=[];g=function(b){c=c.next={task:b,domain:f&&a.domain,next:null},d||(d=!0,e())};if(typeof a=="object"&&a.toString()==="[object process]"&&a.nextTick)f=!0,e=function(){a.nextTick(i)};else if(typeof setImmediate=="function")typeof window!="undefined"?e=setImmediate.bind(window,i):e=function(){setImmediate(i)};else if(typeof MessageChannel!="undefined"){var k=new MessageChannel;k.port1.onmessage=function(){e=l,k.port1.onmessage=i,i()};var l=function(){k.port2.postMessage(0)};e=function(){setTimeout(i,0),l()}}else e=function(){setTimeout(i,0)};return g.runAfter=function(a){h.push(a),d||(d=!0,e())},g}(),h=Function.call,j=i(Array.prototype.slice),k=i(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(arguments.length===1)do{if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}while(1);for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),l=i(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),m=i(Array.prototype.map||function(a,b){var c=this,d=[];return k(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),n=Object.create||function(a){function b(){}return b.prototype=a,new b},o=Object.defineProperty||function(a,b,c){return a[b]=c.value,a},p=i(Object.prototype.hasOwnProperty),q=Object.keys||function(a){var b=[];for(var c in a)p(a,c)&&b.push(c);return b},r=i(Object.prototype.toString),u;typeof ReturnValue!="undefined"?u=ReturnValue:u=function(a){this.value=a};var v="From previous event:";D.resolve=D,D.nextTick=g,D.longStackSupport=!1;var E=1;typeof a=="object"&&a&&a.env&&a.env.Q_DEBUG&&(D.longStackSupport=!0),D.defer=F,F.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(j(arguments,1)):a.resolve(c)}},D.Promise=G,D.promise=G,G.race=H,G.all=bf,G.reject=X,G.resolve=D,D.passByCopy=function(a){return a},I.prototype.passByCopy=function(){return this},D.join=function(a,b){return D(a).join(b)},I.prototype.join=function(a){return D([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Q can't join: not the same: "+a+" "+b)})},D.race=H,I.prototype.race=function(){return this.then(D.race)},D.makePromise=I,I.prototype.toString=function(){return"[object Promise]"},I.prototype.then=function(a,b,c){function g(b){try{return typeof a=="function"?a(b):b}catch(c){return X(c)}}function h(a){if(typeof b=="function"){w(a,d);try{return b(a)}catch(c){return X(c)}}return X(a)}function i(a){return typeof c=="function"?c(a):a}var d=this,e=F(),f=!1;return D.nextTick(function(){d.promiseDispatch(function(a){if(f)return;f=!0,e.resolve(g(a))},"when",[function(a){if(f)return;f=!0,e.resolve(h(a))}])}),d.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=i(a)}catch(d){c=!0;if(!D.onerror)throw d;D.onerror(d)}c||e.notify(b)}]),e.promise},D.tap=function(a,b){return D(a).tap(b)},I.prototype.tap=function(a){return a=D(a),this.then(function(b){return a.fcall(b).thenResolve(b)})},D.when=J,I.prototype.thenResolve=function(a){return this.then(function(){return a})},D.thenResolve=function(a,b){return D(a).thenResolve(b)},I.prototype.thenReject=function(a){return this.then(function(){throw a})},D.thenReject=function(a,b){return D(a).thenReject(b)},D.nearer=K,D.isPromise=L,D.isPromiseAlike=M,D.isPending=N,I.prototype.isPending=function(){return this.inspect().state==="pending"},D.isFulfilled=O,I.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"},D.isRejected=P,I.prototype.isRejected=function(){return this.inspect().state==="rejected"};var Q=[],R=[],S=[],T=!0;D.resetUnhandledRejections=U,D.getUnhandledReasons=function(){return Q.slice()},D.stopUnhandledRejectionTracking=function(){U(),T=!1},U(),D.reject=X,D.fulfill=Y,D.master=$,D.spread=_,I.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},D.async=ba,D.spawn=bb,D["return"]=bc,D.promised=bd,D.dispatch=be,I.prototype.dispatch=function(a,b){var c=this,d=F();return D.nextTick(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},D.get=function(a,b){return D(a).dispatch("get",[b])},I.prototype.get=function(a){return this.dispatch("get",[a])},D.set=function(a,b,c){return D(a).dispatch("set",[b,c])},I.prototype.set=function(a,b){return this.dispatch("set",[a,b])},D.del=D["delete"]=function(a,b){return D(a).dispatch("delete",[b])},I.prototype.del=I.prototype["delete"]=function(a){return this.dispatch("delete",[a])},D.mapply=D.post=function(a,b,c){return D(a).dispatch("post",[b,c])},I.prototype.mapply=I.prototype.post=function(a,b){return this.dispatch("post",[a,b])},D.send=D.mcall=D.invoke=function(a,b){return D(a).dispatch("post",[b,j(arguments,2)])},I.prototype.send=I.prototype.mcall=I.prototype.invoke=function(a){return this.dispatch("post",[a,j(arguments,1)])},D.fapply=function(a,b){return D(a).dispatch("apply",[void 0,b])},I.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},D["try"]=D.fcall=function(a){return D(a).dispatch("apply",[void 0,j(arguments,1)])},I.prototype.fcall=function(){return this.dispatch("apply",[void 0,j(arguments)])},D.fbind=function(a){var b=D(a),c=j(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(j(arguments))])}},I.prototype.fbind=function(){var a=this,b=j(arguments);return function(){return a.dispatch("apply",[this,b.concat(j(arguments))])}},D.keys=function(a){return D(a).dispatch("keys",[])},I.prototype.keys=function(){return this.dispatch("keys",[])},D.all=bf,I.prototype.all=function(){return bf(this)},D.any=bg,I.prototype.any=function(){return bg(this)},D.allResolved=C(bh,"allResolved","allSettled"),I.prototype.allResolved=function(){return bh(this)},D.allSettled=bi,I.prototype.allSettled=function(){return this.then(function(a){return bf(m(a,function(a){function b(){return a.inspect()}return a=D(a),a.then(b,b)}))})},D.fail=D["catch"]=function(a,b){return D(a).then(void 0,b)},I.prototype.fail=I.prototype["catch"]=function(a){return this.then(void 0,a)},D.progress=bj,I.prototype.progress=function(a){return this.then(void 0,void 0,a)},D.fin=D["finally"]=function(a,b){return D(a)["finally"](b)},I.prototype.fin=I.prototype["finally"]=function(a){if(!a||typeof a.apply!="function")throw new Error("Q can't apply finally callback");return a=D(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},D.done=function(a,b,c,d){return D(a).done(b,c,d)},I.prototype.done=function(b,c,d){var e=function(a){D.nextTick(function(){w(a,f);if(!D.onerror)throw a;D.onerror(a)})},f=b||c||d?this.then(b,c,d):this;typeof a=="object"&&a&&a.domain&&(e=a.domain.bind(e)),f.then(void 0,e)},D.timeout=function(a,b,c){return D(a).timeout(b,c)},I.prototype.timeout=function(a,b){var c=F(),d=setTimeout(function(){if(!b||"string"==typeof b)b=new Error(b||"Timed out after "+a+" ms"),b.code="ETIMEDOUT";c.reject(b)},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),
c.promise},D.delay=function(a,b){return b===void 0&&(b=a,a=void 0),D(a).delay(b)},I.prototype.delay=function(a){return this.then(function(b){var c=F();return setTimeout(function(){c.resolve(b)},a),c.promise})},D.nfapply=function(a,b){return D(a).nfapply(b)},I.prototype.nfapply=function(a){var b=F(),c=j(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},D.nfcall=function(a){var b=j(arguments,1);return D(a).nfapply(b)},I.prototype.nfcall=function(){var a=j(arguments),b=F();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},D.nfbind=D.denodeify=function(a){if(a===undefined)throw new Error("Q can't wrap an undefined function");var b=j(arguments,1);return function(){var c=b.concat(j(arguments)),d=F();return c.push(d.makeNodeResolver()),D(a).fapply(c).fail(d.reject),d.promise}},I.prototype.nfbind=I.prototype.denodeify=function(){var a=j(arguments);return a.unshift(this),D.denodeify.apply(void 0,a)},D.nbind=function(a,b){var c=j(arguments,2);return function(){function f(){return a.apply(b,arguments)}var d=c.concat(j(arguments)),e=F();return d.push(e.makeNodeResolver()),D(f).fapply(d).fail(e.reject),e.promise}},I.prototype.nbind=function(){var a=j(arguments,0);return a.unshift(this),D.nbind.apply(void 0,a)},D.nmapply=D.npost=function(a,b,c){return D(a).npost(b,c)},I.prototype.nmapply=I.prototype.npost=function(a,b){var c=j(b||[]),d=F();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},D.nsend=D.nmcall=D.ninvoke=function(a,b){var c=j(arguments,2),d=F();return c.push(d.makeNodeResolver()),D(a).dispatch("post",[b,c]).fail(d.reject),d.promise},I.prototype.nsend=I.prototype.nmcall=I.prototype.ninvoke=function(a){var b=j(arguments,1),c=F();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},D.nodeify=bk,I.prototype.nodeify=function(a){if(!a)return this;this.then(function(b){D.nextTick(function(){a(null,b)})},function(b){D.nextTick(function(){a(b)})})},D.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var bl=B();return D})})).call(this,a(81))},{81:81}],119:[function(a,b,c){((function(a){(function(a){if(typeof bootstrap=="function")bootstrap("promise",a);else if(typeof c=="object")b.exports=a();else if(typeof define=="function"&&define.amd)define(a);else if(typeof ses!="undefined"){if(!ses.ok())return;ses.makeQ=a}else Q=a()})(function(){function i(a){return function(){return h.apply(a,arguments)}}function r(a){return a===Object(a)}function s(a){return q(a)==="[object StopIteration]"||a instanceof t}function v(a,c){if(b&&c.stack&&typeof a=="object"&&a!==null&&a.stack&&a.stack.indexOf(u)===-1){var d=[];for(var e=c;!!e;e=e.source)e.stack&&d.unshift(e.stack);d.unshift(a.stack);var f=d.join("\n"+u+"\n");a.stack=w(f)}}function w(a){var b=a.split("\n"),c=[];for(var d=0;d<b.length;++d){var e=b[d];!z(e)&&!x(e)&&e&&c.push(e)}return c.join("\n")}function x(a){return a.indexOf("(module.js:")!==-1||a.indexOf("(node.js:")!==-1}function y(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);if(d)return[d[1],Number(d[2])]}function z(a){var b=y(a);if(!b)return!1;var c=b[0],f=b[1];return c===e&&f>=d&&f<=bh}function A(){if(!b)return;try{throw new Error}catch(a){var c=a.stack.split("\n"),d=c[0].indexOf("@")>0?c[1]:c[2],f=y(d);if(!f)return;return e=f[0],f[1]}}function B(a,b,c){return function(){return typeof console!="undefined"&&typeof console.warn=="function"&&console.warn(b+" is deprecated, use "+c+" instead.",(new Error("")).stack),a.apply(a,arguments)}}function C(a){return J(a)?a:K(a)?W(a):V(a)}function D(){function i(b){d=b,f.source=b,k(a,function(a,c){g(function(){b.promiseDispatch.apply(b,c)})},void 0),a=void 0,c=void 0}var a=[],c=[],d,e=n(D.prototype),f=n(G.prototype);f.promiseDispatch=function(b,e,f){var h=j(arguments);a?(a.push(h),e==="when"&&f[1]&&c.push(f[1])):g(function(){d.promiseDispatch.apply(d,h)})},f.valueOf=function(){if(a)return f;var b=I(d);return J(b)&&(d=b),b},f.inspect=function(){return d?d.inspect():{state:"pending"}};if(C.longStackSupport&&b)try{throw new Error}catch(h){f.stack=h.stack.substring(h.stack.indexOf("\n")+1)}return e.promise=f,e.resolve=function(a){if(d)return;i(C(a))},e.fulfill=function(a){if(d)return;i(V(a))},e.reject=function(a){if(d)return;i(U(a))},e.notify=function(a){if(d)return;k(c,function(b,c){g(function(){c(a)})},void 0)},e}function E(a){if(typeof a!="function")throw new TypeError("resolver must be a function.");var b=D();try{a(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}return b.promise}function F(a){return E(function(b,c){for(var d=0,e=a.length;d<e;d++)C(a[d]).then(b,c)})}function G(a,b,c){b===void 0&&(b=function(a){return U(new Error("Promise does not support operation: "+a))}),c===void 0&&(c=function(){return{state:"unknown"}});var d=n(G.prototype);d.promiseDispatch=function(c,e,f){var g;try{a[e]?g=a[e].apply(d,f):g=b.call(d,e,f)}catch(h){g=U(h)}c&&c(g)},d.inspect=c;if(c){var e=c();e.state==="rejected"&&(d.exception=e.reason),d.valueOf=function(){var a=c();return a.state==="pending"||a.state==="rejected"?d:a.value}}return d}function H(a,b,c,d){return C(a).then(b,c,d)}function I(a){if(J(a)){var b=a.inspect();if(b.state==="fulfilled")return b.value}return a}function J(a){return r(a)&&typeof a.promiseDispatch=="function"&&typeof a.inspect=="function"}function K(a){return r(a)&&typeof a.then=="function"}function L(a){return J(a)&&a.inspect().state==="pending"}function M(a){return!J(a)||a.inspect().state==="fulfilled"}function N(a){return J(a)&&a.inspect().state==="rejected"}function R(){O.length=0,P.length=0,Q||(Q=!0)}function S(a,b){if(!Q)return;P.push(a),b&&typeof b.stack!="undefined"?O.push(b.stack):O.push("(no stack) "+b)}function T(a){if(!Q)return;var b=l(P,a);b!==-1&&(P.splice(b,1),O.splice(b,1))}function U(a){var b=G({when:function(b){return b&&T(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return S(b,a),b}function V(a){return G({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return b===null||b===void 0?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return p(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function W(a){var b=D();return g(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}}),b.promise}function X(a){return G({isDef:function(){}},function(c,d){return bb(a,c,d)},function(){return C(a).inspect()})}function Y(a,b,c){return C(a).spread(b,c)}function Z(a){return function(){function b(a,b){var f;if(typeof StopIteration=="undefined"){try{f=c[a](b)}catch(g){return U(g)}return f.done?f.value:H(f.value,d,e)}try{f=c[a](b)}catch(g){return s(g)?g.value:U(g)}return H(f,d,e)}var c=a.apply(this,arguments),d=b.bind(b,"next"),e=b.bind(b,"throw");return d()}}function $(a){C.done(C.async(a)())}function _(a){throw new t(a)}function ba(a){return function(){return Y([this,bc(arguments)],function(b,c){return a.apply(b,c)})}}function bb(a,b,c){return C(a).dispatch(b,c)}function bc(a){return H(a,function(a){var b=0,c=D();return k(a,function(d,e,f){var g;J(e)&&(g=e.inspect()).state==="fulfilled"?a[f]=g.value:(++b,H(e,function(d){a[f]=d,--b===0&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),b===0&&c.resolve(a),c.promise})}function bd(a){return H(a,function(a){return a=m(a,C),H(bc(m(a,function(a){return H(a,f,f)})),function(){return a})})}function be(a){return C(a).allSettled()}function bf(a,b){return C(a).then(void 0,void 0,b)}function bg(a,b){return C(a).nodeify(b)}"use strict";var b=!1;try{throw new Error}catch(c){b=!!c.stack}var d=A(),e,f=function(){},g=function(){function h(){while(b.next){b=b.next;var a=b.task;b.task=void 0;var c=b.domain;c&&(b.domain=void 0,c.enter());try{a()}catch(e){if(f)throw c&&c.exit(),setTimeout(h,0),c&&c.enter(),e;setTimeout(function(){throw e},0)}c&&c.exit()}d=!1}var b={task:void 0,next:null},c=b,d=!1,e=void 0,f=!1;g=function(b){c=c.next={task:b,domain:f&&a.domain,next:null},d||(d=!0,e())};if(typeof a!="undefined"&&a.nextTick)f=!0,e=function(){a.nextTick(h)};else if(typeof setImmediate=="function")typeof window!="undefined"?e=setImmediate.bind(window,h):e=function(){setImmediate(h)};else if(typeof MessageChannel!="undefined"){var i=new MessageChannel;i.port1.onmessage=function(){e=j,i.port1.onmessage=h,h()};var j=function(){i.port2.postMessage(0)};e=function(){setTimeout(h,0),j()}}else e=function(){setTimeout(h,0)};return g}(),h=Function.call,j=i(Array.prototype.slice),k=i(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(arguments.length===1)do{if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}while(1);for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),l=i(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),m=i(Array.prototype.map||function(a,b){var c=this,d=[];return k(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),n=Object.create||function(a){function b(){}return b.prototype=a,new b},o=i(Object.prototype.hasOwnProperty),p=Object.keys||function(a){var b=[];for(var c in a)o(a,c)&&b.push(c);return b},q=i(Object.prototype.toString),t;typeof ReturnValue!="undefined"?t=ReturnValue:t=function(a){this.value=a};var u="From previous event:";C.resolve=C,C.nextTick=g,C.longStackSupport=!1,C.defer=D,D.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(j(arguments,1)):a.resolve(c)}},C.Promise=E,C.promise=E,E.race=F,E.all=bc,E.reject=U,E.resolve=C,C.passByCopy=function(a){return a},G.prototype.passByCopy=function(){return this},C.join=function(a,b){return C(a).join(b)},G.prototype.join=function(a){return C([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Can't join: not the same: "+a+" "+b)})},C.race=F,G.prototype.race=function(){return this.then(C.race)},C.makePromise=G,G.prototype.toString=function(){return"[object Promise]"},G.prototype.then=function(a,b,c){function h(b){try{return typeof a=="function"?a(b):b}catch(c){return U(c)}}function i(a){if(typeof b=="function"){v(a,d);try{return b(a)}catch(c){return U(c)}}return U(a)}function j(a){return typeof c=="function"?c(a):a}var d=this,e=D(),f=!1;return g(function(){d.promiseDispatch(function(a){if(f)return;f=!0,e.resolve(h(a))},"when",[function(a){if(f)return;f=!0,e.resolve(i(a))}])}),d.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=j(a)}catch(d){c=!0;if(!C.onerror)throw d;C.onerror(d)}c||e.notify(b)}]),e.promise},C.when=H,G.prototype.thenResolve=function(a){return this.then(function(){return a})},C.thenResolve=function(a,b){return C(a).thenResolve(b)},G.prototype.thenReject=function(a){return this.then(function(){throw a})},C.thenReject=function(a,b){return C(a).thenReject(b)},C.nearer=I,C.isPromise=J,C.isPromiseAlike=K,C.isPending=L,G.prototype.isPending=function(){return this.inspect().state==="pending"},C.isFulfilled=M,G.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"},C.isRejected=N,G.prototype.isRejected=function(){return this.inspect().state==="rejected"};var O=[],P=[],Q=!0;C.resetUnhandledRejections=R,C.getUnhandledReasons=function(){return O.slice()},C.stopUnhandledRejectionTracking=function(){R(),Q=!1},R(),C.reject=U,C.fulfill=V,C.master=X,C.spread=Y,G.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},C.async=Z,C.spawn=$,C["return"]=_,C.promised=ba,C.dispatch=bb,G.prototype.dispatch=function(a,b){var c=this,d=D();return g(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},C.get=function(a,b){return C(a).dispatch("get",[b])},G.prototype.get=function(a){return this.dispatch("get",[a])},C.set=function(a,b,c){return C(a).dispatch("set",[b,c])},G.prototype.set=function(a,b){return this.dispatch("set",[a,b])},C.del=C["delete"]=function(a,b){return C(a).dispatch("delete",[b])},G.prototype.del=G.prototype["delete"]=function(a){return this.dispatch("delete",[a])},C.mapply=C.post=function(a,b,c){return C(a).dispatch("post",[b,c])},G.prototype.mapply=G.prototype.post=function(a,b){return this.dispatch("post",[a,b])},C.send=C.mcall=C.invoke=function(a,b){return C(a).dispatch("post",[b,j(arguments,2)])},G.prototype.send=G.prototype.mcall=G.prototype.invoke=function(a){return this.dispatch("post",[a,j(arguments,1)])},C.fapply=function(a,b){return C(a).dispatch("apply",[void 0,b])},G.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},C["try"]=C.fcall=function(a){return C(a).dispatch("apply",[void 0,j(arguments,1)])},G.prototype.fcall=function(){return this.dispatch("apply",[void 0,j(arguments)])},C.fbind=function(a){var b=C(a),c=j(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(j(arguments))])}},G.prototype.fbind=function(){var a=this,b=j(arguments);return function(){return a.dispatch("apply",[this,b.concat(j(arguments))])}},C.keys=function(a){return C(a).dispatch("keys",[])},G.prototype.keys=function(){return this.dispatch("keys",[])},C.all=bc,G.prototype.all=function(){return bc(this)},C.allResolved=B(bd,"allResolved","allSettled"),G.prototype.allResolved=function(){return bd(this)},C.allSettled=be,G.prototype.allSettled=function(){return this.then(function(a){return bc(m(a,function(a){function b(){return a.inspect()}return a=C(a),a.then(b,b)}))})},C.fail=C["catch"]=function(a,b){return C(a).then(void 0,b)},G.prototype.fail=G.prototype["catch"]=function(a){return this.then(void 0,a)},C.progress=bf,G.prototype.progress=function(a){return this.then(void 0,void 0,a)},C.fin=C["finally"]=function(a,b){return C(a)["finally"](b)},G.prototype.fin=G.prototype["finally"]=function(a){return a=C(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},C.done=function(a,b,c,d){return C(a).done(b,c,d)},G.prototype.done=function(b,c,d){var e=function(a){g(function(){v(a,f);if(!C.onerror)throw a;C.onerror(a)})},f=b||c||d?this.then(b,c,d):this;typeof a=="object"&&a&&a.domain&&(e=a.domain.bind(e)),f.then(void 0,e)},C.timeout=function(a,b,c){return C(a).timeout(b,c)},G.prototype.timeout=function(a,b){var c=D(),d=setTimeout(function(){c.reject(new Error(b||"Timed out after "+a+" ms"))},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),c.promise},C.delay=function(a,b){return b===void 0&&(b=a,a=void 0),C(a).delay(b)},G.prototype.delay=function(a){return this.then(function(b){var c=D();return setTimeout(function(){c.resolve(b)},a),c.promise})},C.nfapply=function(a,b){return C(a).nfapply(b)},G.prototype.nfapply=function(a){var b=D(),c=j(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},C.nfcall=function(a){var b=j(arguments,1);return C(a).nfapply(b)},G.prototype.nfcall=function(){var a=j(arguments),b=D();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},C.nfbind=C.denodeify=function(a){var b=j(arguments,1);return function(){var c=b.concat(j(arguments)),d=D();return c.push(d.makeNodeResolver()),C(a).fapply(c).fail(d.reject),d.promise}},G.prototype.nfbind=G.prototype.denodeify=function(){var a=j(arguments);return a.unshift(this),C.denodeify.apply(void 0,a)},C.nbind=function(a,b){var c=j(arguments,2);return function(){function f(){return a.apply(b,arguments)}var d=c.concat(j(arguments)),e=D();return d.push(e.makeNodeResolver()),C(f).fapply(d).fail(e.reject),e.promise}},G.prototype.nbind=function(){var a=j(arguments,0);return a.unshift(this),C.nbind.apply(void 0,a)},C.nmapply=C.npost=function(a,b,c){return C(a).npost(b,c)},G.prototype.nmapply=G.prototype.npost=function(a,b){var c=j(b||[]),d=D();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},C.nsend=C.nmcall=C.ninvoke=function(a,b){var c=j(arguments,2),d=D();return c.push(d.makeNodeResolver()),C(a).dispatch("post",[b,c]).fail(d.reject),d.promise},G.prototype.nsend=G.prototype.nmcall=G.prototype.ninvoke=function(a){var b=j(arguments,1),c=D();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},C.nodeify=bg,G.prototype.nodeify=function(a){if(!a)return this;this.then(function(b){g(function(){a(null,b)})},function(b){g(function(){a(b)})})};var bh=A();return C})})).call(this,a(81))},{81:81}],120:[function(a,b,c){(function(d){typeof c=="object"?b.exports=d(a(119)):typeof define=="function"&&define.amd?define(["q"],d):Qajax=d(Q)})(function(a){function c(a,c){return a in c?c[a]:b.defaults[a]}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function e(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return c.join("&")}function f(a){return a.indexOf("?")===-1}function g(a){b.defaults.logs&&window.console&&console.log(a)}"use strict";var b=function(){var b=arguments,i;if(!b.length)throw new Error("Qajax: settings are required");if(typeof b[0]=="string")i=typeof b[1]=="object"&&b[1]||{},i.url=b[0];else{if(typeof b[0]!="object")throw new Error("Qajax: settings must be an object");i=b[0]}if(!i.url)throw new Error("Qajax: settings.url is required");if("cancellation"in i&&!a.isPromiseAlike(i.cancellation))throw new Error("cancellation must be a Promise.");var j=new XMLHttpRequest,k=i.cancellation||a.defer().promise,l=c("method",i),m=c("base",i),n=i.url,o=i.data,p=i.responseType,q=i.params||{},r=a.defer(),s=c("timeout",i),t=d({},c("headers",i)),u=c("cache",i),v=c("withCredentials",i);u&&(q[u===!0?"_":u]=(new Date).getTime()),m&&(n=m+n);var w=e(q);return w&&(n=n+(f(n)?"?":"&")+w),o!==null&&typeof o=="object"&&(h in t||(t[h]="application/json"),o=JSON.stringify(o)),a.fcall(function(){j.onreadystatechange=function(){if(j.readyState===4)try{g(l+" "+n+" => "+j.status),j.status?r.resolve(j):r.reject(j)}catch(a){r.reject(j)}},j.onprogress=function(a){r.notify(a)},j.open(l,n,!0),p&&(j.responseType=p);for(var a in t)t.hasOwnProperty(a)&&j.setRequestHeader(a,t[a]);return v&&(j.withCredentials=!0),o!==undefined&&o!==null?j.send(o):j.send(),k.fin(function(){r.promise.isFulfilled()||(g("Qajax cancellation reached."),j.abort())}),s?r.promise.timeout(s).fail(function(a){throw a instanceof Error&&(g("Qajax request delay reach in "+l+" "+n),j.abort()),j}):r.promise})};b.TIMEOUT=undefined,b.defaults={logs:!1,timeout:6e4,cache:!!(window.ActiveXObject||"ActiveXObject"in window),method:"GET",headers:{},base:""},b.filterStatus=function(b){var c,d;d=typeof b;if(d==="function")c=b;else{if(d!=="number")throw"validStatus type "+d+" unsupported";c=function(a){return a===b}}return function(b){var d=0;try{d=b.status}catch(e){g("Qajax: failed to read xhr.status")}return d===1223&&(d=204),c(d)?a.resolve(b):a.reject(b)}},b.filterSuccess=b.filterStatus(function(a){return a>=200&&a<300||a===304}),b.toJSON=function(b){return a.fcall(function(){return JSON.parse(b.responseText)})},b.getJSON=function(a){return b({url:a,method:"GET"}).then(b.filterSuccess).then(b.toJSON)},b.serialize=e;var h="Content-Type";return b})},{119:119}],121:[function(a,b,c){function f(a,b){var c=d(),f,g,h=!1;return function(){return f=this,g=arguments,c.isPending()?h=!0:c=d.delay(b).then(function i(){return h=!1,d.fapply(e.bind(a,f),g).then(function(a){return h?i():a},function(a){if(h)return i();throw a})}),c}}var d=a(122),e=a(112);b.exports=f},{112:112,122:122}],122:[function(a,b,c){b.exports=a(119)},{119:119,81:81}],123:[function(a,b,c){b.exports=a(119)},{119:119,81:81}],124:[function(a,b,c){(function(a){typeof c=="object"?b.exports=a():Qstart=a()})(function(){var b=window.Q||a(123),c=b.defer(),d=function(){window.removeEventListener("error",e),c.resolve(window.document)},e=function(a){c.reject(a)};return window.addEventListener("error",e,!1),window.cordova?window.document.addEventListener("deviceready",d,!1):window.document.addEventListener("readystatechange",function(){document.readyState=="complete"&&d()},!1),c.promise})},{123:123}],125:[function(a,b,c){var d=a(116),e=typeof window=="undefined"?{}:window,f=["moz","webkit"],g="AnimationFrame",h=e["request"+g],i=e["cancel"+g]||e["cancelRequest"+g],j=!0;for(var k=0;k<f.length&&!h;k++)h=e[f[k]+"Request"+g],i=e[f[k]+"Cancel"+g]||e[f[k]+"CancelRequest"+g];if(!h||!i){j=!1;var l=0,m=0,n=[],o=1e3/60;h=function(a){if(n.length===0){var b=d(),c=Math.max(0,o-(b-l));l=c+b,setTimeout(function(){var a=n.slice(0);n.length=0;for(var b=0;b<a.length;b++)if(!a[b].cancelled)try{a[b].callback(l)}catch(c){setTimeout(function(){throw c},0)}},Math.round(c))}return n.push({handle:++m,callback:a,cancelled:!1}),m},i=function(a){for(var b=0;b<n.length;b++)n[b].handle===a&&(n[b].cancelled=!0)}}b.exports=function(a){return j?h.call(e,function(){try{a.apply(this,arguments)}catch(b){setTimeout(function(){throw b},0)}}):h.call(e,a)},b.exports.cancel=function(){i.apply(e,arguments)}},{116:116}],126:[function(a,b,c){var d=a(127),e=a(129),f=a(132),g=a(131),h=a(130),i=a(128),j=a(133);j.alea=d,j.xor128=e,j.xorwow=f,j.xorshift7=g,j.xor4096=h,j.tychei=i,b.exports=j},{127:127,128:128,129:129,130:130,131:131,132:132,133:133}],127:[function(a,b,c){(function(a,b,c){function d(a){var b=this,c=g();b.next=function(){var a=2091639*b.s0+b.c*2.3283064365386963e-10;return b.s0=b.s1,b.s1=b.s2,b.s2=a-(b.c=a|0)},b.c=1,b.s0=c(" "),b.s1=c(" "),b.s2=c(" "),b.s0-=c(a),b.s0<0&&(b.s0+=1),b.s1-=c(a),b.s1<0&&(b.s1+=1),b.s2-=c(a),b.s2<0&&(b.s2+=1),c=null}function e(a,b){return b.c=a.c,b.s0=a.s0,b.s1=a.s1,b.s2=a.s2,b}function f(a,b){var c=new d(a),f=b&&b.state,g=c.next;return g.int32=function(){return c.next()*4294967296|0},g.double=function(){return g()+(g()*2097152|0)*1.1102230246251565e-16},g.quick=g,f&&(typeof f=="object"&&e(f,c),g.state=function(){return e(c,{})}),g}function g(){var a=4022871197,b=function(b){b=b.toString();for(var c=0;c<b.length;c++){a+=b.charCodeAt(c);var d=.02519603282416938*a;a=d>>>0,d-=a,d*=a,a=d>>>0,d-=a,a+=d*4294967296}return(a>>>0)*2.3283064365386963e-10};return b}b&&b.exports?b.exports=f:c&&c.amd?c(function(){return f}):this.alea=f})(this,typeof b=="object"&&b,typeof define=="function"&&define)},{}],128:[function(a,b,c){(function(a,b,c){function d(a){var b=this,c="";b.next=function(){var a=b.b,c=b.c,d=b.d,e=b.a;return a=a<<25^a>>>7^c,c=c-d|0,d=d<<24^d>>>8^e,e=e-a|0,b.b=a=a<<20^a>>>12^c,b.c=c=c-d|0,b.d=d<<16^c>>>16^e,b.a=e-a|0},b.a=0,b.b=0,b.c=-1640531527,b.d=1367130551,a===Math.floor(a)?(b.a=a/4294967296|0,b.b=a|0):c+=a;for(var d=0;d<c.length+20;d++)b.b^=c.charCodeAt(d)|0,b.next()}function e(a,b){return b.a=a.a,b.b=a.b,b.c=a.c,b.d=a.d,b}function f(a,b){var c=new d(a),f=b&&b.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var a=c.next()>>>11,b=(c.next()>>>0)/4294967296,d=(a+b)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&e(f,c),g.state=function(){return e(c,{})}),g}b&&b.exports?b.exports=f:c&&c.amd?c(function(){return f}):this.tychei=f})(this,typeof b=="object"&&b,typeof define=="function"&&define)},{}],129:[function(a,b,c){(function(a,b,c){function d(a){var b=this,c="";b.x=0,b.y=0,b.z=0,b.w=0,b.next=function(){var a=b.x^b.x<<11;return b.x=b.y,b.y=b.z,b.z=b.w,b.w^=b.w>>>19^a^a>>>8},a===(a|0)?b.x=a:c+=a;for(var d=0;d<c.length+64;d++)b.x^=c.charCodeAt(d)|0,b.next()}function e(a,b){return b.x=a.x,b.y=a.y,b.z=a.z,b.w=a.w,b}function f(a,b){var c=new d(a),f=b&&b.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var a=c.next()>>>11,b=(c.next()>>>0)/4294967296,d=(a+b)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&e(f,c),g.state=function(){return e(c,{})}),g}b&&b.exports?b.exports=f:c&&c.amd?c(function(){return f}):this.xor128=f})(this,typeof b=="object"&&b,typeof define=="function"&&define)},{}],130:[function(a,b,c){(function(a,b,c){function d(a){function c(a,b){var c,d,e,f,g,h=[],i=128;b===(b|0)?(d=b,b=null):(b+="\0",d=0,i=Math.max(i,b.length));for(e=0,f=-32;f<i;++f)b&&(d^=b.charCodeAt((f+32)%b.length)),f===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,f>=0&&(g=g+1640531527|0,c=h[f&127]^=d+g,e=0==c?e+1:0);e>=128&&(h[(b&&b.length||0)&127]=-1),e=127;for(f=512;f>0;--f)d=h[e+34&127],c=h[e=e+1&127],d^=d<<13,c^=c<<17,d^=d>>>15,c^=c>>>12,h[e]=d^c;a.w=g,a.X=h,a.i=e}var b=this;b.next=function(){var a=b.w,c=b.X,d=b.i,e,f;return b.w=a=a+1640531527|0,f=c[d+34&127],e=c[d=d+1&127],f^=f<<13,e^=e<<17,f^=f>>>15,e^=e>>>12,f=c[d]=f^e,b.i=d,f+(a^a>>>16)|0},c(b,a)}function e(a,b){return b.i=a.i,b.w=a.w,b.X=a.X.slice(),b}function f(a,b){a==null&&(a=+(new Date));var c=new d(a),f=b&&b.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var a=c.next()>>>11,b=(c.next()>>>0)/4294967296,d=(a+b)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(f.X&&e(f,c),g.state=function(){return e(c,{})}),g}b&&b.exports?b.exports=f:c&&c.amd?c(function(){return f}):this.xor4096=f})(this,typeof b=="object"&&b,typeof define=="function"&&define)},{}],131:[function(a,b,c){(function(a,b,c){function d(a){function c(a,b){var c,d,e=[];if(b===(b|0))d=e[0]=b;else{b=""+b;for(c=0;c<b.length;++c)e[c&7]=e[c&7]<<15^b.charCodeAt(c)+e[c+1&7]<<13}while(e.length<8)e.push(0);for(c=0;c<8&&e[c]===0;++c);c==8?d=e[7]=-1:d=e[c],a.x=e,a.i=0;for(c=256;c>0;--c)a.next()}var b=this;b.next=function(){var a=b.x,c=b.i,d,e,f;return d=a[c],d^=d>>>7,e=d^d<<24,d=a[c+1&7],e^=d^d>>>10,d=a[c+3&7],e^=d^d>>>3,d=a[c+4&7],e^=d^d<<7,d=a[c+7&7],d^=d<<13,e^=d^d<<9,a[c]=e,b.i=c+1&7,e},c(b,a)}function e(a,b){return b.x=a.x.slice(),b.i=a.i,b}function f(a,b){a==null&&(a=+(new Date));var c=new d(a),f=b&&b.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var a=c.next()>>>11,b=(c.next()>>>0)/4294967296,d=(a+b)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(f.x&&e(f,c),g.state=function(){return e(c,{})}),g}b&&b.exports?b.exports=f:c&&c.amd?c(function(){return f}):this.xorshift7=f})(this,typeof b=="object"&&b,typeof define=="function"&&define)},{}],132:[function(a,b,c){(function(a,b,c){function d(a){var b=this,c="";b.next=function(){var a=b.x^b.x>>>2;return b.x=b.y,b.y=b.z,b.z=b.w,b.w=b.v,(b.d=b.d+362437|0)+(b.v=b.v^b.v<<4^(a^a<<1))|0},b.x=0,b.y=0,b.z=0,b.w=0,b.v=0,a===(a|0)?b.x=a:c+=a;for(var d=0;d<c.length+64;d++)b.x^=c.charCodeAt(d)|0,d==c.length&&(b.d=b.x<<10^b.x>>>4),b.next()}function e(a,b){return b.x=a.x,b.y=a.y,b.z=a.z,b.w=a.w,b.v=a.v,b.d=a.d,b}function f(a,b){var c=new d(a),f=b&&b.state,g=function(){return(c.next()>>>0)/4294967296};return g.double=function(){do var a=c.next()>>>11,b=(c.next()>>>0)/4294967296,d=(a+b)/(1<<21);while(d===0);return d},g.int32=c.next,g.quick=g,f&&(typeof f=="object"&&e(f,c),g.state=function(){return e(c,{})}),g}b&&b.exports?b.exports=f:c&&c.amd?c(function(){return f}):this.xorwow=f})(this,typeof b=="object"&&b,typeof define=="function"&&define)},{}],133:[function(a,b,c){(function(c,d){function o(a,b,e){var h=[];b=b==1?{entropy:!0}:b||{};var m=s(r(b.entropy?[a,u(c)]:a==null?t():a,3),h),n=new p(h),o=function(){var a=n.g(g),b=j,c=0;while(a<k)a=(a+c)*f,b*=f,c=n.g(1);while(a>=l)a/=2,b/=2,c>>>=1;return(a+c)/b};return o.int32=function(){return n.g(4)|0},o.quick=function(){return n.g(4)/4294967296},o.double=o,s(u(n.S),c),(b.pass||e||function(a,b,c,e){return e&&(e.S&&q(e,n),a.state=function(){return q(n,{})}),c?(d[i]=a,b):a})(o,m,"global"in b?b.global:this==d,b.state)}function p(a){var b,c=a.length,d=this,e=0,g=d.i=d.j=0,h=d.S=[];c||(a=[c++]);while(e<f)h[e]=e++;for(e=0;e<f;e++)h[e]=h[g=m&g+a[e%c]+(b=h[e])],h[g]=b;(d.g=function(a){var b,c=0,e=d.i,g=d.j,h=d.S;while(a--)b=h[e=m&e+1],c=c*f+h[m&(h[e]=h[g=m&g+b])+(h[g]=b)];return d.i=e,d.j=g,c})(f)}function q(a,b){return b.i=a.i,b.j=a.j,b.S=a.S.slice(),b}function r(a,b){var c=[],d=typeof a,e;if(b&&d=="object")for(e in a)try{c.push(r(a[e],b-1))}catch(f){}return c.length?c:d=="string"?a:a+"\0"}function s(a,b){var c=a+"",d,e=0;while(e<c.length)b[m&e]=m&(d^=b[m&e]*19)+c.charCodeAt(e++);return u(b)}function t(){try{var a;return n&&(a=n.randomBytes)?a=a(f):(a=new Uint8Array(f),(e.crypto||e.msCrypto).getRandomValues(a)),u(a)}catch(b){var d=e.navigator,g=d&&d.plugins;return[+(new Date),e,g,e.screen,u(c)]}}function u(a){return String.fromCharCode.apply(0,a)}var e=this,f=256,g=6,h=52,i="random",j=d.pow(f,g),k=d.pow(2,h),l=k*2,m=f-1,n;d["seed"+i]=o,s(d.random(),c);if(typeof b=="object"&&b.exports){b.exports=o;try{n=a(80)}catch(v){}}else typeof define=="function"&&define.amd&&define(function(){return o})})([],Math)},{80:80}],134:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);if(typeof a!="function")throw new Error("SlidingWindow(alloc, free, options): alloc function is mandatory");if(typeof b!="function")throw new Error("SlidingWindow(alloc, free, options): free function is mandatory");if(c)for(var e in c)this[e]=c[e];this.alloc=a,this.free=b,this._chunks={},this._right=null,this._left=null}d.prototype={chunkSize:1,right:0,left:0,bounds:[-Infinity,+Infinity],reverseIndex:function(a){return a*this.chunkSize},chunkIndex:function(a){return Math.floor(a/this.chunkSize)},getChunk:function(a){return this._chunks[this.chunkIndex(a)]},getChunkByIndex:function(a){return this._chunks[a]},destroy:function(a){for(var b=this._left;b<=this._right;++b)this.free(b,this._chunks[b],a),delete this._chunks[b];this._chunks=null,this.alloc=null,this.free=null},move:function(a,b){var c,d;if(typeof a=="number"&&!isNaN(a))c=d=a;else{c=a[0],d=a[1];if(typeof c!="number"||isNaN(c)||!isFinite(c))throw new Error("tail is not a finite number: "+[c,d]);if(typeof d!="number"||isNaN(d)||!isFinite(d))throw new Error("head is not a finite number: "+[c,d]);if(c>d)throw new Error("tail shouldn't be greater than head")}var e=Math.min(this.chunkIndex(d+this.right*this.chunkSize),this.bounds[1]),f=Math.max(this.chunkIndex(c-this.left*this.chunkSize),this.bounds[0]),g=this._chunks,h=[],i=[],j,k;this._right===null&&(this._left=f,this._right=f-1);for(j=this._right+1;j<=e;j++)h.push(j);for(j=this._left-1;j>=f;j--)h.push(j);for(j=this._left;j<f;j++)i.push(j);for(j=this._right;j>e;j--)i.push(j);this._right=e,this._left=f;for(j=0;j<i.length;++j)k=i[j],h.indexOf(k)===-1&&(this.free(k,g[k],b),delete g[k]);for(j=0;j<h.length;++j)k=h[j],i.indexOf(k)===-1&&(g[k]=this.alloc(k,b))}},b.exports=d},{}],135:[function(a,b,c){b.exports=function(b,c,d){var e=Math.max(0,Math.min(1,(d-b)/(c-b)));return e*e*(3-2*e)}},{}],136:[function(a,b,c){(function(a){var b={},c=[],d;b.init=function(a,b){b=b||{},d=a,d.on("ntp:server_sync",e),setInterval(f,b.interval||1e3)};var e=function(a){var b=Date.now()-a.t1+(Date.now()-a.t0)/2;c.unshift(b),c.length>10&&c.pop()};b.offset=function(){var a=0;for(var b=0;b<c.length;b++)a+=c[b];return a/=c.length,a};var f=function(){d.emit("ntp:client_sync",{t0:Date.now()})};typeof define=="function"&&define.amd?define("ntp",[],function(){return b}):a.ntp=b})(window)},{}],137:[function(a,b,c){function i(a,b){typeof a=="object"&&(b=a,a=undefined),b=b||{};var c=d(a),e=c.source,i=c.id,k=c.path,l=h[i]&&k in h[i].nsps,m=b.forceNew||b["force new connection"]||!1===b.multiplex||l,n;return m?(g("ignoring socket cache for %s",e),n=f(e,b)):(h[i]||(g("new io instance for %s",e),h[i]=f(e,b)),n=h[i]),c.query&&!b.query?b.query=c.query:b&&"object"==typeof b.query&&(b.query=j(b.query)),n.socket(c.path,b)}function j(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}var d=a(141),e=a(143),f=a(138),g=a(87)("socket.io-client");b.exports=c=i;var h=c.managers={};c.protocol=e.protocol,c.connect=i,c.Manager=a(138),c.Socket=a(140)},{138:138,140:140,141:141,143:143,87:87}],138:[function(a,b,c){function n(a,b){if(!(this instanceof n))return new n(a,b);a&&"object"==typeof a&&(b=a,a=undefined),b=b||{},b.path=b.path||"/socket.io",this.nsps={},this.subs=[],this.opts=b,this.reconnection(b.reconnection!==!1),this.reconnectionAttempts(b.reconnectionAttempts||Infinity),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(b.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this.readyState="closed",this.uri=a,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new g.Encoder,this.decoder=new g.Decoder,this.autoConnect=b.autoConnect!==!1,this.autoConnect&&this.open()}var d=a(91),e=a(140),f=a(85),g=a(143),h=a(139),i=a(84),j=a(87)("socket.io-client:manager"),k=a(108),l=a(68),m=Object.prototype.hasOwnProperty;b.exports=n,n.prototype.emitAll=function(){this.emit.apply(this
,arguments);for(var a in this.nsps)m.call(this.nsps,a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)},n.prototype.updateSocketIds=function(){for(var a in this.nsps)m.call(this.nsps,a)&&(this.nsps[a].id=this.engine.id)},f(n.prototype),n.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection},n.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax},n.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()},n.prototype.open=n.prototype.connect=function(a,b){j("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;j("opening %s",this.uri),this.engine=d(this.uri,this.opts);var c=this.engine,e=this;this.readyState="opening",this.skipReconnect=!1;var f=h(c,"open",function(){e.onopen(),a&&a()}),g=h(c,"error",function(b){j("connect_error"),e.cleanup(),e.readyState="closed",e.emitAll("connect_error",b);if(a){var c=new Error("Connection error");c.data=b,a(c)}else e.maybeReconnectOnOpen()});if(!1!==this._timeout){var i=this._timeout;j("connect attempt will timeout after %d",i);var k=setTimeout(function(){j("connect attempt timed out after %d",i),f.destroy(),c.close(),c.emit("error","timeout"),e.emitAll("connect_timeout",i)},i);this.subs.push({destroy:function(){clearTimeout(k)}})}return this.subs.push(f),this.subs.push(g),this},n.prototype.onopen=function(){j("open"),this.cleanup(),this.readyState="open",this.emit("open");var a=this.engine;this.subs.push(h(a,"data",i(this,"ondata"))),this.subs.push(h(a,"ping",i(this,"onping"))),this.subs.push(h(a,"pong",i(this,"onpong"))),this.subs.push(h(a,"error",i(this,"onerror"))),this.subs.push(h(a,"close",i(this,"onclose"))),this.subs.push(h(this.decoder,"decoded",i(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(a){this.decoder.add(a)},n.prototype.ondecoded=function(a){this.emit("packet",a)},n.prototype.onerror=function(a){j("error",a),this.emitAll("error",a)},n.prototype.socket=function(a,b){function f(){~k(d.connecting,c)||d.connecting.push(c)}var c=this.nsps[a];if(!c){c=new e(this,a,b),this.nsps[a]=c;var d=this;c.on("connecting",f),c.on("connect",function(){c.id=d.engine.id}),this.autoConnect&&f()}return c},n.prototype.destroy=function(a){var b=k(this.connecting,a);~b&&this.connecting.splice(b,1);if(this.connecting.length)return;this.close()},n.prototype.packet=function(a){j("writing packet %j",a);var b=this;a.query&&a.type===0&&(a.nsp+="?"+a.query),b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(c){for(var d=0;d<c.length;d++)b.engine.write(c[d],a.options);b.encoding=!1,b.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}},n.prototype.cleanup=function(){j("cleanup");var a=this.subs.length;for(var b=0;b<a;b++){var c=this.subs.shift();c.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){j("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(a){j("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",a),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)j("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();j("will wait %dms before reconnect attempt",b),this.reconnecting=!0;var c=setTimeout(function(){if(a.skipReconnect)return;j("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts);if(a.skipReconnect)return;a.open(function(b){b?(j("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(j("reconnect success"),a.onreconnect())})},b);this.subs.push({destroy:function(){clearTimeout(c)}})}},n.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",a)}},{108:108,139:139,140:140,143:143,68:68,84:84,85:85,87:87,91:91}],139:[function(a,b,c){function d(a,b,c){return a.on(b,c),{destroy:function(){a.removeListener(b,c)}}}b.exports=d},{}],140:[function(a,b,c){function m(a,b,c){this.io=a,this.nsp=b,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,c&&c.query&&(this.query=c.query),this.io.autoConnect&&this.open()}var d=a(143),e=a(85),f=a(149),g=a(139),h=a(84),i=a(87)("socket.io-client:socket"),j=a(104);b.exports=c=m;var k={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},l=e.prototype.emit;e(m.prototype),m.prototype.subEvents=function(){if(this.subs)return;var a=this.io;this.subs=[g(a,"open",h(this,"onopen")),g(a,"packet",h(this,"onpacket")),g(a,"close",h(this,"onclose"))]},m.prototype.open=m.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},m.prototype.send=function(){var a=f(arguments);return a.unshift("message"),this.emit.apply(this,a),this},m.prototype.emit=function(a){if(k.hasOwnProperty(a))return l.apply(this,arguments),this;var b=f(arguments),c=d.EVENT;j(b)&&(c=d.BINARY_EVENT);var e={type:c,data:b};return e.options={},e.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof b[b.length-1]&&(i("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),e.id=this.ids++),this.connected?this.packet(e):this.sendBuffer.push(e),delete this.flags,this},m.prototype.packet=function(a){a.nsp=this.nsp,this.io.packet(a)},m.prototype.onopen=function(){i("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:d.CONNECT,query:this.query}):this.packet({type:d.CONNECT}))},m.prototype.onclose=function(a){i("close (%s)",a),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",a)},m.prototype.onpacket=function(a){if(a.nsp!==this.nsp)return;switch(a.type){case d.CONNECT:this.onconnect();break;case d.EVENT:this.onevent(a);break;case d.BINARY_EVENT:this.onevent(a);break;case d.ACK:this.onack(a);break;case d.BINARY_ACK:this.onack(a);break;case d.DISCONNECT:this.ondisconnect();break;case d.ERROR:this.emit("error",a.data)}},m.prototype.onevent=function(a){var b=a.data||[];i("emitting event %j",b),null!=a.id&&(i("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?l.apply(this,b):this.receiveBuffer.push(b)},m.prototype.ack=function(a){var b=this,c=!1;return function(){if(c)return;c=!0;var e=f(arguments);i("sending ack %j",e);var g=j(e)?d.BINARY_ACK:d.ACK;b.packet({type:g,id:a,data:e})}},m.prototype.onack=function(a){var b=this.acks[a.id];"function"==typeof b?(i("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):i("bad ack %s",a.id)},m.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},m.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)l.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]},m.prototype.ondisconnect=function(){i("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},m.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)},m.prototype.close=m.prototype.disconnect=function(){return this.connected&&(i("performing disconnect (%s)",this.nsp),this.packet({type:d.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},m.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=a,this}},{104:104,139:139,143:143,149:149,84:84,85:85,87:87}],141:[function(a,b,c){((function(c){function f(a,b){var f=a;b=b||c.location,null==a&&(a=b.protocol+"//"+b.host),"string"==typeof a&&("/"===a.charAt(0)&&("/"===a.charAt(1)?a=b.protocol+a:a=b.host+a),/^(https?|wss?):\/\//.test(a)||(e("protocol-less url %s",a),"undefined"!=typeof b?a=b.protocol+"//"+a:a="https://"+a),e("parse %s",a),f=d(a)),f.port||(/^(http|ws)$/.test(f.protocol)?f.port="80":/^(http|ws)s$/.test(f.protocol)&&(f.port="443")),f.path=f.path||"/";var g=f.host.indexOf(":")!==-1,h=g?"["+f.host+"]":f.host;return f.id=f.protocol+"://"+h+":"+f.port,f.href=f.protocol+"://"+h+(b&&b.port===f.port?"":":"+f.port),f}var d=a(115),e=a(87)("socket.io-client:url");b.exports=f})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{115:115,87:87}],142:[function(a,b,c){((function(b){var d=a(109),e=a(144);c.deconstructPacket=function(a){function f(a){if(!a)return a;if(e(a)){var c={_placeholder:!0,num:b.length};return b.push(a),c}if(d(a)){var g=new Array(a.length);for(var h=0;h<a.length;h++)g[h]=f(a[h]);return g}if("object"!=typeof a||a instanceof Date)return a;var g={};for(var i in a)g[i]=f(a[i]);return g}var b=[],c=a.data,g=a;return g.data=f(c),g.attachments=b.length,{packet:g,buffers:b}},c.reconstructPacket=function(a,b){function e(a){if(a&&a._placeholder){var c=b[a.num];return c}if(d(a)){for(var f=0;f<a.length;f++)a[f]=e(a[f]);return a}if(a&&"object"==typeof a){for(var g in a)a[g]=e(a[g]);return a}return a}var c=0;return a.data=e(a.data),a.attachments=undefined,a},c.removeBlobs=function(a,c){function f(a,i,j){if(!a)return a;if(b.Blob&&a instanceof Blob||b.File&&a instanceof File){g++;var k=new FileReader;k.onload=function(){j?j[i]=this.result:h=this.result,--g||c(h)},k.readAsArrayBuffer(a)}else if(d(a))for(var l=0;l<a.length;l++)f(a[l],l,a);else if(a&&"object"==typeof a&&!e(a))for(var m in a)f(a[m],m,a)}var g=0,h=a;f(h),g||c(h)}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{109:109,144:144}],143:[function(a,b,c){function i(){}function j(a){var b="",f=!1;b+=a.type;if(c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type)b+=a.attachments,b+="-";return a.nsp&&"/"!=a.nsp&&(f=!0,b+=a.nsp),null!=a.id&&(f&&(b+=",",f=!1),b+=a.id),null!=a.data&&(f&&(b+=","),b+=e.stringify(a.data)),d("encoded %j as %s",a,b),b}function k(a,b){function c(a){var c=g.deconstructPacket(a),d=j(c.packet),e=c.buffers;e.unshift(d),b(e)}g.removeBlobs(a,c)}function l(){this.reconstructor=null}function m(a){var b={},e=0;b.type=Number(a.charAt(0));if(null==c.types[b.type])return p();if(c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type){var f="";while(a.charAt(++e)!="-"){f+=a.charAt(e);if(e==a.length)break}if(f!=Number(f)||a.charAt(e)!="-")throw new Error("Illegal attachments");b.attachments=Number(f)}if("/"==a.charAt(e+1)){b.nsp="";while(++e){var g=a.charAt(e);if(","==g)break;b.nsp+=g;if(e==a.length)break}}else b.nsp="/";var h=a.charAt(e+1);if(""!==h&&Number(h)==h){b.id="";while(++e){var g=a.charAt(e);if(null==g||Number(g)!=g){--e;break}b.id+=a.charAt(e);if(e==a.length)break}b.id=Number(b.id)}return a.charAt(++e)&&(b=n(b,a.substr(e))),d("decoded %s as %j",a,b),b}function n(a,b){try{a.data=e.parse(b)}catch(c){return p()}return a}function o(a){this.reconPack=a,this.buffers=[]}function p(a){return{type:c.ERROR,data:"parser error"}}var d=a(146)("socket.io-parser"),e=a(111),f=a(145),g=a(142),h=a(144);c.protocol=4,c.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],c.CONNECT=0,c.DISCONNECT=1,c.EVENT=2,c.ACK=3,c.ERROR=4,c.BINARY_EVENT=5,c.BINARY_ACK=6,c.Encoder=i,c.Decoder=l,i.prototype.encode=function(a,b){d("encoding packet %j",a);if(c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type)k(a,b);else{var e=j(a);b([e])}},f(l.prototype),l.prototype.add=function(a){var b;if("string"==typeof a)b=m(a),c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type?(this.reconstructor=new o(b),this.reconstructor.reconPack.attachments===0&&this.emit("decoded",b)):this.emit("decoded",b);else{if(!h(a)&&!a.base64)throw new Error("Unknown type: "+a);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");b=this.reconstructor.takeBinaryData(a),b&&(this.reconstructor=null,this.emit("decoded",b))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},o.prototype.takeBinaryData=function(a){this.buffers.push(a);if(this.buffers.length==this.reconPack.attachments){var b=g.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null},o.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{111:111,142:142,144:144,145:145,146:146}],144:[function(a,b,c){((function(a){function c(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}b.exports=c})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],145:[function(a,b,c){function d(a){if(a)return e(a)}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}b.exports=d,d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function d(){c.off(a,d),b.apply(this,arguments)}var c=this;return this._callbacks=this._callbacks||{},d.fn=b,this.on(a,d),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;var d;for(var e=0;e<c.length;e++){d=c[e];if(d===b||d.fn===b){c.splice(e,1);break}}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],146:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff);if(!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){if("%%"===a)return;e++,"%c"===a&&(f=e)}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?c.storage.removeItem("debug"):c.storage.debug=a}catch(b){}}function h(){var a;try{a=c.storage.debug}catch(b){}return a}function i(){try{return window.localStorage}catch(a){}}c=b.exports=a(147),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:i(),c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{147:147}],147:[function(a,b,c){function f(){return c.colors[d++%c.colors.length]}function g(a){function b(){}function d(){var a=d,b=+(new Date),g=b-(e||b);a.diff=g,a.prev=e,a.curr=b,e=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=f());var h=Array.prototype.slice.call(arguments);h[0]=c.coerce(h[0]),"string"!=typeof h[0]&&(h=["%o"].concat(h));var i=0;h[0]=h[0].replace(/%([a-z%])/g,function(b,d){if(b==="%%")return b;i++;var e=c.formatters[d];if("function"==typeof e){var f=h[i];b=e.call(a,f),h.splice(i,1),i--}return b}),"function"==typeof c.formatArgs&&(h=c.formatArgs.apply(a,h));var j=d.log||c.log||console.log.bind(console);j.apply(a,h)}b.enabled=!1,d.enabled=!0;var g=c.enabled(a)?d:b;return g.namespace=a,g}function h(a){c.save(a);var b=(a||"").split(/[\s,]+/),d=b.length;for(var e=0;e<d;e++){if(!b[e])continue;a=b[e].replace(/\*/g,".*?"),a[0]==="-"?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$"))}}function i(){c.enable("")}function j(a){var b,d;for(b=0,d=c.skips.length;b<d;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;b<d;b++)if(c.names[b].test(a))return!0;return!1}function k(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=g,c.coerce=k,c.disable=i,c.enable=h,c.enabled=j,c.humanize=a(148),c.names=[],c.skips=[],c.formatters={};var d=0,e},{148:148}],148:[function(a,b,c){function i(a){a=""+a;if(a.length>1e4)return;var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(!b)return;var c=parseFloat(b[1]),i=(b[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return c*h;case"days":case"day":case"d":return c*g;case"hours":case"hour":case"hrs":case"hr":case"h":return c*f;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c}}function j(a){return a>=g?Math.round(a/g)+"d":a>=f?Math.round(a/f)+"h":a>=e?Math.round(a/e)+"m":a>=d?Math.round(a/d)+"s":a+"ms"}function k(a){return l(a,g,"day")||l(a,f,"hour")||l(a,e,"minute")||l(a,d,"second")||a+" ms"}function l(a,b,c){if(a<b)return;return a<b*1.5?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var d=1e3,e=d*60,f=e*60,g=f*24,h=g*365.25;b.exports=function(a,b){return b=b||{},"string"==typeof a?i(a):b.long?k(a):j(a)}},{}],149:[function(a,b,c){function d(a,b){var c=[];b=b||0;for(var d=b||0;d<a.length;d++)c[d-b]=a[d];return c}b.exports=d},{}],150:[function(a,b,c){((function(b,d){function k(a){if(!a)return;var b=a.length||a.byteLength,c=e.log2(b);i[c].push(a)}function l(a){k(a.buffer)}function m(a){var a=e.nextPow2(a),b=e.log2(a),c=i[b];return c.length>0?c.pop():new ArrayBuffer(a)}function n(a){return new Uint8Array(m(a),0,a)}function o(a){return new Uint16Array(m(2*a),0,a)}function p(a){return new Uint32Array(m(4*a),0,a)}function q(a){return new Int8Array(m(a),0,a)}function r(a){return new Int16Array(m(2*a),0,a)}function s(a){return new Int32Array(m(4*a),0,a)}function t(a){return new Float32Array(m(4*a),0,a)}function u(a){return new Float64Array(m(8*a),0,a)}function v(a){return g?new Uint8ClampedArray(m(a),0,a):n(a)}function w(a){return new DataView(m(a),0,a)}function x(a){a=e.nextPow2(a);var b=e.log2(a),c=j[b];return c.length>0?c.pop():new d(a)}"use strict";var e=a(71),f=a(90);b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:f([32,0]),UINT16:f([32,0]),UINT32:f([32,0]),INT8:f([32,0]),INT16:f([32,0]),INT32:f([32,0]),FLOAT:f([32,0]),DOUBLE:f([32,0]),DATA:f([32,0]),UINT8C:f([32,0]),BUFFER:f([32,0])});var g=typeof Uint8ClampedArray!="undefined",h=b.__TYPEDARRAY_POOL;h.UINT8C||(h.UINT8C=f([32,0])),h.BUFFER||(h.BUFFER=f([32,0]));var i=h.DATA,j=h.BUFFER;c.free=function(b){if(d.isBuffer(b))j[e.log2(b.length)].push(b);else{Object.prototype.toString.call(b)!=="[object ArrayBuffer]"&&(b=b.buffer);if(!b)return;var c=b.length||b.byteLength,f=e.log2(c)|0;i[f].push(b)}},c.freeUint8=c.freeUint16=c.freeUint32=c.freeInt8=c.freeInt16=c.freeInt32=c.freeFloat32=c.freeFloat=c.freeFloat64=c.freeDouble=c.freeUint8Clamped=c.freeDataView=l,c.freeArrayBuffer=k,c.freeBuffer=function(b){j[e.log2(b.length)].push(b)},c.malloc=function(b,c){if(c===undefined||c==="arraybuffer")return m(b);switch(c){case"uint8":return n(b);case"uint16":return o(b);case"uint32":return p(b);case"int8":return q(b);case"int16":return r(b);case"int32":return s(b);case"float":case"float32":return t(b);case"double":case"float64":return u(b);case"uint8_clamped":return v(b);case"buffer":return x(b);case"data":case"dataview":return w(b);default:return null}return null},c.mallocArrayBuffer=m,c.mallocUint8=n,c.mallocUint16=o,c.mallocUint32=p,c.mallocInt8=q,c.mallocInt16=r,c.mallocInt32=s,c.mallocFloat32=c.mallocFloat=t,c.mallocFloat64=c.mallocDouble=u,c.mallocUint8Clamped=v,c.mallocDataView=w,c.mallocBuffer=x,c.clearCache=function(){for(var b=0;b<32;++b)h.UINT8[b].length=0,h.UINT16[b].length=0,h.UINT32[b].length=0,h.INT8[b].length=0,h.INT16[b].length=0,h.INT32[b].length=0,h.FLOAT[b].length=0,h.DOUBLE[b].length=0,h.UINT8C[b].length=0,i[b].length=0,j[b].length=0}})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{},a(82).Buffer)},{71:71,82:82,90:90}],151:[function(a,b,c){function i(a){return a in h?h[a]:h[a]=j(a)}function j(a){var b=a.replace(/-([a-z])/g,function(a,b){return b.toUpperCase()}),c=e.length,f;if(d[b]!==undefined)return b;b=k(a);while(c--){f=e[c]+b;if(d[f]!==undefined)return f}throw new Error("unable to prefix "+a)}function k(a){return a.charAt(0).toUpperCase()+a.slice(1)}function l(a){var b=i(a),c=/([A-Z])/g;return c.test(b)&&(b=(f.test(b)?"-":"")+b.replace(c,"-$1")),b.toLowerCase()}"use strict";var d=document.createElement("p").style,e="O ms Moz webkit".split(" "),f=/^(o|ms|moz|webkit)/,g=/([A-Z])/g,h={};b.exports=i,b.exports.dash=l},{}],152:[function(a,b,c){b.exports="vibrate"in window.navigator?function(a){return window.navigator.vibrate(a)}:function(){return!1}},{}],153:[function(a,b,c){((function(a){(function(d){function i(a){var b=[],c=0,d=a.length,e,f;while(c<d)e=a.charCodeAt(c++),e>=55296&&e<=56319&&c<d?(f=a.charCodeAt(c++),(f&64512)==56320?b.push(((e&1023)<<10)+(f&1023)+65536):(b.push(e),c--)):b.push(e);return b}function j(a){var b=a.length,c=-1,d,e="";while(++c<b)d=a[c],d>65535&&(d-=65536,e+=h(d>>>10&1023|55296),d=56320|d&1023),e+=h(d);return e}function k(a,b){return h(a>>b&63|128)}function l(a){if((a&4294967168)==0)return h(a);var b="";return(a&4294965248)==0?b=h(a>>6&31|192):(a&4294901760)==0?(b=h(a>>12&15|224),b+=k(a,6)):(a&4292870144)==0&&(b=h(a>>18&7|240),b+=k(a,12),b+=k(a,6)),b+=h(a&63|128),b}function m(a){var b=i(a),c=b.length,d=-1,e,f="";while(++d<c)e=b[d],f+=l(e);return f}function n(){if(r>=q)throw Error("Invalid byte index");var a=p[r]&255;r++;if((a&192)==128)return a&63;throw Error("Invalid continuation byte")}function o(){var a,b,c,d,e;if(r>q)throw Error("Invalid byte index");if(r==q)return!1;a=p[r]&255,r++;if((a&128)==0)return a;if((a&224)==192){var b=n();e=(a&31)<<6|b;if(e>=128)return e;throw Error("Invalid continuation byte")}if((a&240)==224){b=n(),c=n(),e=(a&15)<<12|b<<6|c;if(e>=2048)return e;throw Error("Invalid continuation byte")}if((a&248)==240){b=n(),c=n(),d=n(),e=(a&15)<<18|b<<12|c<<6|d;if(e>=65536&&e<=1114111)return e}throw Error("Invalid WTF-8 detected")}function s(a){p=i(a),q=p.length,r=0;var b=[],c;while((c=o())!==!1)b.push(c);return j(b)}var e=typeof c=="object"&&c,f=typeof b=="object"&&b&&b.exports==e&&b,g=typeof a=="object"&&a;if(g.global===g||g.window===g)d=g;var h=String.fromCharCode,p,q,r,t={version:"1.0.0",encode:m,decode:s};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)define(function(){return t});else if(e&&!e.nodeType)if(f)f.exports=t;else{var u={},v=u.hasOwnProperty;for(var w in t)v.call(t,w)&&(e[w]=t[w])}else d.wtf8=t})(this)})).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],154:[function(a,b,c){function j(a){var b="";do b=d[a%e]+b,a=Math.floor(a/e);while(a>0);return b}function k(a){var b=0;for(h=0;h<a.length;h++)b=b*e+f[a.charAt(h)];return b}function l(){var a=j(+(new Date));return a!==i?(g=0,i=a):a+"."+j(g++)}"use strict";var d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),e=64,f={},g=0,h=0,i;for(;h<e;h++)f[d[h]]=h;l.encode=j,l.decode=k,b.exports=l},{}]},{},[20]);